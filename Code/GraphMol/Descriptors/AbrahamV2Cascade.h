// Abraham V2 Cascade Models - Auto-generated
// CASCADE ORDER: V → L → E → B → S → A
// Each model uses 291 base features + LSFER golden features from previous predictions
#pragma once

#include <vector>
#include <cmath>
#include <algorithm>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace AbrahamV2Cascade {

// LSFER golden feature generation
inline std::vector<double> createLSFERFeatures(const std::vector<double>& preds, int n_prev) {
    std::vector<double> features;
    if (n_prev == 0) return features;
    
    // Raw predictions
    for (int i = 0; i < n_prev; ++i) {
        features.push_back(preds[i]);
    }
    
    // Squares
    for (int i = 0; i < n_prev; ++i) {
        features.push_back(preds[i] * preds[i]);
    }
    
    // Pairwise products
    for (int i = 0; i < n_prev; ++i) {
        for (int j = i + 1; j < n_prev; ++j) {
            features.push_back(preds[i] * preds[j]);
        }
    }
    
    // Square roots
    for (int i = 0; i < n_prev; ++i) {
        features.push_back(std::sqrt(std::max(0.0, preds[i])));
    }
    
    // Ratios (first 3 vs all)
    const double eps = 0.01;
    for (int i = 0; i < std::min(3, n_prev); ++i) {
        for (int j = 0; j < n_prev; ++j) {
            if (i != j) {
                features.push_back(preds[i] / (preds[j] + eps));
            }
        }
    }
    
    return features;
}


// V Model (Ridge) - 291 features
namespace VModel {
    constexpr int N_FEATURES = 291;
    
    static const double SCALER_MEAN[291] = {
        0.0340425532, 0.0080988332, 0.0000000000, 0.0000000000, 0.0031571723, 0.0000000000, 0.0000000000, 0.0034317090,
        0.0000000000, 0.0005490734, 0.0000000000, 0.0000000000, 0.0160603981, 0.0111187371, 0.0100205903, 0.2765957447,
        0.1240905971, 0.0527110501, 0.0161976664, 0.0144131778, 0.0054907344, 0.0054907344, 0.0041180508, 0.0002745367,
        0.0072752231, 0.0065888813, 0.0650652025, 0.0442004118, 0.0251201098, 0.0012354152, 0.0045298559, 0.0012354152,
        0.0123541524, 0.0027453672, 0.0211393274, 0.1398764585, 0.0168840082, 0.0225120110, 0.0365133837, 0.0111187371,
        0.0043925875, 0.0656142759, 0.0049416609, 0.0048043926, 0.0087851750, 0.0124914207, 0.0054907344, 0.0089224434,
        0.0109814688, 0.0528483185, 0.0094715168, 0.0067261496, 0.0048043926, 0.0030199039, 0.0030199039, 0.0013726836,
        0.0004118051, 0.0013726836, 0.0008236102, 0.0008236102, 0.0208647907, 0.0020590254, 0.0134522992, 0.0330816747,
        0.0846945779, 0.0146877145, 1.4273164036, 2.7161290323, 0.0737131091, 0.0410432395, 0.0787920384, 0.0212765957,
        0.0421413864, 0.0344543583, 0.0089224434, 0.1444063143, 0.0126286891, 0.0060398078, 0.6463967056, 0.0075497598,
        0.0509265614, 0.0020590254, 0.4133150309, 0.3371310913, 0.0859299931, 0.0245710364, 0.6845573095, 0.0437886067,
        0.0236101579, 0.2711050103, 0.0075497598, 0.0038435141, 0.0005490734, 0.1139327385, 0.0157858614, 0.2104323953,
        0.0345916266, 0.3827041867, 0.0501029513, 0.0146877145, 0.0580645161, 0.1618393960, 0.0078242965, 0.0048043926,
        0.0019217570, 0.0050789293, 0.0927934111, 0.0439258751, 0.0179821551, 0.0145504461, 0.0080988332, 2.9913520933,
        0.0109814688, 0.0010981469, 0.1051475635, 0.2535346603, 0.0223747426, 0.1398764585, 0.0168840082, 0.0194921071,
        0.0111187371, 0.0043925875, 2.0704186685, 0.0340425532, 0.0177076184, 0.0030199039, 0.0789293068, 0.0013726836,
        0.0514756349, 0.2001372684, 0.1973919012, 0.2505147563, 0.0010981469, 0.4381606040, 0.0436513384, 0.0153740563,
        0.0024708305, 0.0321207962, 0.0306108442, 0.0365133837, 0.3400137268, 0.1191489362, 0.0001372684, 0.0000000000,
        0.0524365134, 0.0262182567, 0.0001372684, 0.2757721345, 0.1592312972, 0.0079615649, 0.1427590940, 0.0264927934,
        0.0105696637, 0.0028826356, 0.0078242965, 0.8657515443, 0.8657515443, 0.3153054221, 3.2251201098, 10.1423472889,
        1.7879203844, 0.0038435141, 0.0071379547, 0.0001372684, 0.0000000000, 0.0001372684, 0.0000000000, 0.0123541524,
        0.0001372684, 0.0520247083, 0.0126286891, 0.0249828415, 0.0737131091, 0.0221002059, 0.0137268360, 0.0001372684,
        0.0760466712, 0.0347288950, 0.0001372684, 0.4970487303, 0.1010295127, 0.2542210021, 0.2317089911, 0.3253260124,
        0.1175017159, 0.1175017159, 0.0048043926, 0.0059025395, 0.0001372684, 0.0001372684, 0.0050789293, 0.0000000000,
        0.0027453672, 0.0312971860, 0.0001372684, 0.0001372684, 0.0000000000, 0.0010981469, 0.0057652711, 0.0167467399,
        0.0001372684, 0.0000000000, 0.0001372684, 0.0001372684, 0.0001372684, 0.0001372684, 0.0000000000, 0.0126286891,
        0.0001372684, 0.0001372684, 0.3514070007, 0.5574468085, 0.5574468085, 0.3253260124, 0.2164722032, 3.3514070007,
        1.4978723404, 0.2469457790, 3.0274536719, 0.2765957447, 0.6925188744, 0.3158544955, 0.3368565546, 0.1816060398,
        0.1260123542, 0.0910089224, 0.3805078929, 0.1310912835, 0.0845573095, 0.1887439945, 0.2938915580, 0.1195607412,
        0.6910089224, 0.7229924502, 0.2425531915, 0.6964996568, 0.1191489362, 0.3368565546, 0.1310912835, 0.1195607412,
        0.2425531915, 0.0002745367, 0.0000000000, 0.0000000000, 0.0001372684, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0001372684, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0004804393, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0012354152, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000
    };
    
    static const double SCALER_SCALE[291] = {
        0.3317054053, 0.1038200815, 1.0000000000, 1.0000000000, 0.0730992359, 1.0000000000, 1.0000000000, 0.0584801878,
        1.0000000000, 0.0234258822, 1.0000000000, 1.0000000000, 0.1401641030, 0.1283972165, 0.1295515187, 0.8130422439,
        0.4342606431, 0.3208086379, 0.1273178650, 0.1291366274, 0.0738957795, 0.0738957795, 0.0640397724, 0.0165668750,
        0.0896989651, 0.0963889781, 0.4077423477, 0.2732070063, 0.2174296153, 0.0422251397, 0.0957938438, 0.0422251397,
        0.1855774813, 0.0596778042, 0.1548770379, 0.8953832543, 0.1439339755, 0.1746878892, 0.2057136631, 0.1283972165,
        0.0827292159, 0.4231847059, 0.0775589312, 0.0784473964, 0.1203048911, 0.1271963019, 0.0738957795, 0.1317325764,
        0.1093573180, 0.2481650981, 0.1101234506, 0.0817368248, 0.0784473964, 0.0548706123, 0.0573177181, 0.0370243074,
        0.0351460617, 0.0468445247, 0.0286867883, 0.0286867883, 0.1998037994, 0.0453297453, 0.1389645376, 0.1991840998,
        0.3097020610, 0.1247803366, 1.4660076113, 3.8902400594, 0.3270919811, 0.2304029687, 0.3141096010, 0.1526261206,
        0.2598934881, 0.1954710117, 0.1150452993, 0.5028517928, 0.1319502416, 0.0842702523, 1.5464049532, 0.1163295695,
        0.2661673491, 0.0712368565, 0.9402542364, 0.6791336521, 0.4642626976, 0.1591853767, 0.9083697373, 0.2488219145,
        0.1527326259, 0.7653770344, 0.0896762753, 0.0618768250, 0.0234258822, 0.3795449045, 0.1440585492, 1.1933473300,
        0.2559606262, 1.1893499449, 0.3074710141, 0.1460664353, 0.2562703589, 0.4292323441, 0.0941340733, 0.0801781187,
        0.0437957062, 0.0710853978, 0.3478084449, 0.3407657653, 0.1418789191, 0.1197444389, 0.0941108510, 3.0788417182,
        0.1278734159, 0.0331200989, 0.5551848291, 1.9538505875, 0.1478989977, 0.8953832543, 0.1439339755, 0.1577258252,
        0.1283972165, 0.0827292159, 2.0315586729, 0.3317054053, 0.1869877233, 0.0573177181, 0.4017148636, 0.0405627422,
        0.3502517257, 0.6915709651, 0.7080428666, 0.8607837142, 0.0468517644, 1.3426835396, 0.3195997141, 0.1387650729,
        0.0496460016, 0.2110482169, 0.1925780669, 0.2057136631, 0.7595456141, 0.4169666458, 0.0117153539, 1.0000000000,
        0.3411734870, 0.1705867435, 0.0117153539, 0.7921174616, 0.4219918281, 0.1004712501, 0.5233767325, 0.1753071198,
        0.1062146697, 0.0536127407, 0.1139266191, 1.7737003811, 1.7737003811, 0.9478323676, 13.1119293346, 62.7338785476,
        14.9990955435, 0.0661650581, 0.0889416351, 0.0117153539, 1.0000000000, 0.0117153539, 1.0000000000, 0.1104605237,
        0.0117153539, 0.3299887970, 0.1164789774, 0.1843026974, 0.3098510857, 0.1506981542, 0.1232299893, 0.0117153539,
        0.3077293341, 0.1989035109, 0.0117153539, 0.7820205556, 0.5162616106, 0.5154021298, 0.5675841014, 1.0883407400,
        0.5549327723, 0.5549327723, 0.1717254062, 0.1329390026, 0.0117153539, 0.0117153539, 0.0801611962, 1.0000000000,
        0.0641132884, 0.1977443986, 0.0117153539, 0.0117153539, 1.0000000000, 0.0370334669, 0.0792534302, 0.1386061102,
        0.0117153539, 1.0000000000, 0.0117153539, 0.0117153539, 0.0117153539, 0.0117153539, 1.0000000000, 0.1164789774,
        0.0117153539, 0.0117153539, 1.4957454225, 1.8275407192, 1.8275407192, 1.0883407400, 0.9788163496, 6.1188906957,
        6.4161046626, 0.9370542303, 7.4937494820, 1.3594610934, 1.7267423945, 1.3526059043, 1.1125634337, 0.5145428246,
        0.4099518124, 0.3597186967, 1.0808898518, 0.4194659193, 0.3090740921, 0.7479532362, 1.2971526906, 0.4206186564,
        1.6353784709, 2.3435537476, 0.6451772950, 0.8800356221, 0.4169666458, 1.1125634337, 0.4194659193, 0.4206186564,
        0.6451772950, 0.0234307078, 1.0000000000, 1.0000000000, 0.0117153539, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 0.0117153539, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 0.0268407911, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 0.0351267560, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000
    };
    
    static const double COEF[291] = {
        -0.0003150460, 0.0002058379, 0.0000000000, 0.0000000000, 0.0003943897, 0.0000000000, 0.0000000000, -0.0002828420,
        0.0000000000, 0.0003862461, 0.0000000000, 0.0000000000, -0.0001561716, 0.0000905563, -0.0004296140, -0.0003206588,
        0.0028598075, -0.0016652187, 0.0000776950, -0.0032722318, 0.0002498999, 0.0000883560, -0.0002085412, 0.0004505516,
        0.0013166262, -0.0009719819, -0.0002940984, 0.0015042887, -0.0010013122, 0.0000647359, -0.0000777048, 0.0002455640,
        -0.0006855660, 0.0026813599, 0.0017697981, 0.0002729715, -0.0002553364, -0.0030422702, -0.0004141319, 0.0000905563,
        0.0005606458, 0.0007360561, -0.0004493867, 0.0002113150, 0.0004776890, 0.0001825945, 0.0004294936, -0.0002409760,
        0.0000754381, 0.0023279303, 0.0001366369, 0.0005361699, 0.0000646260, 0.0000551460, -0.0000094238, 0.0000474222,
        -0.0000118403, -0.0000350987, -0.0000072220, 0.0000046774, 0.0016152233, 0.0000045805, 0.0003256443, 0.0209444996,
        0.0204168178, -0.0004830167, 0.2848875429, 0.5480457383, 0.0027528611, -0.0011392501, 0.0111388791, 0.0036170084,
        0.0114556147, 0.0190207936, 0.0088928869, 0.0360755037, -0.0011689361, -0.0007290498, 0.1368189964, 0.0090993638,
        0.0135743586, -0.0012163883, 0.1034809288, 0.0383139431, 0.0258261768, 0.0104672222, 0.1318054305, -0.0118442297,
        -0.0069208798, 0.0275489776, 0.0009005056, -0.0081680923, 0.0001990134, 0.0791418551, 0.0150334528, 0.0074050396,
        0.0023223315, 0.1317242452, 0.0508099780, 0.0364637908, 0.0594937809, 0.0056051038, 0.0008911118, -0.0025990354,
        -0.0001148767, 0.0003720657, -0.0011746770, -0.0010686881, 0.0044230154, 0.0000573635, -0.0002155762, 0.3689141520,
        -0.0008590313, 0.0002220289, 0.0061303175, 0.0022731941, 0.0004490558, 0.0002729715, -0.0002553364, 0.0022254801,
        0.0000905563, 0.0005606458, 0.1332026705, -0.0003150460, 0.0043165757, 0.0003026883, 0.0029669804, 0.0000253409,
        -0.0004131745, 0.0018661816, 0.0011425673, 0.0007700778, 0.0001368738, 0.0858394360, 0.0029503961, 0.0000336474,
        0.0045920881, -0.0000773475, 0.0416907598, -0.0004141319, 0.0017147910, 0.0003196821, -0.0001444267, 0.0000000000,
        -0.0187224517, -0.0187224517, 0.0000762764, -0.0010327562, 0.0001526220, -0.0000935576, 0.0045985708, 0.0002664663,
        -0.0000851971, 0.0000642660, 0.0000724849, -0.0003028777, -0.0003028777, 0.0003864786, 0.0007761480, -0.0000856301,
        0.0018200123, -0.0015099684, 0.0012220477, 0.0000169301, 0.0000000000, 0.0008031416, 0.0000000000, 0.0003747038,
        0.0000270961, -0.0003591667, -0.0001625575, 0.0009007500, 0.0017647296, -0.0078558088, 0.0005656605, -0.0000264790,
        0.0014864769, -0.0102941983, 0.0013696389, -0.0455684187, -0.0021680268, -0.0048172762, -0.0036031941, 0.0007396931,
        -0.0004408201, -0.0004408201, -0.0000070121, 0.0000986672, 0.0000121921, 0.0000121921, 0.0000439796, 0.0000000000,
        -0.0001509031, 0.0001088832, -0.0000095006, -0.0000095006, 0.0000000000, -0.0001276896, -0.0001687388, -0.0002026723,
        -0.0000098273, 0.0000000000, -0.0000680230, -0.0000248763, -0.0000271777, -0.0000098273, 0.0000000000, -0.0001625575,
        -0.0000264790, -0.0000098273, 0.0004596924, -0.0010922940, -0.0010922940, 0.0007396931, -0.0007841048, -0.0020696895,
        -0.0011412642, 0.0002198308, 0.0016087034, 0.0009046390, 0.1083231439, -0.0034300644, -0.0019573646, 0.0112786173,
        0.0366987572, 0.0528284864, -0.0054390029, 0.0018011435, -0.0160887320, 0.0008821986, -0.0013698022, -0.0012752079,
        -0.0001572294, 0.0017335336, 0.0001734820, -0.0019859515, 0.0003196821, -0.0019573646, 0.0018011435, -0.0012752079,
        0.0001734820, 0.0000046161, 0.0000000000, 0.0000000000, -0.0000560510, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000590144, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000598981, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, -0.0000209340, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000
    };
    
    constexpr double INTERCEPT = 1.5844832361;
    
    inline double predict(const std::vector<double>& features) {
        double pred = INTERCEPT;
        for (int i = 0; i < N_FEATURES; ++i) {
            double scaled = (features[i] - SCALER_MEAN[i]) / SCALER_SCALE[i];
            pred += COEF[i] * scaled;
        }
        return pred;
    }
} // namespace VModel


// L Model (Ridge) - 294 features
namespace LModel {
    constexpr int N_FEATURES = 294;
    
    static const double SCALER_MEAN[294] = {
        0.0340425532, 0.0080988332, 0.0000000000, 0.0000000000, 0.0031571723, 0.0000000000, 0.0000000000, 0.0034317090,
        0.0000000000, 0.0005490734, 0.0000000000, 0.0000000000, 0.0160603981, 0.0111187371, 0.0100205903, 0.2765957447,
        0.1240905971, 0.0527110501, 0.0161976664, 0.0144131778, 0.0054907344, 0.0054907344, 0.0041180508, 0.0002745367,
        0.0072752231, 0.0065888813, 0.0650652025, 0.0442004118, 0.0251201098, 0.0012354152, 0.0045298559, 0.0012354152,
        0.0123541524, 0.0027453672, 0.0211393274, 0.1398764585, 0.0168840082, 0.0225120110, 0.0365133837, 0.0111187371,
        0.0043925875, 0.0656142759, 0.0049416609, 0.0048043926, 0.0087851750, 0.0124914207, 0.0054907344, 0.0089224434,
        0.0109814688, 0.0528483185, 0.0094715168, 0.0067261496, 0.0048043926, 0.0030199039, 0.0030199039, 0.0013726836,
        0.0004118051, 0.0013726836, 0.0008236102, 0.0008236102, 0.0208647907, 0.0020590254, 0.0134522992, 0.0330816747,
        0.0846945779, 0.0146877145, 1.4273164036, 2.7161290323, 0.0737131091, 0.0410432395, 0.0787920384, 0.0212765957,
        0.0421413864, 0.0344543583, 0.0089224434, 0.1444063143, 0.0126286891, 0.0060398078, 0.6463967056, 0.0075497598,
        0.0509265614, 0.0020590254, 0.4133150309, 0.3371310913, 0.0859299931, 0.0245710364, 0.6845573095, 0.0437886067,
        0.0236101579, 0.2711050103, 0.0075497598, 0.0038435141, 0.0005490734, 0.1139327385, 0.0157858614, 0.2104323953,
        0.0345916266, 0.3827041867, 0.0501029513, 0.0146877145, 0.0580645161, 0.1618393960, 0.0078242965, 0.0048043926,
        0.0019217570, 0.0050789293, 0.0927934111, 0.0439258751, 0.0179821551, 0.0145504461, 0.0080988332, 2.9913520933,
        0.0109814688, 0.0010981469, 0.1051475635, 0.2535346603, 0.0223747426, 0.1398764585, 0.0168840082, 0.0194921071,
        0.0111187371, 0.0043925875, 2.0704186685, 0.0340425532, 0.0177076184, 0.0030199039, 0.0789293068, 0.0013726836,
        0.0514756349, 0.2001372684, 0.1973919012, 0.2505147563, 0.0010981469, 0.4381606040, 0.0436513384, 0.0153740563,
        0.0024708305, 0.0321207962, 0.0306108442, 0.0365133837, 0.3400137268, 0.1191489362, 0.0001372684, 0.0000000000,
        0.0524365134, 0.0262182567, 0.0001372684, 0.2757721345, 0.1592312972, 0.0079615649, 0.1427590940, 0.0264927934,
        0.0105696637, 0.0028826356, 0.0078242965, 0.8657515443, 0.8657515443, 0.3153054221, 3.2251201098, 10.1423472889,
        1.7879203844, 0.0038435141, 0.0071379547, 0.0001372684, 0.0000000000, 0.0001372684, 0.0000000000, 0.0123541524,
        0.0001372684, 0.0520247083, 0.0126286891, 0.0249828415, 0.0737131091, 0.0221002059, 0.0137268360, 0.0001372684,
        0.0760466712, 0.0347288950, 0.0001372684, 0.4970487303, 0.1010295127, 0.2542210021, 0.2317089911, 0.3253260124,
        0.1175017159, 0.1175017159, 0.0048043926, 0.0059025395, 0.0001372684, 0.0001372684, 0.0050789293, 0.0000000000,
        0.0027453672, 0.0312971860, 0.0001372684, 0.0001372684, 0.0000000000, 0.0010981469, 0.0057652711, 0.0167467399,
        0.0001372684, 0.0000000000, 0.0001372684, 0.0001372684, 0.0001372684, 0.0001372684, 0.0000000000, 0.0126286891,
        0.0001372684, 0.0001372684, 0.3514070007, 0.5574468085, 0.5574468085, 0.3253260124, 0.2164722032, 3.3514070007,
        1.4978723404, 0.2469457790, 3.0274536719, 0.2765957447, 0.6925188744, 0.3158544955, 0.3368565546, 0.1816060398,
        0.1260123542, 0.0910089224, 0.3805078929, 0.1310912835, 0.0845573095, 0.1887439945, 0.2938915580, 0.1195607412,
        0.6910089224, 0.7229924502, 0.2425531915, 0.6964996568, 0.1191489362, 0.3368565546, 0.1310912835, 0.1195607412,
        0.2425531915, 0.0002745367, 0.0000000000, 0.0000000000, 0.0001372684, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0001372684, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0004804393, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0012354152, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 1.5844832361, 3.1191445158, 1.2261621276
    };
    
    static const double SCALER_SCALE[294] = {
        0.3317054053, 0.1038200815, 1.0000000000, 1.0000000000, 0.0730992359, 1.0000000000, 1.0000000000, 0.0584801878,
        1.0000000000, 0.0234258822, 1.0000000000, 1.0000000000, 0.1401641030, 0.1283972165, 0.1295515187, 0.8130422439,
        0.4342606431, 0.3208086379, 0.1273178650, 0.1291366274, 0.0738957795, 0.0738957795, 0.0640397724, 0.0165668750,
        0.0896989651, 0.0963889781, 0.4077423477, 0.2732070063, 0.2174296153, 0.0422251397, 0.0957938438, 0.0422251397,
        0.1855774813, 0.0596778042, 0.1548770379, 0.8953832543, 0.1439339755, 0.1746878892, 0.2057136631, 0.1283972165,
        0.0827292159, 0.4231847059, 0.0775589312, 0.0784473964, 0.1203048911, 0.1271963019, 0.0738957795, 0.1317325764,
        0.1093573180, 0.2481650981, 0.1101234506, 0.0817368248, 0.0784473964, 0.0548706123, 0.0573177181, 0.0370243074,
        0.0351460617, 0.0468445247, 0.0286867883, 0.0286867883, 0.1998037994, 0.0453297453, 0.1389645376, 0.1991840998,
        0.3097020610, 0.1247803366, 1.4660076113, 3.8902400594, 0.3270919811, 0.2304029687, 0.3141096010, 0.1526261206,
        0.2598934881, 0.1954710117, 0.1150452993, 0.5028517928, 0.1319502416, 0.0842702523, 1.5464049532, 0.1163295695,
        0.2661673491, 0.0712368565, 0.9402542364, 0.6791336521, 0.4642626976, 0.1591853767, 0.9083697373, 0.2488219145,
        0.1527326259, 0.7653770344, 0.0896762753, 0.0618768250, 0.0234258822, 0.3795449045, 0.1440585492, 1.1933473300,
        0.2559606262, 1.1893499449, 0.3074710141, 0.1460664353, 0.2562703589, 0.4292323441, 0.0941340733, 0.0801781187,
        0.0437957062, 0.0710853978, 0.3478084449, 0.3407657653, 0.1418789191, 0.1197444389, 0.0941108510, 3.0788417182,
        0.1278734159, 0.0331200989, 0.5551848291, 1.9538505875, 0.1478989977, 0.8953832543, 0.1439339755, 0.1577258252,
        0.1283972165, 0.0827292159, 2.0315586729, 0.3317054053, 0.1869877233, 0.0573177181, 0.4017148636, 0.0405627422,
        0.3502517257, 0.6915709651, 0.7080428666, 0.8607837142, 0.0468517644, 1.3426835396, 0.3195997141, 0.1387650729,
        0.0496460016, 0.2110482169, 0.1925780669, 0.2057136631, 0.7595456141, 0.4169666458, 0.0117153539, 1.0000000000,
        0.3411734870, 0.1705867435, 0.0117153539, 0.7921174616, 0.4219918281, 0.1004712501, 0.5233767325, 0.1753071198,
        0.1062146697, 0.0536127407, 0.1139266191, 1.7737003811, 1.7737003811, 0.9478323676, 13.1119293346, 62.7338785476,
        14.9990955435, 0.0661650581, 0.0889416351, 0.0117153539, 1.0000000000, 0.0117153539, 1.0000000000, 0.1104605237,
        0.0117153539, 0.3299887970, 0.1164789774, 0.1843026974, 0.3098510857, 0.1506981542, 0.1232299893, 0.0117153539,
        0.3077293341, 0.1989035109, 0.0117153539, 0.7820205556, 0.5162616106, 0.5154021298, 0.5675841014, 1.0883407400,
        0.5549327723, 0.5549327723, 0.1717254062, 0.1329390026, 0.0117153539, 0.0117153539, 0.0801611962, 1.0000000000,
        0.0641132884, 0.1977443986, 0.0117153539, 0.0117153539, 1.0000000000, 0.0370334669, 0.0792534302, 0.1386061102,
        0.0117153539, 1.0000000000, 0.0117153539, 0.0117153539, 0.0117153539, 0.0117153539, 1.0000000000, 0.1164789774,
        0.0117153539, 0.0117153539, 1.4957454225, 1.8275407192, 1.8275407192, 1.0883407400, 0.9788163496, 6.1188906957,
        6.4161046626, 0.9370542303, 7.4937494820, 1.3594610934, 1.7267423945, 1.3526059043, 1.1125634337, 0.5145428246,
        0.4099518124, 0.3597186967, 1.0808898518, 0.4194659193, 0.3090740921, 0.7479532362, 1.2971526906, 0.4206186564,
        1.6353784709, 2.3435537476, 0.6451772950, 0.8800356221, 0.4169666458, 1.1125634337, 0.4194659193, 0.4206186564,
        0.6451772950, 0.0234307078, 1.0000000000, 1.0000000000, 0.0117153539, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 0.0117153539, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 0.0268407911, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 0.0351267560, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 0.7801008847, 4.0413618714, 0.2846219823
    };
    
    static const double COEF[294] = {
        -0.0017901718, 0.0049166568, 0.0000000000, 0.0000000000, -0.0195490471, 0.0000000000, 0.0000000000, -0.0052021592,
        0.0000000000, -0.0013416781, 0.0000000000, 0.0000000000, -0.0790148008, -0.0166790165, -0.0173905380, 0.0912278965,
        -0.0489525280, 0.0674320391, 0.0158792413, -0.0377398461, -0.0106276984, 0.0292918246, -0.0262515503, -0.0023135562,
        0.0205811583, -0.0077405327, 0.0318777255, -0.0304894292, -0.0006376844, 0.0035144837, 0.0125090494, -0.0031527144,
        0.0243104521, 0.0257236447, -0.0308842969, -0.0120948426, 0.0187951377, 0.0390255428, 0.0251232612, -0.0166790165,
        -0.0304831891, -0.0140951764, -0.0088372347, -0.0031885278, -0.0070563259, 0.0075959704, -0.0255906222, 0.0114899782,
        0.0097959680, -0.0353562472, -0.0031595016, -0.0145366102, -0.0067276037, -0.0060974715, 0.0088709846, 0.0077958320,
        -0.0035082676, -0.0062714211, -0.0028819209, 0.0024881543, -0.0106572373, -0.0021396606, 0.0018170728, 0.1809142334,
        0.0785706778, 0.0308625586, -0.0168223310, 0.5714242568, -0.0333347917, -0.0117091532, 0.0183857564, 0.0404850321,
        0.1687013124, 0.0517408690, 0.0213856568, 0.2143675684, 0.0747818572, 0.0433319976, 0.3603360334, -0.0037553243,
        0.0190074553, 0.0031994992, 0.4771530946, -0.0417156602, -0.0113911396, 0.0224474640, 0.4688643462, -0.0121609666,
        -0.0110947686, 0.2106352856, 0.0203409931, 0.0299417573, -0.0047197987, 0.2983415480, 0.0881903841, -0.3680502002,
        -0.0762801462, 0.2081061279, 0.1871736904, 0.1621802308, 0.0873254139, -0.0359082276, 0.0460860210, -0.0014780874,
        -0.0009710975, -0.0245655624, -0.0377587656, -0.0488874270, 0.0014489520, -0.0695126881, 0.0200919209, 0.6511414191,
        -0.0643375760, -0.0297394375, -0.1751713631, 0.0749435363, 0.0976058935, -0.0120948427, 0.0187951377, -0.0899567939,
        -0.0166790165, -0.0304831891, 0.7591117489, -0.0017901718, 0.0461671790, -0.0038521855, 0.0266302959, 0.0197945471,
        0.0138720793, 0.0702915351, -0.0393852809, 0.0436107181, -0.0081762938, 0.5256580238, -0.0301361097, 0.0027342793,
        0.0300509391, 0.0135846481, 0.0272626470, 0.0251232612, 0.0557762553, 0.0025657963, 0.0026102288, 0.0000000000,
        -0.0258397136, -0.0258397136, 0.0007009731, -0.0060186088, 0.0315816615, 0.0180238125, 0.1454644064, -0.0200903356,
        -0.0144843888, -0.0347244908, 0.0117201370, -0.0092574674, -0.0092574674, 0.0325934703, 0.0377349724, 0.2004677320,
        -0.2710471763, 0.0319791338, 0.0218352929, -0.0050303467, 0.0000000000, -0.0081907938, 0.0000000000, 0.0137859691,
        -0.0007263003, -0.0783934782, -0.0036004552, -0.0254845378, 0.0966318658, -0.0422604520, -0.0089143538, -0.0013646837,
        0.0389891527, -0.0735074748, -0.0081770048, -0.1296479954, 0.0298817981, -0.1119207145, 0.0284670800, -0.0291341567,
        0.0180665469, 0.0180665469, 0.0024886493, -0.0015870940, -0.0006259047, -0.0006259047, -0.0009027889, 0.0000000000,
        -0.0002028559, -0.0155101928, -0.0010525774, -0.0010525774, 0.0000000000, -0.0043902096, -0.0134420237, -0.0190391605,
        -0.0005248330, 0.0000000000, -0.0012670727, -0.0005926318, -0.0010289319, -0.0005248330, 0.0000000000, -0.0036004552,
        -0.0013646837, -0.0005248330, 0.0247444384, -0.0043602932, -0.0043602932, -0.0291341567, 0.0174887674, -0.0243514512,
        -0.1097048414, 0.0262988724, 0.2484220268, 0.1162554440, -0.0752780808, 0.2380026505, -0.0048412604, 0.1839415423,
        0.2840802598, 0.2088045708, 0.0954936400, -0.0078968892, -0.1508035387, -0.1800903360, -0.0552488921, 0.0059838808,
        0.3217103128, -0.0349877150, 0.0380874952, 0.2362889244, 0.0025657963, -0.0048412604, -0.0078968892, 0.0059838808,
        0.0380874952, 0.0049966568, 0.0000000000, 0.0000000000, -0.0048505315, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, -0.0183163694, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0100573709, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, -0.0201828162, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 1.2451966693, 0.2211536948, 0.3380884930
    };
    
    constexpr double INTERCEPT = 7.0726885517;
    
    inline double predict(const std::vector<double>& features) {
        double pred = INTERCEPT;
        for (int i = 0; i < N_FEATURES; ++i) {
            double scaled = (features[i] - SCALER_MEAN[i]) / SCALER_SCALE[i];
            pred += COEF[i] * scaled;
        }
        return pred;
    }
} // namespace LModel


// E Model (Ridge) - 300 features
namespace EModel {
    constexpr int N_FEATURES = 300;
    
    static const double SCALER_MEAN[300] = {
        0.0340425532, 0.0080988332, 0.0000000000, 0.0000000000, 0.0031571723, 0.0000000000, 0.0000000000, 0.0034317090,
        0.0000000000, 0.0005490734, 0.0000000000, 0.0000000000, 0.0160603981, 0.0111187371, 0.0100205903, 0.2765957447,
        0.1240905971, 0.0527110501, 0.0161976664, 0.0144131778, 0.0054907344, 0.0054907344, 0.0041180508, 0.0002745367,
        0.0072752231, 0.0065888813, 0.0650652025, 0.0442004118, 0.0251201098, 0.0012354152, 0.0045298559, 0.0012354152,
        0.0123541524, 0.0027453672, 0.0211393274, 0.1398764585, 0.0168840082, 0.0225120110, 0.0365133837, 0.0111187371,
        0.0043925875, 0.0656142759, 0.0049416609, 0.0048043926, 0.0087851750, 0.0124914207, 0.0054907344, 0.0089224434,
        0.0109814688, 0.0528483185, 0.0094715168, 0.0067261496, 0.0048043926, 0.0030199039, 0.0030199039, 0.0013726836,
        0.0004118051, 0.0013726836, 0.0008236102, 0.0008236102, 0.0208647907, 0.0020590254, 0.0134522992, 0.0330816747,
        0.0846945779, 0.0146877145, 1.4273164036, 2.7161290323, 0.0737131091, 0.0410432395, 0.0787920384, 0.0212765957,
        0.0421413864, 0.0344543583, 0.0089224434, 0.1444063143, 0.0126286891, 0.0060398078, 0.6463967056, 0.0075497598,
        0.0509265614, 0.0020590254, 0.4133150309, 0.3371310913, 0.0859299931, 0.0245710364, 0.6845573095, 0.0437886067,
        0.0236101579, 0.2711050103, 0.0075497598, 0.0038435141, 0.0005490734, 0.1139327385, 0.0157858614, 0.2104323953,
        0.0345916266, 0.3827041867, 0.0501029513, 0.0146877145, 0.0580645161, 0.1618393960, 0.0078242965, 0.0048043926,
        0.0019217570, 0.0050789293, 0.0927934111, 0.0439258751, 0.0179821551, 0.0145504461, 0.0080988332, 2.9913520933,
        0.0109814688, 0.0010981469, 0.1051475635, 0.2535346603, 0.0223747426, 0.1398764585, 0.0168840082, 0.0194921071,
        0.0111187371, 0.0043925875, 2.0704186685, 0.0340425532, 0.0177076184, 0.0030199039, 0.0789293068, 0.0013726836,
        0.0514756349, 0.2001372684, 0.1973919012, 0.2505147563, 0.0010981469, 0.4381606040, 0.0436513384, 0.0153740563,
        0.0024708305, 0.0321207962, 0.0306108442, 0.0365133837, 0.3400137268, 0.1191489362, 0.0001372684, 0.0000000000,
        0.0524365134, 0.0262182567, 0.0001372684, 0.2757721345, 0.1592312972, 0.0079615649, 0.1427590940, 0.0264927934,
        0.0105696637, 0.0028826356, 0.0078242965, 0.8657515443, 0.8657515443, 0.3153054221, 3.2251201098, 10.1423472889,
        1.7879203844, 0.0038435141, 0.0071379547, 0.0001372684, 0.0000000000, 0.0001372684, 0.0000000000, 0.0123541524,
        0.0001372684, 0.0520247083, 0.0126286891, 0.0249828415, 0.0737131091, 0.0221002059, 0.0137268360, 0.0001372684,
        0.0760466712, 0.0347288950, 0.0001372684, 0.4970487303, 0.1010295127, 0.2542210021, 0.2317089911, 0.3253260124,
        0.1175017159, 0.1175017159, 0.0048043926, 0.0059025395, 0.0001372684, 0.0001372684, 0.0050789293, 0.0000000000,
        0.0027453672, 0.0312971860, 0.0001372684, 0.0001372684, 0.0000000000, 0.0010981469, 0.0057652711, 0.0167467399,
        0.0001372684, 0.0000000000, 0.0001372684, 0.0001372684, 0.0001372684, 0.0001372684, 0.0000000000, 0.0126286891,
        0.0001372684, 0.0001372684, 0.3514070007, 0.5574468085, 0.5574468085, 0.3253260124, 0.2164722032, 3.3514070007,
        1.4978723404, 0.2469457790, 3.0274536719, 0.2765957447, 0.6925188744, 0.3158544955, 0.3368565546, 0.1816060398,
        0.1260123542, 0.0910089224, 0.3805078929, 0.1310912835, 0.0845573095, 0.1887439945, 0.2938915580, 0.1195607412,
        0.6910089224, 0.7229924502, 0.2425531915, 0.6964996568, 0.1191489362, 0.3368565546, 0.1310912835, 0.1195607412,
        0.2425531915, 0.0002745367, 0.0000000000, 0.0000000000, 0.0001372684, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0001372684, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0004804393, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0012354152, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 1.5844832361, 7.0726885517, 3.1191445158, 66.6618791658, 14.1815507382,
        1.2261621276, 2.5604906257, 0.2421952204, 4.3007703254
    };
    
    static const double SCALER_SCALE[300] = {
        0.3317054053, 0.1038200815, 1.0000000000, 1.0000000000, 0.0730992359, 1.0000000000, 1.0000000000, 0.0584801878,
        1.0000000000, 0.0234258822, 1.0000000000, 1.0000000000, 0.1401641030, 0.1283972165, 0.1295515187, 0.8130422439,
        0.4342606431, 0.3208086379, 0.1273178650, 0.1291366274, 0.0738957795, 0.0738957795, 0.0640397724, 0.0165668750,
        0.0896989651, 0.0963889781, 0.4077423477, 0.2732070063, 0.2174296153, 0.0422251397, 0.0957938438, 0.0422251397,
        0.1855774813, 0.0596778042, 0.1548770379, 0.8953832543, 0.1439339755, 0.1746878892, 0.2057136631, 0.1283972165,
        0.0827292159, 0.4231847059, 0.0775589312, 0.0784473964, 0.1203048911, 0.1271963019, 0.0738957795, 0.1317325764,
        0.1093573180, 0.2481650981, 0.1101234506, 0.0817368248, 0.0784473964, 0.0548706123, 0.0573177181, 0.0370243074,
        0.0351460617, 0.0468445247, 0.0286867883, 0.0286867883, 0.1998037994, 0.0453297453, 0.1389645376, 0.1991840998,
        0.3097020610, 0.1247803366, 1.4660076113, 3.8902400594, 0.3270919811, 0.2304029687, 0.3141096010, 0.1526261206,
        0.2598934881, 0.1954710117, 0.1150452993, 0.5028517928, 0.1319502416, 0.0842702523, 1.5464049532, 0.1163295695,
        0.2661673491, 0.0712368565, 0.9402542364, 0.6791336521, 0.4642626976, 0.1591853767, 0.9083697373, 0.2488219145,
        0.1527326259, 0.7653770344, 0.0896762753, 0.0618768250, 0.0234258822, 0.3795449045, 0.1440585492, 1.1933473300,
        0.2559606262, 1.1893499449, 0.3074710141, 0.1460664353, 0.2562703589, 0.4292323441, 0.0941340733, 0.0801781187,
        0.0437957062, 0.0710853978, 0.3478084449, 0.3407657653, 0.1418789191, 0.1197444389, 0.0941108510, 3.0788417182,
        0.1278734159, 0.0331200989, 0.5551848291, 1.9538505875, 0.1478989977, 0.8953832543, 0.1439339755, 0.1577258252,
        0.1283972165, 0.0827292159, 2.0315586729, 0.3317054053, 0.1869877233, 0.0573177181, 0.4017148636, 0.0405627422,
        0.3502517257, 0.6915709651, 0.7080428666, 0.8607837142, 0.0468517644, 1.3426835396, 0.3195997141, 0.1387650729,
        0.0496460016, 0.2110482169, 0.1925780669, 0.2057136631, 0.7595456141, 0.4169666458, 0.0117153539, 1.0000000000,
        0.3411734870, 0.1705867435, 0.0117153539, 0.7921174616, 0.4219918281, 0.1004712501, 0.5233767325, 0.1753071198,
        0.1062146697, 0.0536127407, 0.1139266191, 1.7737003811, 1.7737003811, 0.9478323676, 13.1119293346, 62.7338785476,
        14.9990955435, 0.0661650581, 0.0889416351, 0.0117153539, 1.0000000000, 0.0117153539, 1.0000000000, 0.1104605237,
        0.0117153539, 0.3299887970, 0.1164789774, 0.1843026974, 0.3098510857, 0.1506981542, 0.1232299893, 0.0117153539,
        0.3077293341, 0.1989035109, 0.0117153539, 0.7820205556, 0.5162616106, 0.5154021298, 0.5675841014, 1.0883407400,
        0.5549327723, 0.5549327723, 0.1717254062, 0.1329390026, 0.0117153539, 0.0117153539, 0.0801611962, 1.0000000000,
        0.0641132884, 0.1977443986, 0.0117153539, 0.0117153539, 1.0000000000, 0.0370334669, 0.0792534302, 0.1386061102,
        0.0117153539, 1.0000000000, 0.0117153539, 0.0117153539, 0.0117153539, 0.0117153539, 1.0000000000, 0.1164789774,
        0.0117153539, 0.0117153539, 1.4957454225, 1.8275407192, 1.8275407192, 1.0883407400, 0.9788163496, 6.1188906957,
        6.4161046626, 0.9370542303, 7.4937494820, 1.3594610934, 1.7267423945, 1.3526059043, 1.1125634337, 0.5145428246,
        0.4099518124, 0.3597186967, 1.0808898518, 0.4194659193, 0.3090740921, 0.7479532362, 1.2971526906, 0.4206186564,
        1.6353784709, 2.3435537476, 0.6451772950, 0.8800356221, 0.4169666458, 1.1125634337, 0.4194659193, 0.4206186564,
        0.6451772950, 0.0234307078, 1.0000000000, 1.0000000000, 0.0117153539, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 0.0117153539, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 0.0268407911, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 0.0351267560, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 0.7801008847, 4.0790876207, 4.0413618714, 97.5494134786, 19.3447225856,
        0.2846219823, 0.7190400273, 0.4782962439, 1.4050227519
    };
    
    static const double COEF[300] = {
        -0.0054171670, 0.0011798588, 0.0000000000, 0.0000000000, 0.0018502400, 0.0000000000, 0.0000000000, 0.0021566271,
        0.0000000000, 0.0161248914, 0.0000000000, 0.0000000000, -0.0087852270, 0.0015633876, -0.0010668990, 0.0430171515,
        -0.0168410479, 0.0062033263, 0.0026026734, -0.0063557945, -0.0165549293, -0.0005249222, -0.0058325681, -0.0001165767,
        0.0031838548, 0.0006785985, 0.0109003098, 0.0056751254, -0.0039121895, 0.0001823388, 0.0011574453, 0.0024074133,
        0.0031941837, -0.0000248774, 0.0023734359, 0.0143853095, -0.0018329598, 0.0169896768, 0.0175857674, 0.0015633876,
        -0.0079665370, 0.0100851589, -0.0028915806, 0.0032592425, -0.0065491876, 0.0091042496, 0.0035815450, -0.0036935708,
        -0.0008580529, 0.0026381573, -0.0019062539, -0.0018367666, -0.0009669193, -0.0009880196, 0.0020880301, -0.0002546200,
        -0.0007843861, -0.0021715638, 0.0007483831, 0.0009792701, 0.0052729779, 0.0018946895, 0.0032627378, 0.0318750311,
        -0.1503662583, -0.0058714456, -0.2257483614, -0.1622082463, 0.0052225664, 0.0151141011, 0.0278411994, 0.0294092193,
        0.0539983412, 0.0140220947, 0.0054013797, 0.0402159757, 0.0078120619, 0.0014758571, 0.1374294468, -0.0249210668,
        -0.0310738112, -0.0057884124, 0.0415065484, -0.0010742366, 0.0082195751, -0.0110957061, 0.0446267577, 0.0215526698,
        0.0096424942, 0.1544269116, 0.0089637806, 0.0118298422, 0.0022577466, 0.0750683277, 0.0130465620, -0.1811301801,
        -0.0418768970, 0.0490738629, 0.0594764389, 0.0687262683, -0.0009498112, -0.0556058499, -0.0080669508, -0.0119636808,
        0.0039193752, -0.0070464819, -0.0164333375, 0.0096255379, 0.0150442490, -0.0032722167, 0.0082637138, 0.0504002463,
        -0.0327851807, -0.0058985080, -0.0534285439, 0.0306447352, 0.0201554552, 0.0143853095, -0.0018329598, -0.0160475579,
        0.0015633876, -0.0079665370, 0.2738210728, -0.0054171670, 0.0188198877, 0.0075709699, 0.0213480357, 0.0099347173,
        0.0081942259, 0.0069410128, 0.0072690173, 0.0080083969, -0.0053241393, 0.2230447811, -0.0080274979, -0.0035391374,
        -0.0024967653, -0.0030912488, -0.0081759269, 0.0175857674, -0.0345754445, -0.0117692366, -0.0000615776, 0.0000000000,
        -0.0123560103, -0.0123560103, -0.0004478417, 0.0088916427, -0.0109249177, -0.0055025955, 0.0262749668, -0.0089263037,
        0.0060917943, -0.0031576658, -0.0020846278, 0.0072354831, 0.0072354831, 0.0249821733, 0.0125875494, 0.1594852038,
        -0.1884987455, 0.0116280968, 0.0034365909, -0.0002285390, 0.0000000000, -0.0017129262, 0.0000000000, 0.0022060008,
        -0.0003467486, -0.0093539662, -0.0006232805, -0.0135560178, 0.0225835125, -0.0091060972, -0.0017992408, -0.0002430981,
        0.0141790379, -0.0141118730, -0.0024443217, -0.0006879190, -0.0195769136, -0.0025492878, 0.0082007440, -0.0138786502,
        0.0071870681, 0.0071870681, 0.0007431746, 0.0002794380, 0.0002250692, 0.0002250692, -0.0004850085, 0.0000000000,
        0.0012582786, -0.0024143409, 0.0000826555, 0.0000826555, 0.0000000000, -0.0012425010, -0.0022283152, -0.0028580728,
        0.0000411574, 0.0000000000, -0.0002245618, 0.0000589833, 0.0000905379, 0.0000411574, 0.0000000000, -0.0006232805,
        -0.0002430981, 0.0000411574, 0.0007496814, 0.0067975788, 0.0067975788, -0.0138786502, 0.0171141300, -0.0961527171,
        -0.0618793592, 0.0007098071, 0.1303839831, 0.0323280552, -0.0811807111, 0.0033073600, -0.0124005088, 0.1311184118,
        0.0604294665, 0.0210845372, -0.0393076088, -0.0178045042, 0.0754294730, -0.0369015760, -0.0089601309, 0.0035894074,
        0.0233021529, -0.0232918365, -0.0090466372, 0.1004111936, -0.0117692366, -0.0124005088, -0.0178045042, 0.0035894074,
        -0.0090466372, -0.0007032174, 0.0000000000, 0.0000000000, -0.0028711126, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, -0.0055043242, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0076771184, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, -0.0095184738, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, -0.0446714520, 0.1952295096, 0.0946379134, -0.1178820511, 0.0005316906,
        0.1601124321, -0.0856102597, 0.0000050457, -0.0006903513
    };
    
    constexpr double INTERCEPT = 1.0094405628;
    
    inline double predict(const std::vector<double>& features) {
        double pred = INTERCEPT;
        for (int i = 0; i < N_FEATURES; ++i) {
            double scaled = (features[i] - SCALER_MEAN[i]) / SCALER_SCALE[i];
            pred += COEF[i] * scaled;
        }
        return pred;
    }
} // namespace EModel


// B Model (Ridge) - 309 features
namespace BModel {
    constexpr int N_FEATURES = 309;
    
    static const double SCALER_MEAN[309] = {
        0.0340425532, 0.0080988332, 0.0000000000, 0.0000000000, 0.0031571723, 0.0000000000, 0.0000000000, 0.0034317090,
        0.0000000000, 0.0005490734, 0.0000000000, 0.0000000000, 0.0160603981, 0.0111187371, 0.0100205903, 0.2765957447,
        0.1240905971, 0.0527110501, 0.0161976664, 0.0144131778, 0.0054907344, 0.0054907344, 0.0041180508, 0.0002745367,
        0.0072752231, 0.0065888813, 0.0650652025, 0.0442004118, 0.0251201098, 0.0012354152, 0.0045298559, 0.0012354152,
        0.0123541524, 0.0027453672, 0.0211393274, 0.1398764585, 0.0168840082, 0.0225120110, 0.0365133837, 0.0111187371,
        0.0043925875, 0.0656142759, 0.0049416609, 0.0048043926, 0.0087851750, 0.0124914207, 0.0054907344, 0.0089224434,
        0.0109814688, 0.0528483185, 0.0094715168, 0.0067261496, 0.0048043926, 0.0030199039, 0.0030199039, 0.0013726836,
        0.0004118051, 0.0013726836, 0.0008236102, 0.0008236102, 0.0208647907, 0.0020590254, 0.0134522992, 0.0330816747,
        0.0846945779, 0.0146877145, 1.4273164036, 2.7161290323, 0.0737131091, 0.0410432395, 0.0787920384, 0.0212765957,
        0.0421413864, 0.0344543583, 0.0089224434, 0.1444063143, 0.0126286891, 0.0060398078, 0.6463967056, 0.0075497598,
        0.0509265614, 0.0020590254, 0.4133150309, 0.3371310913, 0.0859299931, 0.0245710364, 0.6845573095, 0.0437886067,
        0.0236101579, 0.2711050103, 0.0075497598, 0.0038435141, 0.0005490734, 0.1139327385, 0.0157858614, 0.2104323953,
        0.0345916266, 0.3827041867, 0.0501029513, 0.0146877145, 0.0580645161, 0.1618393960, 0.0078242965, 0.0048043926,
        0.0019217570, 0.0050789293, 0.0927934111, 0.0439258751, 0.0179821551, 0.0145504461, 0.0080988332, 2.9913520933,
        0.0109814688, 0.0010981469, 0.1051475635, 0.2535346603, 0.0223747426, 0.1398764585, 0.0168840082, 0.0194921071,
        0.0111187371, 0.0043925875, 2.0704186685, 0.0340425532, 0.0177076184, 0.0030199039, 0.0789293068, 0.0013726836,
        0.0514756349, 0.2001372684, 0.1973919012, 0.2505147563, 0.0010981469, 0.4381606040, 0.0436513384, 0.0153740563,
        0.0024708305, 0.0321207962, 0.0306108442, 0.0365133837, 0.3400137268, 0.1191489362, 0.0001372684, 0.0000000000,
        0.0524365134, 0.0262182567, 0.0001372684, 0.2757721345, 0.1592312972, 0.0079615649, 0.1427590940, 0.0264927934,
        0.0105696637, 0.0028826356, 0.0078242965, 0.8657515443, 0.8657515443, 0.3153054221, 3.2251201098, 10.1423472889,
        1.7879203844, 0.0038435141, 0.0071379547, 0.0001372684, 0.0000000000, 0.0001372684, 0.0000000000, 0.0123541524,
        0.0001372684, 0.0520247083, 0.0126286891, 0.0249828415, 0.0737131091, 0.0221002059, 0.0137268360, 0.0001372684,
        0.0760466712, 0.0347288950, 0.0001372684, 0.4970487303, 0.1010295127, 0.2542210021, 0.2317089911, 0.3253260124,
        0.1175017159, 0.1175017159, 0.0048043926, 0.0059025395, 0.0001372684, 0.0001372684, 0.0050789293, 0.0000000000,
        0.0027453672, 0.0312971860, 0.0001372684, 0.0001372684, 0.0000000000, 0.0010981469, 0.0057652711, 0.0167467399,
        0.0001372684, 0.0000000000, 0.0001372684, 0.0001372684, 0.0001372684, 0.0001372684, 0.0000000000, 0.0126286891,
        0.0001372684, 0.0001372684, 0.3514070007, 0.5574468085, 0.5574468085, 0.3253260124, 0.2164722032, 3.3514070007,
        1.4978723404, 0.2469457790, 3.0274536719, 0.2765957447, 0.6925188744, 0.3158544955, 0.3368565546, 0.1816060398,
        0.1260123542, 0.0910089224, 0.3805078929, 0.1310912835, 0.0845573095, 0.1887439945, 0.2938915580, 0.1195607412,
        0.6910089224, 0.7229924502, 0.2425531915, 0.6964996568, 0.1191489362, 0.3368565546, 0.1310912835, 0.1195607412,
        0.2425531915, 0.0002745367, 0.0000000000, 0.0000000000, 0.0001372684, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0001372684, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0004804393, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0012354152, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 1.5844832361, 7.0726885517, 1.0094405628, 3.1191445158, 66.6618791658,
        1.7394968137, 14.1815507382, 1.9745334677, 9.9259034489, 1.2261621276, 2.5604906257, 0.9076016735, 0.2421952204,
        4.5653707213, 4.3007703254, 16.3835380376, 0.6235700554, 0.1276546823
    };
    
    static const double SCALER_SCALE[309] = {
        0.3317054053, 0.1038200815, 1.0000000000, 1.0000000000, 0.0730992359, 1.0000000000, 1.0000000000, 0.0584801878,
        1.0000000000, 0.0234258822, 1.0000000000, 1.0000000000, 0.1401641030, 0.1283972165, 0.1295515187, 0.8130422439,
        0.4342606431, 0.3208086379, 0.1273178650, 0.1291366274, 0.0738957795, 0.0738957795, 0.0640397724, 0.0165668750,
        0.0896989651, 0.0963889781, 0.4077423477, 0.2732070063, 0.2174296153, 0.0422251397, 0.0957938438, 0.0422251397,
        0.1855774813, 0.0596778042, 0.1548770379, 0.8953832543, 0.1439339755, 0.1746878892, 0.2057136631, 0.1283972165,
        0.0827292159, 0.4231847059, 0.0775589312, 0.0784473964, 0.1203048911, 0.1271963019, 0.0738957795, 0.1317325764,
        0.1093573180, 0.2481650981, 0.1101234506, 0.0817368248, 0.0784473964, 0.0548706123, 0.0573177181, 0.0370243074,
        0.0351460617, 0.0468445247, 0.0286867883, 0.0286867883, 0.1998037994, 0.0453297453, 0.1389645376, 0.1991840998,
        0.3097020610, 0.1247803366, 1.4660076113, 3.8902400594, 0.3270919811, 0.2304029687, 0.3141096010, 0.1526261206,
        0.2598934881, 0.1954710117, 0.1150452993, 0.5028517928, 0.1319502416, 0.0842702523, 1.5464049532, 0.1163295695,
        0.2661673491, 0.0712368565, 0.9402542364, 0.6791336521, 0.4642626976, 0.1591853767, 0.9083697373, 0.2488219145,
        0.1527326259, 0.7653770344, 0.0896762753, 0.0618768250, 0.0234258822, 0.3795449045, 0.1440585492, 1.1933473300,
        0.2559606262, 1.1893499449, 0.3074710141, 0.1460664353, 0.2562703589, 0.4292323441, 0.0941340733, 0.0801781187,
        0.0437957062, 0.0710853978, 0.3478084449, 0.3407657653, 0.1418789191, 0.1197444389, 0.0941108510, 3.0788417182,
        0.1278734159, 0.0331200989, 0.5551848291, 1.9538505875, 0.1478989977, 0.8953832543, 0.1439339755, 0.1577258252,
        0.1283972165, 0.0827292159, 2.0315586729, 0.3317054053, 0.1869877233, 0.0573177181, 0.4017148636, 0.0405627422,
        0.3502517257, 0.6915709651, 0.7080428666, 0.8607837142, 0.0468517644, 1.3426835396, 0.3195997141, 0.1387650729,
        0.0496460016, 0.2110482169, 0.1925780669, 0.2057136631, 0.7595456141, 0.4169666458, 0.0117153539, 1.0000000000,
        0.3411734870, 0.1705867435, 0.0117153539, 0.7921174616, 0.4219918281, 0.1004712501, 0.5233767325, 0.1753071198,
        0.1062146697, 0.0536127407, 0.1139266191, 1.7737003811, 1.7737003811, 0.9478323676, 13.1119293346, 62.7338785476,
        14.9990955435, 0.0661650581, 0.0889416351, 0.0117153539, 1.0000000000, 0.0117153539, 1.0000000000, 0.1104605237,
        0.0117153539, 0.3299887970, 0.1164789774, 0.1843026974, 0.3098510857, 0.1506981542, 0.1232299893, 0.0117153539,
        0.3077293341, 0.1989035109, 0.0117153539, 0.7820205556, 0.5162616106, 0.5154021298, 0.5675841014, 1.0883407400,
        0.5549327723, 0.5549327723, 0.1717254062, 0.1329390026, 0.0117153539, 0.0117153539, 0.0801611962, 1.0000000000,
        0.0641132884, 0.1977443986, 0.0117153539, 0.0117153539, 1.0000000000, 0.0370334669, 0.0792534302, 0.1386061102,
        0.0117153539, 1.0000000000, 0.0117153539, 0.0117153539, 0.0117153539, 0.0117153539, 1.0000000000, 0.1164789774,
        0.0117153539, 0.0117153539, 1.4957454225, 1.8275407192, 1.8275407192, 1.0883407400, 0.9788163496, 6.1188906957,
        6.4161046626, 0.9370542303, 7.4937494820, 1.3594610934, 1.7267423945, 1.3526059043, 1.1125634337, 0.5145428246,
        0.4099518124, 0.3597186967, 1.0808898518, 0.4194659193, 0.3090740921, 0.7479532362, 1.2971526906, 0.4206186564,
        1.6353784709, 2.3435537476, 0.6451772950, 0.8800356221, 0.4169666458, 1.1125634337, 0.4194659193, 0.4206186564,
        0.6451772950, 0.0234307078, 1.0000000000, 1.0000000000, 0.0117153539, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 0.0117153539, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 0.0268407911, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 0.0351267560, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000, 1.0000000000,
        1.0000000000, 1.0000000000, 1.0000000000, 0.7801008847, 4.0790876207, 0.8488383614, 4.0413618714, 97.5494134786,
        2.7547679562, 19.3447225856, 2.8312918055, 15.2019638951, 0.2846219823, 0.7190400273, 0.4430808243, 0.4782962439,
        76.3540281653, 1.4050227519, 236.0463269978, 0.4358539664, 0.3831763363
    };
    
    static const double COEF[309] = {
        -0.0127516295, -0.0110169211, 0.0000000000, 0.0000000000, -0.0130104789, 0.0000000000, 0.0000000000, 0.0085818463,
        0.0000000000, 0.0002192790, 0.0000000000, 0.0000000000, -0.0153523427, -0.0070871230, -0.0005120181, 0.0531968620,
        -0.0302115036, -0.0454271860, -0.0033923897, 0.0003375924, -0.0002785720, 0.0030626786, 0.0067231221, 0.0038902602,
        0.0033987408, -0.0126125043, 0.0070506463, 0.0518160599, -0.0008513604, -0.0071655489, -0.0059169535, 0.0014674177,
        -0.0120692377, -0.0030071093, 0.0344289448, -0.0375357074, -0.0033156118, 0.0052020460, 0.0044064224, -0.0070871230,
        -0.0031640023, -0.0351986191, 0.0054938760, -0.0102859253, 0.0012108415, 0.0111027863, -0.0025865522, -0.0066963971,
        -0.0074845601, 0.0382952282, -0.0047255245, 0.0037640582, -0.0024526821, -0.0016512747, -0.0006094781, 0.0031486094,
        -0.0001705169, -0.0008991465, -0.0022303885, -0.0033954346, 0.0390564070, 0.0009302535, 0.0088109464, -0.0125791498,
        0.1377871092, -0.0206863971, 0.0170866154, 0.0825253650, 0.0529122038, 0.0038631760, 0.0809840550, 0.0195723297,
        0.0382921918, 0.0074413374, 0.0125723872, 0.0765193475, 0.0247877550, 0.0142733866, 0.1055488520, -0.0157859372,
        -0.0313061934, -0.0100597032, 0.3015092724, -0.0463512008, -0.0590051840, 0.0016629112, 0.1769891430, -0.0029589883,
        -0.0177118811, 0.0924937692, -0.0057138139, 0.0202888602, -0.0048110060, 0.0122264569, 0.0483876470, -0.0082456619,
        0.0056685339, -0.0266232904, -0.0127765464, -0.0043973752, -0.0066823624, 0.0715717778, 0.0190029276, -0.0018159788,
        0.0018615417, -0.0227518271, -0.0190623537, -0.0199216270, 0.0017207880, -0.0062621579, -0.0102871846, 0.0869388271,
        -0.0160766735, 0.0056885078, -0.0803790064, 0.0343302903, 0.0049708159, -0.0375357074, -0.0033156118, 0.0033678875,
        -0.0070871230, -0.0031640023, 0.0027822899, -0.0127516295, 0.0060607293, 0.0046735037, -0.0184433473, 0.0030868917,
        -0.0018719558, -0.0015169299, 0.0104820364, -0.0027761289, -0.0002913815, -0.0072869855, -0.0135155151, 0.0061610038,
        0.0173271312, 0.0063364721, -0.0028060834, 0.0044064224, 0.0226311456, -0.0097755994, 0.0009297312, 0.0000000000,
        -0.0047985811, -0.0047985811, -0.0002975074, -0.0054827378, -0.0443075707, -0.0034466186, 0.0345100984, 0.0144701440,
        -0.0129617071, -0.0016278830, -0.0005929883, -0.0015253044, -0.0015253044, 0.0102751553, 0.0011556763, -0.0109851893,
        0.0480493430, 0.0024700392, 0.0033757438, -0.0003689578, 0.0000000000, 0.0003942997, 0.0000000000, -0.0015823841,
        -0.0007938290, 0.0037368664, 0.0005191500, -0.0163218114, -0.0081801245, 0.0066635882, -0.0050617581, -0.0002854539,
        -0.0108101601, 0.0061438203, 0.0001264317, 0.0253294722, -0.0564966202, -0.0588060325, -0.0117016643, -0.0180287374,
        0.0091029101, 0.0091029101, 0.0002531486, -0.0028473659, -0.0004568841, -0.0004568841, 0.0011498673, 0.0000000000,
        -0.0028517697, 0.0004191912, -0.0002973617, -0.0002973617, 0.0000000000, -0.0013608702, -0.0014459451, -0.0030857855,
        -0.0002165986, 0.0000000000, -0.0004892895, -0.0004023322, -0.0004911269, -0.0002165986, 0.0000000000, 0.0005191500,
        -0.0002854539, -0.0002165986, 0.0087027496, 0.0293509388, 0.0293509388, -0.0180287374, 0.0034140710, -0.2763679824,
        -0.0311083660, 0.0020243179, 0.0480499061, -0.0423909093, -0.0258429705, 0.0134626250, -0.0061245405, -0.0043757378,
        0.0273149554, 0.0620968948, 0.0550918207, 0.0016772654, -0.2032473796, -0.1627656243, 0.0569681676, -0.0303990052,
        0.2564089471, -0.0053587043, 0.0142461489, -0.1483251355, -0.0097755994, -0.0061245405, 0.0016772654, -0.0303990052,
        0.0142461489, -0.0028795142, 0.0000000000, 0.0000000000, 0.0018265371, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, -0.0043254756, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0009167152, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, -0.0023884580, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000, 0.0000000000,
        0.0000000000, 0.0000000000, 0.0000000000, 0.2030933094, 0.1813973493, 0.0197727631, -0.2062190875, -0.0042159144,
        0.0578531461, 0.1929188946, 0.1199287401, -0.2199470589, -0.1685928680, 0.0165670391, 0.0716351763, 0.0072320307,
        -0.0230955134, -0.0207410525, 0.0241170424, -0.0553481553, 0.0067265078
    };
    
    constexpr double INTERCEPT = 0.6941333105;
    
    inline double predict(const std::vector<double>& features) {
        double pred = INTERCEPT;
        for (int i = 0; i < N_FEATURES; ++i) {
            double scaled = (features[i] - SCALER_MEAN[i]) / SCALER_SCALE[i];
            pred += COEF[i] * scaled;
        }
        return pred;
    }
} // namespace BModel


// XGBoost models for S and A will be in separate files (too large for header)

// Cascade prediction function
inline std::vector<double> predictCascade(const std::vector<double>& base291) {
    std::vector<double> results(6);
    std::vector<double> preds;
    
    // V (no previous)
    results[0] = VModel::predict(base291);
    preds.push_back(results[0]);
    
    // L (uses V)
    auto lsfer_L = createLSFERFeatures(preds, 1);
    std::vector<double> feat_L = base291;
    feat_L.insert(feat_L.end(), lsfer_L.begin(), lsfer_L.end());
    results[1] = LModel::predict(feat_L);
    preds.push_back(results[1]);
    
    // E (uses V, L)
    auto lsfer_E = createLSFERFeatures(preds, 2);
    std::vector<double> feat_E = base291;
    feat_E.insert(feat_E.end(), lsfer_E.begin(), lsfer_E.end());
    results[2] = EModel::predict(feat_E);
    preds.push_back(results[2]);
    
    // B (uses V, L, E)
    auto lsfer_B = createLSFERFeatures(preds, 3);
    std::vector<double> feat_B = base291;
    feat_B.insert(feat_B.end(), lsfer_B.begin(), lsfer_B.end());
    results[3] = BModel::predict(feat_B);
    preds.push_back(results[3]);
    
    // S and A use XGBoost (external)
    // results[4] = predictS(base291, preds);  // XGBoost
    // results[5] = predictA(base291, preds);  // XGBoost
    
    return results;  // [V, L, E, B, S, A]
}

} // namespace AbrahamV2Cascade
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
