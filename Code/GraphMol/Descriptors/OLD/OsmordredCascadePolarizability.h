#pragma once
// Auto-generated Ridge model for Polarizability
// Features: 540, Alpha: 0.001000
// Trained on 1670 molecules, RÂ² = 1.0000

#include <cmath>
#include <algorithm>

namespace Osmordred {
namespace CascadePolarizability {

constexpr int N_FEATURES = 540;

// Scaler parameters
inline const double MEAN[] = {
    0.0497005988,
    0.0065868263,
    0.0000000000,
    0.0000000000,
    0.0113772455,
    0.0000000000,
    0.0000000000,
    0.0011976048,
    0.0000000000,
    0.0005988024,
    0.0000000000,
    0.0000000000,
    0.0323353293,
    0.0107784431,
    0.0167664671,
    0.3419161677,
    0.1011976048,
    0.1538922156,
    0.0467065868,
    0.0353293413,
    0.0311377246,
    0.0203592814,
    0.0167664671,
    0.0000000000,
    0.0095808383,
    0.0000000000,
    0.0610778443,
    0.0467065868,
    0.0185628743,
    0.0035928144,
    0.0005988024,
    0.0005988024,
    0.0125748503,
    0.0023952096,
    0.0287425150,
    0.1580838323,
    0.0347305389,
    0.0173652695,
    0.0622754491,
    0.0107784431,
    0.0017964072,
    0.0526946108,
    0.0053892216,
    0.0071856287,
    0.0167664671,
    0.0161676647,
    0.0005988024,
    0.0137724551,
    0.0149700599,
    0.0419161677,
    0.0167664671,
    0.0155688623,
    0.0041916168,
    0.0017964072,
    0.0011976048,
    0.0023952096,
    0.0000000000,
    0.0011976048,
    0.0017964072,
    0.0000000000,
    0.0766467066,
    0.0011976048,
    0.0233532934,
    0.0377245509,
    0.0856287425,
    0.0245508982,
    1.2880239521,
    1.8287425150,
    0.1185628743,
    0.0916167665,
    0.0820359281,
    0.0395209581,
    0.0323353293,
    0.0131736527,
    0.0113772455,
    0.2209580838,
    0.0131736527,
    0.0053892216,
    0.6586826347,
    0.0077844311,
    0.0455089820,
    0.0029940120,
    0.4455089820,
    0.3167664671,
    0.0670658683,
    0.0239520958,
    0.7796407186,
    0.0520958084,
    0.0143712575,
    0.2832335329,
    0.0353293413,
    0.0029940120,
    0.0011976048,
    0.1514970060,
    0.0293413174,
    0.0610778443,
    0.0227544910,
    0.5562874251,
    0.0520958084,
    0.0215568862,
    0.0449101796,
    0.1299401198,
    0.0101796407,
    0.0041916168,
    0.0000000000,
    0.0017964072,
    0.1491017964,
    0.1652694611,
    0.0365269461,
    0.0598802395,
    0.0293413174,
    3.1784431138,
    0.0664670659,
    0.0005988024,
    0.0538922156,
    0.0808383234,
    0.0395209581,
    0.1580838323,
    0.0347305389,
    0.0155688623,
    0.0107784431,
    0.0017964072,
    2.2664670659,
    0.0497005988,
    0.0203592814,
    0.0047904192,
    0.1221556886,
    0.0065868263,
    0.0838323353,
    0.2485029940,
    0.2221556886,
    0.3455089820,
    0.0005988024,
    0.4287425150,
    0.0994011976,
    0.0353293413,
    0.0005988024,
    0.0293413174,
    0.0293413174,
    0.0622754491,
    0.3808383234,
    0.1053892216,
    0.0000000000,
    0.0000000000,
    0.0838323353,
    0.0419161677,
    0.0000000000,
    0.3724550898,
    0.1227544910,
    0.0125748503,
    0.3161676647,
    0.0634730539,
    0.0305389222,
    0.0023952096,
    0.0041916168,
    0.7640718563,
    0.7640718563,
    0.2670658683,
    2.6419161677,
    13.8000000000,
    2.0808383234,
    0.0011976048,
    0.0089820359,
    0.0005988024,
    0.0000000000,
    0.0005988024,
    0.0000000000,
    0.0047904192,
    0.0005988024,
    0.0167664671,
    0.0083832335,
    0.0287425150,
    0.0652694611,
    0.0107784431,
    0.0035928144,
    0.0005988024,
    0.0425149701,
    0.0335329341,
    0.0005988024,
    0.5796407186,
    0.1317365269,
    0.2257485030,
    0.1814371257,
    0.2808383234,
    0.1167664671,
    0.1167664671,
    0.0017964072,
    0.0059880240,
    0.0000000000,
    0.0000000000,
    0.0053892216,
    0.0000000000,
    0.0011976048,
    0.0233532934,
    0.0005988024,
    0.0005988024,
    0.0000000000,
    0.0011976048,
    0.0053892216,
    0.0119760479,
    0.0005988024,
    0.0000000000,
    0.0005988024,
    0.0005988024,
    0.0005988024,
    0.0005988024,
    0.0000000000,
    0.0083832335,
    0.0005988024,
    0.0005988024,
    0.3862275449,
    0.5694610778,
    0.5694610778,
    0.2808383234,
    0.1125748503,
    2.7520958084,
    1.6604790419,
    0.3706586826,
    2.6820359281,
    0.3958083832,
    0.7137724551,
    0.2269461078,
    0.4137724551,
    0.2113772455,
    0.2263473054,
    0.1233532934,
    0.4035928144,
    0.2011976048,
    0.0856287425,
    0.2449101796,
    0.3826347305,
    0.0916167665,
    0.6437125749,
    0.7095808383,
    0.2179640719,
    0.7568862275,
    0.1053892216,
    0.4137724551,
    0.2011976048,
    0.0916167665,
    0.2179640719,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0005988024,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0005988024,
    0.0000000000,
    0.0002994012,
    0.0005988024,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0017964072,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0047904192,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    8.5478527474,
    8.5478527474,
    0.4470051268,
    -0.3142029900,
    0.5665133742,
    14.8122915840,
    207.1492694611,
    194.6223041916,
    206.6908079780,
    73.4131736527,
    0.0000000000,
    0.1842353237,
    -0.3255048764,
    0.3313193667,
    0.1843364991,
    1.1468543995,
    1.6934921796,
    2.1164342441,
    25.4717703413,
    10.1897667350,
    2.0824077158,
    -2.0577482448,
    2.1691823994,
    -2.0469977275,
    6.2142808612,
    0.4292499783,
    2.0979733521,
    2.6668008218,
    338.0319002447,
    10.0701686909,
    7.8519467800,
    8.5519070437,
    6.4318483133,
    4.4336424344,
    4.9427371305,
    3.3012068819,
    3.9041266179,
    2.2333047509,
    2.7048260210,
    1.5085685724,
    1.8265905871,
    -0.9760059880,
    555.6482431156,
    10.1312098011,
    4.3892526725,
    4.2287654630,
    84.6115656299,
    6.1650062460,
    3.6804632560,
    1.7092316727,
    1.4514957597,
    1.0136930697,
    2.2190306500,
    3.4641558640,
    2.3215779166,
    0.8665945097,
    1.4543270978,
    24.0389033016,
    21.1530846030,
    8.3706238279,
    6.1354199048,
    7.9956524480,
    16.6068125828,
    0.1073931072,
    2.6494832534,
    2.9817520400,
    19.1957958084,
    5.8808023253,
    26.2556350417,
    0.0000000000,
    2.3702810727,
    3.0905838506,
    2.4606074585,
    1.3933797048,
    8.9419757064,
    15.5637617472,
    4.7003762927,
    4.5659622970,
    18.0464432099,
    20.9778805594,
    1.8726585831,
    2.4299782701,
    0.0000000000,
    38.4664191617,
    6.1940319829,
    5.4667461655,
    0.0289189015,
    6.4944468980,
    7.5052441017,
    8.2858700543,
    10.0705674017,
    7.9001143654,
    10.0573553012,
    11.6808808280,
    10.3594316793,
    4.3856021555,
    3.7375930153,
    8.9050825512,
    6.0696076432,
    1.1390659480,
    0.0334653650,
    5.0978759471,
    1.7231013815,
    2.3641641317,
    0.2155416622,
    0.4268177434,
    13.5592814371,
    0.9604790419,
    2.5886227545,
    0.2862275449,
    0.1916167665,
    0.4778443114,
    0.3173652695,
    0.7568862275,
    0.1934131737,
    0.9502994012,
    0.6832335329,
    0.0532934132,
    2.2149700599,
    0.8419161677,
    3.4832335329,
    0.3850299401,
    2.2550898204,
    0.1886227545,
    0.1275449102,
    0.3161676647,
    0.0095808383,
    0.6832335329,
    3.4866952802,
    1.4281437126,
    2.3375016886,
    54.6471529940,
    0.0622754491,
    0.2562874251,
    0.2101796407,
    0.0640718563,
    0.0233532934,
    0.2964071856,
    0.0401197605,
    0.1011976048,
    0.0856287425,
    0.0856287425,
    0.5796407186,
    0.4940119760,
    0.0095808383,
    0.0029940120,
    0.0143712575,
    0.5101796407,
    0.2682634731,
    0.1233532934,
    0.0059880240,
    0.0257485030,
    0.0095808383,
    0.0401197605,
    0.0047904192,
    0.0131736527,
    0.0005988024,
    0.2269461078,
    0.1940119760,
    0.3173652695,
    0.0017964072,
    0.2359281437,
    0.1766467066,
    0.0000000000,
    0.0005988024,
    0.0215568862,
    0.7568862275,
    0.0035928144,
    0.5664670659,
    0.0000000000,
    0.0005988024,
    0.0035928144,
    0.1065868263,
    0.3035928144,
    0.0059880240,
    0.0035928144,
    0.7137724551,
    0.0089820359,
    0.0005988024,
    0.0119760479,
    0.0664670659,
    0.0000000000,
    0.0005988024,
    0.1107784431,
    0.0742514970,
    0.0000000000,
    0.0083832335,
    0.0790419162,
    0.0017964072,
    0.0185628743,
    0.0502994012,
    0.0425149701,
    0.0215568862,
    0.0023952096,
    0.0023952096,
    0.0029940120,
    0.1431137725,
    0.0916167665,
    0.0886227545,
    0.0041916168,
    0.0041916168,
    0.0287425150,
    0.0071856287,
    0.0245508982,
    0.0000000000,
    0.0508982036,
    0.0005988024,
    0.0245508982,
    0.0359281437,
    0.0041916168,
    0.0095808383,
    0.0000000000,
    0.0059880240,
    0.0000000000,
    0.0041916168,
    0.3592814371,
    0.0598802395,
    207.1492694611,
    54.6471529940,
    13.9686901316,
    5.2167911053,
    0.2694235353,
    3.7162532722,
    935.4706986622,
    0.9128543178,
    241.8736378060,
    14.9743360024,
    187.8951730327,
    0.0057026036,
    1.5443132487,
    0.3098370060,
    2.4184348220,
    0.5443132487,
    62.7120096299,
    21.8588611976,
    4.5521844669,
    0.1084572616,
    746.7638485049,
    1.5237013114,
    2.7873986282,
    1.2050473291,
    1.5237013114,
    2.7873986282,
    -7.6185065572,
    69.6849657042,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000
};

inline const double SCALE[] = {
    0.4173446502,
    0.1006789672,
    1.0000000000,
    1.0000000000,
    0.1443213155,
    1.0000000000,
    1.0000000000,
    0.0345856984,
    1.0000000000,
    0.0244631116,
    1.0000000000,
    1.0000000000,
    0.2192172960,
    0.1032582601,
    0.1651175211,
    0.9194393854,
    0.3821602673,
    0.6681145607,
    0.2193579174,
    0.1971588145,
    0.1771038437,
    0.1454042155,
    0.1374065582,
    1.0000000000,
    0.0974117337,
    1.0000000000,
    0.3561016977,
    0.2451406614,
    0.1933390043,
    0.0772988722,
    0.0244631116,
    0.0244631116,
    0.1561818534,
    0.0488822315,
    0.2085311609,
    0.9776747032,
    0.2269105560,
    0.1518279975,
    0.2697563253,
    0.1032582601,
    0.0423459574,
    0.3069678583,
    0.0732132355,
    0.0844629829,
    0.1651175211,
    0.1558509057,
    0.0244631116,
    0.1441124676,
    0.1262678185,
    0.2148190553,
    0.1329772817,
    0.1238001325,
    0.0732915541,
    0.0423459574,
    0.0345856984,
    0.0488822315,
    1.0000000000,
    0.0489262233,
    0.0423459574,
    1.0000000000,
    0.3631113235,
    0.0345856984,
    0.1896880855,
    0.2430141975,
    0.3102588159,
    0.1659547106,
    1.3300894750,
    2.6728867481,
    0.4185264648,
    0.3292002964,
    0.3014546349,
    0.2096355788,
    0.2298839752,
    0.1191541538,
    0.1443213155,
    0.6796734277,
    0.1140180142,
    0.0880646775,
    1.5966748948,
    0.1118671218,
    0.2618923733,
    0.0881786087,
    0.9935544723,
    0.7013377034,
    0.3698912470,
    0.1642291304,
    0.9574503894,
    0.2571931224,
    0.1190156479,
    0.7538446523,
    0.1971588145,
    0.0546355916,
    0.0345856984,
    0.4647266001,
    0.1757145812,
    0.4093006010,
    0.2386781579,
    1.4057642203,
    0.3080435313,
    0.1945730042,
    0.2342419760,
    0.3781478610,
    0.1061773065,
    0.0646068659,
    1.0000000000,
    0.0423459574,
    0.4564072485,
    0.7127519530,
    0.1999578643,
    0.2471538298,
    0.1790899741,
    3.1427917671,
    0.3369661719,
    0.0244631116,
    0.2509260699,
    0.7937204241,
    0.1948308291,
    0.9776747032,
    0.2269105560,
    0.1459948518,
    0.1032582601,
    0.0423459574,
    2.0188367665,
    0.4173446502,
    0.1494656839,
    0.0690468757,
    0.5009453575,
    0.0945444321,
    0.5226965281,
    0.7652134677,
    0.7400357005,
    0.9632906792,
    0.0244631116,
    1.1905366272,
    0.5211108593,
    0.2333247959,
    0.0244631116,
    0.2155098056,
    0.1757145812,
    0.2697563253,
    0.7814414848,
    0.3786609697,
    1.0000000000,
    1.0000000000,
    0.4296381105,
    0.2148190553,
    1.0000000000,
    0.9795309076,
    0.3677373195,
    0.1114303524,
    0.8302165770,
    0.2649956008,
    0.1854635154,
    0.0598922144,
    0.0810509512,
    1.9169968266,
    1.9169968266,
    0.8133940950,
    11.2471916886,
    84.2415944029,
    13.0327107310,
    0.0345856984,
    0.0943470135,
    0.0244631116,
    1.0000000000,
    0.0244631116,
    1.0000000000,
    0.0690468757,
    0.0244631116,
    0.1756604968,
    0.1034802614,
    0.2141972331,
    0.2723655838,
    0.1089030443,
    0.0598323162,
    0.0244631116,
    0.2566264756,
    0.2049129444,
    0.0244631116,
    0.8344770618,
    0.4814013750,
    0.4782032329,
    0.5086229801,
    1.0205337415,
    0.5249639502,
    0.5249639502,
    0.0733893349,
    0.1246314802,
    1.0000000000,
    1.0000000000,
    0.1007501713,
    1.0000000000,
    0.0345856984,
    0.1661274699,
    0.0244631116,
    0.0244631116,
    1.0000000000,
    0.0489262233,
    0.0809801373,
    0.1192804752,
    0.0244631116,
    1.0000000000,
    0.0244631116,
    0.0244631116,
    0.0244631116,
    0.0244631116,
    1.0000000000,
    0.1034802614,
    0.0244631116,
    0.0244631116,
    1.6098282040,
    1.8763326625,
    1.8763326625,
    1.0205337415,
    0.6560797783,
    5.9715577194,
    7.1218013775,
    1.1831051895,
    8.0263846746,
    1.5506171572,
    1.5063107236,
    0.8696435450,
    1.1794353753,
    0.5407822192,
    0.5385947109,
    0.3747967286,
    1.0059637864,
    0.5216266616,
    0.3102588159,
    0.8358837471,
    1.4457239049,
    0.3637649392,
    1.5909566628,
    2.3727679971,
    0.6164710647,
    0.8955297527,
    0.3786609697,
    1.1794353753,
    0.5216266616,
    0.3637649392,
    0.6164710647,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    0.0244631116,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    0.0244631116,
    1.0000000000,
    0.0122315558,
    0.0172928492,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    0.0546880691,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    0.0668436223,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    3.5227949566,
    3.5227949566,
    0.4532227908,
    1.3186037791,
    0.1510129307,
    10.8834035971,
    102.2354829942,
    98.6496377546,
    101.9238691229,
    35.9809073637,
    1.0000000000,
    0.1381415685,
    0.1493638219,
    0.1484229548,
    0.1245266325,
    0.3503834376,
    0.4250376680,
    0.5210500476,
    18.6505190903,
    0.3603761435,
    0.2873238178,
    0.2337376145,
    0.2693957490,
    0.3184304121,
    1.4885163330,
    0.6696393690,
    0.4899997704,
    0.5705313605,
    264.5415958345,
    4.8120617577,
    3.8816760278,
    4.0247856211,
    3.2637181550,
    2.4411360232,
    2.5907094624,
    2.2074650036,
    2.4875740816,
    1.9441608988,
    2.2274254481,
    1.6324448004,
    1.8688843534,
    0.9730358259,
    437.2444304883,
    4.8733649068,
    2.4115610770,
    34.6351156365,
    40.2934564671,
    7.5727220498,
    6.5823708943,
    4.1627739779,
    3.5215645247,
    2.8437973225,
    3.6236567843,
    5.4763174102,
    4.4351104728,
    3.0885707422,
    5.8180671388,
    21.3056885456,
    18.5348900824,
    8.9896806958,
    8.0001684014,
    9.0450549516,
    17.5817315161,
    0.7882304392,
    4.7958085237,
    7.2119141755,
    22.3042679258,
    8.7804777220,
    22.8660099607,
    1.0000000000,
    4.7459290789,
    4.6143230259,
    4.8625368095,
    3.6515824673,
    17.4980296101,
    16.6651497852,
    6.4521236225,
    8.3744817496,
    20.0300399496,
    19.5215065810,
    5.7167658099,
    6.5135444757,
    1.0000000000,
    36.3179527387,
    12.3298997116,
    7.2312738031,
    0.3862827995,
    8.9582931974,
    9.0318862954,
    10.5724171167,
    13.7393929785,
    11.2023609515,
    14.4884291623,
    15.5308007631,
    16.6961093778,
    9.5930275524,
    8.4358691381,
    10.3062992149,
    9.9315382337,
    2.4088123653,
    1.1762336819,
    6.1703006436,
    3.6213412094,
    2.7830137528,
    1.3988362856,
    0.3685644402,
    6.8383224095,
    1.3583610274,
    2.3652149619,
    0.8914709749,
    0.5409476242,
    1.0718723446,
    0.8304808531,
    0.8955297527,
    0.4723032778,
    0.9729499714,
    1.9755133554,
    0.3697036248,
    2.1069923151,
    1.1736288645,
    2.6467730368,
    0.7098223395,
    2.5436702862,
    0.6910825632,
    0.4279409930,
    0.8438092532,
    0.0974117337,
    1.9755133554,
    2.2704548632,
    1.3197888702,
    1.8677462169,
    25.3045131931,
    0.2719670565,
    0.8666505771,
    0.7933960003,
    0.2726497955,
    0.1587549265,
    0.8248674156,
    0.2499245108,
    0.3821602673,
    0.3102588159,
    0.3102588159,
    0.8344770618,
    0.8172687535,
    0.1090149322,
    0.0546355916,
    0.1540959531,
    0.9718575787,
    0.5882166105,
    0.3747967286,
    0.1036464504,
    0.1583840825,
    0.0974117337,
    0.2499245108,
    0.0690468757,
    0.1140180142,
    0.0244631116,
    0.8696435450,
    0.7097018518,
    0.8304808531,
    0.0423459574,
    0.5857817906,
    0.5196090317,
    1.0000000000,
    0.0244631116,
    0.1492976613,
    0.8955297527,
    0.0598323162,
    1.3624832374,
    1.0000000000,
    0.0244631116,
    0.0598323162,
    0.3503869075,
    0.7378064442,
    0.0771502918,
    0.0598323162,
    1.5063107236,
    0.0943470135,
    0.0244631116,
    0.1087778570,
    0.3369661719,
    1.0000000000,
    0.0244631116,
    0.4127503690,
    0.3044508302,
    1.0000000000,
    0.0975220986,
    0.3315419131,
    0.0423459574,
    0.1435740350,
    0.2700353163,
    0.2566264756,
    0.1645606600,
    0.0488822315,
    0.0488822315,
    0.0546355916,
    0.4286141212,
    0.3637649392,
    0.3603755795,
    0.0646068659,
    0.0646068659,
    0.2355022144,
    0.0844629829,
    0.1659547106,
    1.0000000000,
    0.2574328035,
    0.0244631116,
    0.1547519034,
    0.1985641744,
    0.0646068659,
    0.0974117337,
    1.0000000000,
    0.0771502918,
    1.0000000000,
    0.0646068659,
    1.5395837251,
    0.2471538298,
    102.2354829942,
    25.3045131931,
    3.4677031979,
    0.5050546167,
    0.0431704860,
    0.7161401778,
    171.0383145167,
    0.2545118635,
    137.0169093338,
    4.2076037994,
    104.7803491834,
    0.0037058289,
    0.1831158425,
    0.0862934156,
    0.5842708490,
    0.1831158425,
    33.9026435015,
    10.1218052772,
    1.0660571169,
    0.0175255801,
    296.5440748890,
    0.6824462921,
    2.6974996611,
    0.2675112075,
    0.6824462921,
    2.6974996611,
    3.4122314607,
    67.4374915275,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000
};

// Ridge coefficients
inline const double COEF[] = {
    -0.0358123410,
    0.0157102880,
    0.0000000000,
    0.0000000000,
    -0.3025184101,
    0.0000000000,
    0.0000000000,
    -0.0050151279,
    0.0000000000,
    0.0999735704,
    0.0000000000,
    0.0000000000,
    -0.0776135694,
    0.0079104030,
    0.0008664422,
    -1.7892850933,
    -1.0612447188,
    0.0012842854,
    0.4995844848,
    -0.2898876974,
    0.0764589494,
    0.0513767772,
    -0.0084293932,
    0.0000000000,
    -0.5058698735,
    0.0000000000,
    0.0175823150,
    0.4658985606,
    -0.1370077438,
    0.0286629370,
    -0.0027084637,
    -0.0043831129,
    -0.0382276483,
    -0.2301465032,
    0.3035394847,
    0.0256580962,
    -0.0044534720,
    -0.0190966185,
    -0.3543772433,
    0.0079103996,
    -0.0085800259,
    0.0299468542,
    -0.0363327000,
    0.0167780116,
    0.0008664436,
    -0.0042954180,
    0.0068965336,
    -0.0607325785,
    -0.0077431064,
    0.2908335509,
    -0.0266785794,
    0.0752636522,
    0.0101272594,
    0.0099204814,
    0.0078819525,
    0.0104621241,
    0.0000000000,
    -0.0182329485,
    0.0061354850,
    0.0000000000,
    0.4473270978,
    0.0048437862,
    0.4067676014,
    0.7401161329,
    -0.3645409439,
    0.0264012374,
    6.9109464527,
    -77.4859224670,
    0.5373760322,
    0.4879321561,
    1.2810306314,
    0.6332450169,
    1.0888319175,
    -3.5768363725,
    -5.2414277269,
    9.6124874728,
    -0.7084291287,
    -0.4740966904,
    -56.1864152807,
    2.2744013079,
    4.0520618162,
    1.1034277170,
    -6.5069032143,
    -29.1756336700,
    -15.4295410722,
    -5.7704778312,
    1.8281737948,
    -10.6605474721,
    -3.7021826217,
    -24.1587019278,
    -9.9941186895,
    -2.8801026035,
    -0.3584405836,
    -12.8215646815,
    -3.7526866064,
    14.2952917094,
    8.6237759624,
    -24.7122310910,
    -38.6681550236,
    -53.2199813866,
    -0.7107805955,
    0.2990805827,
    0.1525587904,
    -0.0483603408,
    0.0000000000,
    0.0902223410,
    -0.1387127992,
    -0.2892611753,
    -2.0590979561,
    -0.0606733530,
    -0.3441261114,
    -76.6201576880,
    -0.0685531792,
    0.0295432966,
    0.3516421609,
    -0.0805807300,
    -0.0193677218,
    0.0256580995,
    -0.0044534650,
    -0.0173709589,
    0.0079103990,
    -0.0085800265,
    -51.9565421646,
    -0.0358123431,
    0.5105006213,
    -0.0344875503,
    0.3823073768,
    0.0095419932,
    -0.0415179574,
    0.1839722488,
    0.0787600664,
    0.1232920896,
    0.0408941657,
    -30.8740529378,
    0.5544749465,
    0.0097920245,
    0.1204360259,
    -0.0174412497,
    -1.2099078232,
    -0.3543772430,
    -0.0793354518,
    -0.0781889333,
    0.0000000000,
    0.0000000000,
    -2.2135021340,
    -2.2135021340,
    0.0000000000,
    0.0032163140,
    0.2056401911,
    0.0346120746,
    -8.6056484798,
    0.0557266826,
    0.0756499107,
    0.0101494345,
    0.0555445003,
    -0.0134819966,
    -0.0134819965,
    0.0243519743,
    0.0938684353,
    -0.0036922000,
    0.4847147810,
    -1.1795607249,
    -0.5740467058,
    -0.0474984768,
    0.0000000000,
    0.1995628828,
    0.0000000000,
    0.0577411594,
    -0.0223587900,
    -0.0615122356,
    0.0315806584,
    -0.4411650447,
    -0.3723655143,
    -0.3859149290,
    0.0285303634,
    -0.0223691606,
    -0.3427484082,
    -0.5197610206,
    -0.7342316318,
    -1.5178898570,
    -0.0065765284,
    0.0338622263,
    -0.8854670360,
    -0.0061942734,
    -0.0127885872,
    -0.0127885871,
    0.0013575462,
    0.0147457437,
    0.0000000000,
    0.0000000000,
    0.0104810087,
    0.0000000000,
    -0.0145770088,
    0.0083807018,
    0.0017490368,
    0.0017490373,
    0.0000000000,
    -0.0205712190,
    0.0309483640,
    0.0027574431,
    -0.0104035471,
    0.0000000000,
    -0.0436558474,
    0.0032911262,
    -0.0039045998,
    -0.0104035473,
    0.0000000000,
    0.0315806586,
    -0.0223691606,
    -0.0104035473,
    -0.0766534152,
    0.1746912431,
    0.1746912430,
    -0.0061942719,
    -0.0371379665,
    -0.6805473782,
    -0.3373287733,
    -0.0478705476,
    -0.0124540683,
    0.2442635766,
    -32.5940973432,
    -0.4013509724,
    0.0833765004,
    -4.4452525869,
    -5.4315158541,
    2.6707137702,
    -1.4465246631,
    0.3112898057,
    -0.3645409370,
    -1.7806031281,
    -0.3699401076,
    -0.0260758198,
    -1.9976155338,
    0.2819033693,
    -0.0339232671,
    -0.3745832920,
    -0.0781889321,
    0.0833765007,
    0.3112898058,
    -0.0260758197,
    -0.0339232672,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0003459928,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0177155640,
    0.0000000000,
    0.0080966174,
    -0.0232970924,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0160038817,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0315775921,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    -0.0398315167,
    -0.0398315167,
    -0.0865917356,
    -0.0715300112,
    0.0996461153,
    -0.3427382378,
    78.8815134921,
    9.9197344461,
    79.3513201540,
    226.0445780295,
    0.0000000000,
    -0.1502920091,
    0.2016165575,
    0.1950824393,
    0.2517508364,
    -0.1801661718,
    0.2394131004,
    -0.0607530323,
    -0.0916297719,
    -0.1568734717,
    0.4860044034,
    -0.3608799945,
    -0.2703230609,
    0.1736152531,
    -0.1151903697,
    -0.0476680046,
    -0.0308027623,
    -0.0070652452,
    -0.4982399925,
    -230.7623172066,
    -220.5421846418,
    -230.8284800886,
    -37.0390166792,
    -11.8846391829,
    -0.3392635094,
    -6.3755598458,
    -1.0252318040,
    -0.1888895651,
    0.2647267374,
    0.8287452057,
    -0.1584129396,
    1.4982630204,
    -0.1595912240,
    7.2677726141,
    6.0152254175,
    -0.0024406916,
    86.0237777465,
    22.7131306859,
    19.3286519126,
    12.2776231146,
    10.4244926048,
    8.4746935001,
    10.8646630465,
    16.2659864869,
    13.2104021429,
    9.1410695427,
    17.0189034137,
    61.9283764842,
    53.8839175713,
    26.1308106492,
    23.3399838314,
    88.1969510516,
    21.5203293351,
    9.2280719406,
    17.9182982209,
    17.6619111343,
    52.6051088073,
    19.9712685057,
    30.0521948055,
    0.0000000000,
    6.8865103800,
    8.8524734421,
    11.9763049759,
    8.1944890936,
    14.2437511224,
    33.5778184425,
    15.5020464465,
    21.0540796354,
    50.5192726764,
    54.9302933506,
    13.9618401820,
    13.3603246213,
    0.0000000000,
    0.3126803041,
    28.3825927340,
    16.2818058595,
    0.9647678822,
    20.4212692574,
    20.5897188942,
    24.0806914345,
    31.1844723267,
    25.4480899599,
    32.9199814949,
    35.3368438352,
    37.9946689444,
    -77.2973622184,
    -66.3807915061,
    -82.0671446562,
    -79.7132638607,
    -18.9221189984,
    -9.2762472186,
    -48.2427206173,
    -28.2088368466,
    -21.6976063625,
    -10.7183303666,
    0.7932644269,
    48.8825032554,
    -4.2373913458,
    -18.2284425928,
    -0.5420590729,
    -0.0375621163,
    -0.4697847489,
    4.6357876878,
    -0.3745832920,
    -0.2863254247,
    -0.4837688634,
    0.0230373365,
    0.0062261518,
    1.0245403711,
    -5.9044897316,
    -37.3394118459,
    -0.2191416524,
    -0.1276098697,
    0.0406814949,
    0.0087268262,
    0.0377438183,
    -0.0152574477,
    0.0230373365,
    -4.3788680839,
    -0.7381732535,
    -9.5896745983,
    56.7212056755,
    -0.3029309698,
    -1.7677678645,
    0.0481527971,
    0.1063810968,
    -0.1934733150,
    -8.4609292316,
    0.6746383624,
    -1.0612447247,
    -0.3645409370,
    -0.3645409370,
    -1.5178898569,
    -1.4114603945,
    1.8356089197,
    0.0022477907,
    4.5030991328,
    -12.6658130520,
    -2.1979891961,
    2.6707137704,
    -0.0228127810,
    0.0095432880,
    -0.0081898895,
    0.6746383624,
    -2.5026160662,
    0.1722619858,
    -0.0074490239,
    -0.4013509727,
    -0.0964787346,
    4.6357876878,
    0.1301049895,
    -1.2109518415,
    -0.0155272306,
    0.0000000000,
    0.9417967789,
    -0.0779427033,
    -0.3745832920,
    0.3158112844,
    0.1023016925,
    0.0000000000,
    0.0124685229,
    -0.0209210780,
    -0.4382472774,
    0.1490837927,
    -0.1040932633,
    0.1280161917,
    -32.5940973432,
    0.1187483077,
    0.7675510017,
    -0.0935250274,
    -0.0685531790,
    0.0000000000,
    -0.3048053705,
    0.3680667551,
    -0.0481952380,
    0.0000000000,
    -0.0599830017,
    0.0782305744,
    0.0020714462,
    -0.8533915085,
    4.5117657294,
    -0.0311191245,
    0.0083497783,
    3.3416767980,
    -0.0989814234,
    1.6264167951,
    -0.0116332968,
    -0.0260758197,
    -0.0775903183,
    -0.0483603413,
    -0.0483603413,
    0.0044510005,
    0.0488554811,
    0.0264012368,
    0.0000000000,
    0.0527187377,
    -0.4777000655,
    -0.2297200123,
    0.1127449717,
    -0.7951588428,
    -0.5058698732,
    0.0000000000,
    -0.0067958433,
    0.0000000000,
    0.0245519742,
    -0.1377839230,
    -0.0606733532,
    78.8815134921,
    56.7212056755,
    -29.2884318348,
    15.2006102748,
    -75.9285262389,
    0.0742736135,
    0.1000925249,
    -0.4116769839,
    0.1375652770,
    -0.1984894417,
    0.3426915260,
    0.5249612520,
    2.0145786368,
    -2.0146534596,
    -2.0735681036,
    2.0145786344,
    0.0288504614,
    56.7212057538,
    23.8694746423,
    75.2680330392,
    0.3364173400,
    -9.5442981009,
    -1.4873112466,
    -29.0522953795,
    -9.5442981009,
    -1.4873112466,
    9.5442980885,
    -1.4873115012,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000
};

constexpr double INTERCEPT = 144.9538982036;

inline double predict(const double* features) {
    double pred = INTERCEPT;
    for (int i = 0; i < N_FEATURES; ++i) {
        // Clip features to prevent overflow
        double feat_val = features[i];
        if (!std::isfinite(feat_val)) {
            feat_val = 0.0;
        }
        feat_val = std::max(-1e6, std::min(1e6, feat_val));  // Clip to reasonable range
        
        // Safe scaling with check for very small SCALE
        double scale_val = SCALE[i];
        if (std::abs(scale_val) < 1e-10) {
            scale_val = 1.0;  // Avoid division by zero
        }
        double scaled = (feat_val - MEAN[i]) / scale_val;
        
        // Clip scaled value to prevent overflow
        scaled = std::max(-100.0, std::min(100.0, scaled));
        
        pred += COEF[i] * scaled;
    }
    
    // Clip final prediction to reasonable range
    if (!std::isfinite(pred)) {
        pred = 0.0;
    }
    pred = std::max(-1000.0, std::min(1000.0, pred));
    
    return pred;
}

} // namespace CascadePolarizability
} // namespace Osmordred
