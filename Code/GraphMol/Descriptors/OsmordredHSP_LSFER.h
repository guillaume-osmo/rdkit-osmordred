// Auto-generated: LSFER Equations for Hansen Solubility Parameters
// dD (dispersion), dP (polar), dH (hydrogen bonding)
// Uses Abraham parameters + V/L residuals + golden features

#pragma once
#include <vector>
#include <cmath>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {

// dD LSFER Equation - R² = 0.9062
const std::vector<double> DD_MEAN = {0.1523160772, 0.5455163753, 0.8486741299, 0.6238908932, 5.7928157429, 1.4570625774, 0.0042727474, -0.0071749447, 0.1450781752, 0.2004699908, 0.1549245484, 1.0968824496, 0.2334828210, 0.6406006961, 0.4751623797, 4.0196860886, 0.9359246822, 0.8428354542, 6.1264224718, 1.3728276453, 5.0599981215, 1.0621342010, 10.5750044354, 0.0999746433, 0.4873005636, 1.0599565926, 0.8427994506, 44.1512611133, 2.6401632659, 0.6513670850, 0.4407877512, 3.8919990804, 0.2465915949, 0.5141689788, 0.8721603059, 0.1153692390, 0.6544094335, -0.3932002980, 0.2247832367, 0.2984507598};
const std::vector<double> DD_SCALE = {0.2770820382, 0.4355599246, 0.5828454459, 0.6734683392, 3.2549265556, 0.7191188438, 0.0690593324, 0.2417460794, 0.4874725335, 0.5554708419, 0.5219094867, 3.2185344295, 0.6300230640, 1.2935795379, 1.1784710714, 8.3514451314, 1.7240286147, 1.4912779171, 9.2376716850, 1.8507130589, 9.4489225164, 1.8429637602, 16.1657233877, 0.3237885607, 1.3012575111, 1.6383922975, 1.7483370835, 70.5275494683, 3.9643449548, 0.7518649748, 0.5072080834, 0.9699301510, 2.2053503204, 0.4519534916, 1.7442512363, 0.2601908337, 3.3181831891, 0.3775081218, 0.4081147281, 2.0752069163};
const std::vector<double> DD_COEF = {0.3307920803, 0.1187657386, 0.6334806533, 0.5658689439, 0.1028819041, -0.2015660595, -0.0324610244, -0.0472333285, -0.5877688119, 0.1067714623, 0.1331372041, -0.2026976515, -0.1326881933, 0.0483952927, -0.9643779160, 2.9726354078, -2.1474333541, 1.5083787225, -3.6936579463, 2.3045965705, 3.8237390631, -2.4648666657, 0.7883714043, -0.0450297371, 0.0966147368, -0.3479117365, -1.2690001054, -1.5287346544, 0.5306635517, -0.1495536302, 0.4464098718, 0.7689339583, -0.0007287291, -0.2928366069, -0.0676284132, 0.0448269242, -0.0541551001, 0.1057644733, -0.0290935442, 0.4253264092};
const double DD_INTERCEPT = 17.1854148245;

// dP LSFER Equation - R² = 0.7113
const std::vector<double> DP_MEAN = {0.1523160772, 0.5455163753, 0.8486741299, 0.6238908932, 5.7928157429, 1.4570625774, 0.0042727474, -0.0071749447, 0.1450781752, 0.2004699908, 0.1549245484, 1.0968824496, 0.2334828210, 0.6406006961, 0.4751623797, 4.0196860886, 0.9359246822, 0.8428354542, 6.1264224718, 1.3728276453, 5.0599981215, 1.0621342010, 10.5750044354, 0.0999746433, 0.4873005636, 1.0599565926, 0.8427994506, 44.1512611133, 2.6401632659, 0.6513670850, 0.4407877512, 3.8919990804, 0.2465915949, 0.5141689788, 0.8721603059, 0.1153692390, 0.6544094335, -0.3932002980, 0.2247832367, 0.2984507598};
const std::vector<double> DP_SCALE = {0.2770820382, 0.4355599246, 0.5828454459, 0.6734683392, 3.2549265556, 0.7191188438, 0.0690593324, 0.2417460794, 0.4874725335, 0.5554708419, 0.5219094867, 3.2185344295, 0.6300230640, 1.2935795379, 1.1784710714, 8.3514451314, 1.7240286147, 1.4912779171, 9.2376716850, 1.8507130589, 9.4489225164, 1.8429637602, 16.1657233877, 0.3237885607, 1.3012575111, 1.6383922975, 1.7483370835, 70.5275494683, 3.9643449548, 0.7518649748, 0.5072080834, 0.9699301510, 2.2053503204, 0.4519534916, 1.7442512363, 0.2601908337, 3.3181831891, 0.3775081218, 0.4081147281, 2.0752069163};
const std::vector<double> DP_COEF = {-1.3728823736, -0.4588186120, 1.6499902951, 1.2151930605, -0.6748692354, -1.5319352638, -0.2467251289, -0.2334105369, 1.0429615129, 0.7413411719, 0.9510741976, -4.1984877551, 4.1691967514, -1.5177420643, 1.5197904061, -0.4169597760, 1.3779657789, -2.0297501536, 4.5588788127, -5.4410191371, -5.2300626612, 2.0403611567, -17.7399472420, -0.5434256587, -0.3497603045, 0.8197425089, 1.2624847304, 13.4451451094, 7.5911800902, 2.0983154680, -2.2186409124, 1.8533419431, 0.0326747798, 0.8708979617, -0.1661025682, 0.0417158357, -0.1314826609, -0.4782891706, 0.3511151823, -1.2811364283};
const double DP_INTERCEPT = 5.5177972602;

// dH LSFER Equation - R² = 0.8456
const std::vector<double> DH_MEAN = {0.1523160772, 0.5455163753, 0.8486741299, 0.6238908932, 5.7928157429, 1.4570625774, 0.0042727474, -0.0071749447, 0.1450781752, 0.2004699908, 0.1549245484, 1.0968824496, 0.2334828210, 0.6406006961, 0.4751623797, 4.0196860886, 0.9359246822, 0.8428354542, 6.1264224718, 1.3728276453, 5.0599981215, 1.0621342010, 10.5750044354, 0.0999746433, 0.4873005636, 1.0599565926, 0.8427994506, 44.1512611133, 2.6401632659, 0.6513670850, 0.4407877512, 3.8919990804, 0.2465915949, 0.5141689788, 0.8721603059, 0.1153692390, 0.6544094335, -0.3932002980, 0.2247832367, 0.2984507598};
const std::vector<double> DH_SCALE = {0.2770820382, 0.4355599246, 0.5828454459, 0.6734683392, 3.2549265556, 0.7191188438, 0.0690593324, 0.2417460794, 0.4874725335, 0.5554708419, 0.5219094867, 3.2185344295, 0.6300230640, 1.2935795379, 1.1784710714, 8.3514451314, 1.7240286147, 1.4912779171, 9.2376716850, 1.8507130589, 9.4489225164, 1.8429637602, 16.1657233877, 0.3237885607, 1.3012575111, 1.6383922975, 1.7483370835, 70.5275494683, 3.9643449548, 0.7518649748, 0.5072080834, 0.9699301510, 2.2053503204, 0.4519534916, 1.7442512363, 0.2601908337, 3.3181831891, 0.3775081218, 0.4081147281, 2.0752069163};
const std::vector<double> DH_COEF = {2.4184507217, 0.9818079174, 1.1741178181, 0.2657695946, -0.2308723426, -0.7339003866, -0.3435375185, 0.1390224279, 1.4811867033, -1.3083459577, 0.9100007370, -2.4753504571, 0.5071075655, 1.7486236868, -3.1736819016, 7.1746322796, -4.2984114178, 0.3726238659, -2.3794848160, -0.0271940800, 4.5888809802, -0.7970360931, -4.0536207912, -1.0947324229, -1.4461105665, -0.9430516942, -0.5802192265, -1.2042289611, 4.8431126614, -1.4404387726, 2.3184844914, -0.8742085957, -0.0065371231, 2.2893405364, -0.1631294223, 0.1190428162, -0.1099751131, 0.6422989571, 1.2382346945, 0.4021345191};
const double DH_INTERCEPT = 5.9057444065;

// Feature computation helper
inline std::vector<double> computeHSPFeatures(
    double A, double B, double S, double E, double L, double V,
    double V_residual, double L_residual) {
    
    const double eps = 0.01;
    std::vector<double> features;
    
    // Original parameters (6)
    features.push_back(A);
    features.push_back(B);
    features.push_back(S);
    features.push_back(E);
    features.push_back(L);
    features.push_back(V);
    
    // Residuals (2)
    features.push_back(V_residual);
    features.push_back(L_residual);
    
    // Pairwise products (15)
    std::vector<double> params = {A, B, S, E, L, V};
    for (int i = 0; i < 6; ++i) {
        for (int j = i + 1; j < 6; ++j) {
            features.push_back(params[i] * params[j]);
        }
    }
    
    // Squares (6)
    for (int i = 0; i < 6; ++i) {
        features.push_back(params[i] * params[i]);
    }
    
    // Key ratios (10)
    features.push_back(S / (V + eps));    // S/V
    features.push_back(E / (V + eps));    // E/V
    features.push_back(L / (V + eps));    // L/V
    features.push_back(A / (B + eps));    // A/B
    features.push_back((A + B) / (V + eps));  // (A+B)/V
    features.push_back((A + B) / (S + eps));  // (A+B)/S
    features.push_back((A * B) / (S + eps));  // (A×B)/S
    features.push_back(E / (S + eps));    // E/S
    features.push_back(A - B);            // A-B
    features.push_back(S - E);            // S-E
    
    // Triple product (1)
    features.push_back(A * B * V);        // A×B×V
    
    return features;
}

// Predict dD using LSFER equation
inline double predictDD(const std::vector<double>& features) {
    double result = DD_INTERCEPT;
    for (size_t i = 0; i < features.size(); ++i) {
        double scaled = (features[i] - DD_MEAN[i]) / DD_SCALE[i];
        result += DD_COEF[i] * scaled;
    }
    return result;
}

// Predict dP using LSFER equation
inline double predictDP(const std::vector<double>& features) {
    double result = DP_INTERCEPT;
    for (size_t i = 0; i < features.size(); ++i) {
        double scaled = (features[i] - DP_MEAN[i]) / DP_SCALE[i];
        result += DP_COEF[i] * scaled;
    }
    return result;
}

// Predict dH using LSFER equation
inline double predictDH(const std::vector<double>& features) {
    double result = DH_INTERCEPT;
    for (size_t i = 0; i < features.size(); ++i) {
        double scaled = (features[i] - DH_MEAN[i]) / DH_SCALE[i];
        result += DH_COEF[i] * scaled;
    }
    return result;
}

// Convenience function to predict all HSP from Abraham parameters
inline std::vector<double> predictHSP(double A, double B, double S, double E, double L, double V,
                                       double V_residual, double L_residual) {
    auto features = computeHSPFeatures(A, B, S, E, L, V, V_residual, L_residual);
    return {predictDD(features), predictDP(features), predictDH(features)};
}

}  // namespace Osmordred
}  // namespace Descriptors
}  // namespace RDKit
