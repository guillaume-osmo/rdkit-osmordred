#pragma once
// Auto-generated Ridge model for Polarizability V2 (NO CASCADE)
// Features: 548, Alpha: 0.001000
// Trained on 1670 molecules, RÂ² = 1.0000
// Features: 291 SMARTS + 217 RDKit + 10 Physics + 30 Golden (NO Density/RI)

#include <cmath>
#include <algorithm>

namespace Osmordred {
namespace CascadePolarizabilityV2 {

constexpr int N_FEATURES = 548;

// Scaler parameters
inline const double MEAN[] = {
    0.0497005988,
    0.0065868263,
    0.0000000000,
    0.0000000000,
    0.0113772455,
    0.0000000000,
    0.0000000000,
    0.0011976048,
    0.0000000000,
    0.0005988024,
    0.0000000000,
    0.0000000000,
    0.0323353293,
    0.0107784431,
    0.0167664671,
    0.3419161677,
    0.1011976048,
    0.1538922156,
    0.0467065868,
    0.0353293413,
    0.0311377246,
    0.0203592814,
    0.0167664671,
    0.0000000000,
    0.0095808383,
    0.0000000000,
    0.0610778443,
    0.0467065868,
    0.0185628743,
    0.0035928144,
    0.0005988024,
    0.0005988024,
    0.0125748503,
    0.0023952096,
    0.0287425150,
    0.1580838323,
    0.0347305389,
    0.0173652695,
    0.0622754491,
    0.0107784431,
    0.0017964072,
    0.0526946108,
    0.0053892216,
    0.0071856287,
    0.0167664671,
    0.0161676647,
    0.0005988024,
    0.0137724551,
    0.0149700599,
    0.0419161677,
    0.0167664671,
    0.0155688623,
    0.0041916168,
    0.0017964072,
    0.0011976048,
    0.0023952096,
    0.0000000000,
    0.0011976048,
    0.0017964072,
    0.0000000000,
    0.0766467066,
    0.0011976048,
    0.0233532934,
    0.0377245509,
    0.0856287425,
    0.0245508982,
    1.2880239521,
    1.8287425150,
    0.1185628743,
    0.0916167665,
    0.0820359281,
    0.0395209581,
    0.0323353293,
    0.0131736527,
    0.0113772455,
    0.2209580838,
    0.0131736527,
    0.0053892216,
    0.6586826347,
    0.0077844311,
    0.0455089820,
    0.0029940120,
    0.4455089820,
    0.3167664671,
    0.0670658683,
    0.0239520958,
    0.7796407186,
    0.0520958084,
    0.0143712575,
    0.2832335329,
    0.0353293413,
    0.0029940120,
    0.0011976048,
    0.1514970060,
    0.0293413174,
    0.0610778443,
    0.0227544910,
    0.5562874251,
    0.0520958084,
    0.0215568862,
    0.0449101796,
    0.1299401198,
    0.0101796407,
    0.0041916168,
    0.0000000000,
    0.0017964072,
    0.1491017964,
    0.1652694611,
    0.0365269461,
    0.0598802395,
    0.0293413174,
    3.1784431138,
    0.0664670659,
    0.0005988024,
    0.0538922156,
    0.0808383234,
    0.0395209581,
    0.1580838323,
    0.0347305389,
    0.0155688623,
    0.0107784431,
    0.0017964072,
    2.2664670659,
    0.0497005988,
    0.0203592814,
    0.0047904192,
    0.1221556886,
    0.0065868263,
    0.0838323353,
    0.2485029940,
    0.2221556886,
    0.3455089820,
    0.0005988024,
    0.4287425150,
    0.0994011976,
    0.0353293413,
    0.0005988024,
    0.0293413174,
    0.0293413174,
    0.0622754491,
    0.3808383234,
    0.1053892216,
    0.0000000000,
    0.0000000000,
    0.0838323353,
    0.0419161677,
    0.0000000000,
    0.3724550898,
    0.1227544910,
    0.0125748503,
    0.3161676647,
    0.0634730539,
    0.0305389222,
    0.0023952096,
    0.0041916168,
    0.7640718563,
    0.7640718563,
    0.2670658683,
    2.6419161677,
    13.8000000000,
    2.0808383234,
    0.0011976048,
    0.0089820359,
    0.0005988024,
    0.0000000000,
    0.0005988024,
    0.0000000000,
    0.0047904192,
    0.0005988024,
    0.0167664671,
    0.0083832335,
    0.0287425150,
    0.0652694611,
    0.0107784431,
    0.0035928144,
    0.0005988024,
    0.0425149701,
    0.0335329341,
    0.0005988024,
    0.5796407186,
    0.1317365269,
    0.2257485030,
    0.1814371257,
    0.2808383234,
    0.1167664671,
    0.1167664671,
    0.0017964072,
    0.0059880240,
    0.0000000000,
    0.0000000000,
    0.0053892216,
    0.0000000000,
    0.0011976048,
    0.0233532934,
    0.0005988024,
    0.0005988024,
    0.0000000000,
    0.0011976048,
    0.0053892216,
    0.0119760479,
    0.0005988024,
    0.0000000000,
    0.0005988024,
    0.0005988024,
    0.0005988024,
    0.0005988024,
    0.0000000000,
    0.0083832335,
    0.0005988024,
    0.0005988024,
    0.3862275449,
    0.5694610778,
    0.5694610778,
    0.2808383234,
    0.1125748503,
    2.7520958084,
    1.6604790419,
    0.3706586826,
    2.6820359281,
    0.3958083832,
    0.7137724551,
    0.2269461078,
    0.4137724551,
    0.2113772455,
    0.2263473054,
    0.1233532934,
    0.4035928144,
    0.2011976048,
    0.0856287425,
    0.2449101796,
    0.3826347305,
    0.0916167665,
    0.6437125749,
    0.7095808383,
    0.2179640719,
    0.7568862275,
    0.1053892216,
    0.4137724551,
    0.2011976048,
    0.0916167665,
    0.2179640719,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0005988024,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0005988024,
    0.0000000000,
    0.0002994012,
    0.0005988024,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0017964072,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0047904192,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    8.5478527474,
    8.5478527474,
    0.4470051268,
    -0.3142029900,
    0.5665133742,
    14.8122915840,
    207.1492694611,
    194.6223041916,
    206.6908079780,
    73.4131736527,
    0.0000000000,
    0.1842353237,
    -0.3255048764,
    0.3313193667,
    0.1843364991,
    1.1468543995,
    1.6934921796,
    2.1164342441,
    25.4717703413,
    10.1897667350,
    2.0824077158,
    -2.0577482448,
    2.1691823994,
    -2.0469977275,
    6.2142808612,
    0.4292499783,
    2.0979733521,
    2.6668008218,
    338.0319002447,
    10.0701686909,
    7.8519467800,
    8.5519070437,
    6.4318483133,
    4.4336424344,
    4.9427371305,
    3.3012068819,
    3.9041266179,
    2.2333047509,
    2.7048260210,
    1.5085685724,
    1.8265905871,
    -0.9760059880,
    555.6482431156,
    10.1312098011,
    4.3892526725,
    4.2287654630,
    84.6115656299,
    6.1650062460,
    3.6804632560,
    1.7092316727,
    1.4514957597,
    1.0136930697,
    2.2190306500,
    3.4641558640,
    2.3215779166,
    0.8665945097,
    1.4543270978,
    24.0389033016,
    21.1530846030,
    8.3706238279,
    6.1354199048,
    7.9956524480,
    16.6068125828,
    0.1073931072,
    2.6494832534,
    2.9817520400,
    19.1957958084,
    5.8808023253,
    26.2556350417,
    0.0000000000,
    2.3702810727,
    3.0905838506,
    2.4606074585,
    1.3933797048,
    8.9419757064,
    15.5637617472,
    4.7003762927,
    4.5659622970,
    18.0464432099,
    20.9778805594,
    1.8726585831,
    2.4299782701,
    0.0000000000,
    38.4664191617,
    6.1940319829,
    5.4667461655,
    0.0289189015,
    6.4944468980,
    7.5052441017,
    8.2858700543,
    10.0705674017,
    7.9001143654,
    10.0573553012,
    11.6808808280,
    10.3594316793,
    4.3856021555,
    3.7375930153,
    8.9050825512,
    6.0696076432,
    1.1390659480,
    0.0334653650,
    5.0978759471,
    1.7231013815,
    2.3641641317,
    0.2155416622,
    0.4268177434,
    13.5592814371,
    0.9604790419,
    2.5886227545,
    0.2862275449,
    0.1916167665,
    0.4778443114,
    0.3173652695,
    0.7568862275,
    0.1934131737,
    0.9502994012,
    0.6832335329,
    0.0532934132,
    2.2149700599,
    0.8419161677,
    3.4832335329,
    0.3850299401,
    2.2550898204,
    0.1886227545,
    0.1275449102,
    0.3161676647,
    0.0095808383,
    0.6832335329,
    3.4866952802,
    1.4281437126,
    2.3375016886,
    54.6471529940,
    0.0622754491,
    0.2562874251,
    0.2101796407,
    0.0640718563,
    0.0233532934,
    0.2964071856,
    0.0401197605,
    0.1011976048,
    0.0856287425,
    0.0856287425,
    0.5796407186,
    0.4940119760,
    0.0095808383,
    0.0029940120,
    0.0143712575,
    0.5101796407,
    0.2682634731,
    0.1233532934,
    0.0059880240,
    0.0257485030,
    0.0095808383,
    0.0401197605,
    0.0047904192,
    0.0131736527,
    0.0005988024,
    0.2269461078,
    0.1940119760,
    0.3173652695,
    0.0017964072,
    0.2359281437,
    0.1766467066,
    0.0000000000,
    0.0005988024,
    0.0215568862,
    0.7568862275,
    0.0035928144,
    0.5664670659,
    0.0000000000,
    0.0005988024,
    0.0035928144,
    0.1065868263,
    0.3035928144,
    0.0059880240,
    0.0035928144,
    0.7137724551,
    0.0089820359,
    0.0005988024,
    0.0119760479,
    0.0664670659,
    0.0000000000,
    0.0005988024,
    0.1107784431,
    0.0742514970,
    0.0000000000,
    0.0083832335,
    0.0790419162,
    0.0017964072,
    0.0185628743,
    0.0502994012,
    0.0425149701,
    0.0215568862,
    0.0023952096,
    0.0023952096,
    0.0029940120,
    0.1431137725,
    0.0916167665,
    0.0886227545,
    0.0041916168,
    0.0041916168,
    0.0287425150,
    0.0071856287,
    0.0245508982,
    0.0000000000,
    0.0508982036,
    0.0005988024,
    0.0245508982,
    0.0359281437,
    0.0041916168,
    0.0095808383,
    0.0000000000,
    0.0059880240,
    0.0000000000,
    0.0041916168,
    0.3592814371,
    0.0598802395,
    207.1492694611,
    54.6471529940,
    13.9686901316,
    5.2167911053,
    0.2694235353,
    3.7162532722,
    935.4706986622,
    999.1775970713,
    995.3511464016,
    7.1976356224,
    1.5237013114,
    1.1829645580,
    7.2284401185,
    0.7541250211,
    1.3140038894,
    0.2783117899,
    2.7873986282,
    2.0313717931,
    66.1846291728,
    0.9468181291,
    2.2351913940,
    0.2018002182,
    2.1717764382,
    13.4401609241,
    1.4394076775,
    2.3499165226,
    0.4753117690,
    11.0705655899,
    1.1576667064,
    2.0038402512,
    0.4047261684,
    7.1865745928,
    11.7734206077,
    2.4471101339,
    1.3285532988,
    0.3319291081,
    0.4779120223,
    1.2050473291,
    1.0072023846,
    2.5988115126
};

inline const double SCALE[] = {
    0.4173446502,
    0.1006789672,
    1.0000000000,
    1.0000000000,
    0.1443213155,
    1.0000000000,
    1.0000000000,
    0.0345856984,
    1.0000000000,
    0.0244631116,
    1.0000000000,
    1.0000000000,
    0.2192172960,
    0.1032582601,
    0.1651175211,
    0.9194393854,
    0.3821602673,
    0.6681145607,
    0.2193579174,
    0.1971588145,
    0.1771038437,
    0.1454042155,
    0.1374065582,
    1.0000000000,
    0.0974117337,
    1.0000000000,
    0.3561016977,
    0.2451406614,
    0.1933390043,
    0.0772988722,
    0.0244631116,
    0.0244631116,
    0.1561818534,
    0.0488822315,
    0.2085311609,
    0.9776747032,
    0.2269105560,
    0.1518279975,
    0.2697563253,
    0.1032582601,
    0.0423459574,
    0.3069678583,
    0.0732132355,
    0.0844629829,
    0.1651175211,
    0.1558509057,
    0.0244631116,
    0.1441124676,
    0.1262678185,
    0.2148190553,
    0.1329772817,
    0.1238001325,
    0.0732915541,
    0.0423459574,
    0.0345856984,
    0.0488822315,
    1.0000000000,
    0.0489262233,
    0.0423459574,
    1.0000000000,
    0.3631113235,
    0.0345856984,
    0.1896880855,
    0.2430141975,
    0.3102588159,
    0.1659547106,
    1.3300894750,
    2.6728867481,
    0.4185264648,
    0.3292002964,
    0.3014546349,
    0.2096355788,
    0.2298839752,
    0.1191541538,
    0.1443213155,
    0.6796734277,
    0.1140180142,
    0.0880646775,
    1.5966748948,
    0.1118671218,
    0.2618923733,
    0.0881786087,
    0.9935544723,
    0.7013377034,
    0.3698912470,
    0.1642291304,
    0.9574503894,
    0.2571931224,
    0.1190156479,
    0.7538446523,
    0.1971588145,
    0.0546355916,
    0.0345856984,
    0.4647266001,
    0.1757145812,
    0.4093006010,
    0.2386781579,
    1.4057642203,
    0.3080435313,
    0.1945730042,
    0.2342419760,
    0.3781478610,
    0.1061773065,
    0.0646068659,
    1.0000000000,
    0.0423459574,
    0.4564072485,
    0.7127519530,
    0.1999578643,
    0.2471538298,
    0.1790899741,
    3.1427917671,
    0.3369661719,
    0.0244631116,
    0.2509260699,
    0.7937204241,
    0.1948308291,
    0.9776747032,
    0.2269105560,
    0.1459948518,
    0.1032582601,
    0.0423459574,
    2.0188367665,
    0.4173446502,
    0.1494656839,
    0.0690468757,
    0.5009453575,
    0.0945444321,
    0.5226965281,
    0.7652134677,
    0.7400357005,
    0.9632906792,
    0.0244631116,
    1.1905366272,
    0.5211108593,
    0.2333247959,
    0.0244631116,
    0.2155098056,
    0.1757145812,
    0.2697563253,
    0.7814414848,
    0.3786609697,
    1.0000000000,
    1.0000000000,
    0.4296381105,
    0.2148190553,
    1.0000000000,
    0.9795309076,
    0.3677373195,
    0.1114303524,
    0.8302165770,
    0.2649956008,
    0.1854635154,
    0.0598922144,
    0.0810509512,
    1.9169968266,
    1.9169968266,
    0.8133940950,
    11.2471916886,
    84.2415944029,
    13.0327107310,
    0.0345856984,
    0.0943470135,
    0.0244631116,
    1.0000000000,
    0.0244631116,
    1.0000000000,
    0.0690468757,
    0.0244631116,
    0.1756604968,
    0.1034802614,
    0.2141972331,
    0.2723655838,
    0.1089030443,
    0.0598323162,
    0.0244631116,
    0.2566264756,
    0.2049129444,
    0.0244631116,
    0.8344770618,
    0.4814013750,
    0.4782032329,
    0.5086229801,
    1.0205337415,
    0.5249639502,
    0.5249639502,
    0.0733893349,
    0.1246314802,
    1.0000000000,
    1.0000000000,
    0.1007501713,
    1.0000000000,
    0.0345856984,
    0.1661274699,
    0.0244631116,
    0.0244631116,
    1.0000000000,
    0.0489262233,
    0.0809801373,
    0.1192804752,
    0.0244631116,
    1.0000000000,
    0.0244631116,
    0.0244631116,
    0.0244631116,
    0.0244631116,
    1.0000000000,
    0.1034802614,
    0.0244631116,
    0.0244631116,
    1.6098282040,
    1.8763326625,
    1.8763326625,
    1.0205337415,
    0.6560797783,
    5.9715577194,
    7.1218013775,
    1.1831051895,
    8.0263846746,
    1.5506171572,
    1.5063107236,
    0.8696435450,
    1.1794353753,
    0.5407822192,
    0.5385947109,
    0.3747967286,
    1.0059637864,
    0.5216266616,
    0.3102588159,
    0.8358837471,
    1.4457239049,
    0.3637649392,
    1.5909566628,
    2.3727679971,
    0.6164710647,
    0.8955297527,
    0.3786609697,
    1.1794353753,
    0.5216266616,
    0.3637649392,
    0.6164710647,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    0.0244631116,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    0.0244631116,
    1.0000000000,
    0.0122315558,
    0.0172928492,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    0.0546880691,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    0.0668436223,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    1.0000000000,
    3.5227949566,
    3.5227949566,
    0.4532227908,
    1.3186037791,
    0.1510129307,
    10.8834035971,
    102.2354829942,
    98.6496377546,
    101.9238691229,
    35.9809073637,
    1.0000000000,
    0.1381415685,
    0.1493638219,
    0.1484229548,
    0.1245266325,
    0.3503834376,
    0.4250376680,
    0.5210500476,
    18.6505190903,
    0.3603761435,
    0.2873238178,
    0.2337376145,
    0.2693957490,
    0.3184304121,
    1.4885163330,
    0.6696393690,
    0.4899997704,
    0.5705313605,
    264.5415958345,
    4.8120617577,
    3.8816760278,
    4.0247856211,
    3.2637181550,
    2.4411360232,
    2.5907094624,
    2.2074650036,
    2.4875740816,
    1.9441608988,
    2.2274254481,
    1.6324448004,
    1.8688843534,
    0.9730358259,
    437.2444304883,
    4.8733649068,
    2.4115610770,
    34.6351156365,
    40.2934564671,
    7.5727220498,
    6.5823708943,
    4.1627739779,
    3.5215645247,
    2.8437973225,
    3.6236567843,
    5.4763174102,
    4.4351104728,
    3.0885707422,
    5.8180671388,
    21.3056885456,
    18.5348900824,
    8.9896806958,
    8.0001684014,
    9.0450549516,
    17.5817315161,
    0.7882304392,
    4.7958085237,
    7.2119141755,
    22.3042679258,
    8.7804777220,
    22.8660099607,
    1.0000000000,
    4.7459290789,
    4.6143230259,
    4.8625368095,
    3.6515824673,
    17.4980296101,
    16.6651497852,
    6.4521236225,
    8.3744817496,
    20.0300399496,
    19.5215065810,
    5.7167658099,
    6.5135444757,
    1.0000000000,
    36.3179527387,
    12.3298997116,
    7.2312738031,
    0.3862827995,
    8.9582931974,
    9.0318862954,
    10.5724171167,
    13.7393929785,
    11.2023609515,
    14.4884291623,
    15.5308007631,
    16.6961093778,
    9.5930275524,
    8.4358691381,
    10.3062992149,
    9.9315382337,
    2.4088123653,
    1.1762336819,
    6.1703006436,
    3.6213412094,
    2.7830137528,
    1.3988362856,
    0.3685644402,
    6.8383224095,
    1.3583610274,
    2.3652149619,
    0.8914709749,
    0.5409476242,
    1.0718723446,
    0.8304808531,
    0.8955297527,
    0.4723032778,
    0.9729499714,
    1.9755133554,
    0.3697036248,
    2.1069923151,
    1.1736288645,
    2.6467730368,
    0.7098223395,
    2.5436702862,
    0.6910825632,
    0.4279409930,
    0.8438092532,
    0.0974117337,
    1.9755133554,
    2.2704548632,
    1.3197888702,
    1.8677462169,
    25.3045131931,
    0.2719670565,
    0.8666505771,
    0.7933960003,
    0.2726497955,
    0.1587549265,
    0.8248674156,
    0.2499245108,
    0.3821602673,
    0.3102588159,
    0.3102588159,
    0.8344770618,
    0.8172687535,
    0.1090149322,
    0.0546355916,
    0.1540959531,
    0.9718575787,
    0.5882166105,
    0.3747967286,
    0.1036464504,
    0.1583840825,
    0.0974117337,
    0.2499245108,
    0.0690468757,
    0.1140180142,
    0.0244631116,
    0.8696435450,
    0.7097018518,
    0.8304808531,
    0.0423459574,
    0.5857817906,
    0.5196090317,
    1.0000000000,
    0.0244631116,
    0.1492976613,
    0.8955297527,
    0.0598323162,
    1.3624832374,
    1.0000000000,
    0.0244631116,
    0.0598323162,
    0.3503869075,
    0.7378064442,
    0.0771502918,
    0.0598323162,
    1.5063107236,
    0.0943470135,
    0.0244631116,
    0.1087778570,
    0.3369661719,
    1.0000000000,
    0.0244631116,
    0.4127503690,
    0.3044508302,
    1.0000000000,
    0.0975220986,
    0.3315419131,
    0.0423459574,
    0.1435740350,
    0.2700353163,
    0.2566264756,
    0.1645606600,
    0.0488822315,
    0.0488822315,
    0.0546355916,
    0.4286141212,
    0.3637649392,
    0.3603755795,
    0.0646068659,
    0.0646068659,
    0.2355022144,
    0.0844629829,
    0.1659547106,
    1.0000000000,
    0.2574328035,
    0.0244631116,
    0.1547519034,
    0.1985641744,
    0.0646068659,
    0.0974117337,
    1.0000000000,
    0.0771502918,
    1.0000000000,
    0.0646068659,
    1.5395837251,
    0.2471538298,
    102.2354829942,
    25.3045131931,
    3.4677031979,
    0.5050546167,
    0.0431704860,
    0.7161401778,
    171.0383145167,
    20.5986878635,
    49.0973163041,
    1.6855843027,
    0.6824462921,
    0.7949632995,
    3.7328652034,
    0.6149094093,
    0.7131515777,
    0.3526226961,
    2.6974996611,
    2.4596129254,
    70.8603236424,
    1.8847048175,
    2.4905939957,
    0.5104464521,
    2.2402109160,
    13.6502391308,
    2.0508521100,
    2.4149544018,
    0.8459281974,
    12.1030115172,
    1.7311148943,
    2.1224981319,
    0.7783261462,
    10.8173826464,
    12.7216393461,
    4.5921954414,
    1.9706030513,
    0.8366264868,
    0.8438214972,
    0.2675112075,
    0.4109629829,
    0.6889783300
};

// Ridge coefficients
inline const double COEF[] = {
    -0.3394754214,
    -0.0737668965,
    0.0000000000,
    0.0000000000,
    -0.0729319997,
    0.0000000000,
    0.0000000000,
    0.0784154123,
    0.0000000000,
    1.2713009097,
    0.0000000000,
    0.0000000000,
    -1.5984830107,
    -0.1871987362,
    -0.1985176275,
    -1.4171155620,
    -0.5495129922,
    -0.7035037851,
    0.3635963913,
    -1.1309170813,
    -0.3463806586,
    0.9107193039,
    -0.6902394370,
    0.0000000000,
    -0.0821681037,
    0.0000000000,
    0.4519676760,
    0.5951290944,
    -0.2168867740,
    -0.0952160740,
    -0.0178580563,
    -0.0075104582,
    0.0950527076,
    -0.5473249061,
    0.9746193024,
    -0.4927862596,
    0.0220113378,
    -0.1379229117,
    0.3118088009,
    -0.1871987385,
    -0.1407506680,
    -0.3107874272,
    -0.1065369545,
    -0.0899022801,
    -0.1985176262,
    0.3122782404,
    -0.0801471117,
    -0.2059985193,
    -0.0644828931,
    0.6661338807,
    -0.2415636027,
    -0.0397073667,
    -0.1063978909,
    -0.0611455663,
    0.0865714364,
    0.1678661265,
    0.0000000000,
    -0.1575426252,
    -0.0500333936,
    0.0000000000,
    1.0759775488,
    0.0399336065,
    0.4187608642,
    1.1465975097,
    -0.6798818965,
    -0.1525221917,
    9.0306488674,
    -27.7151196092,
    1.2754220134,
    0.4918103177,
    3.0838519836,
    2.1234392387,
    3.6906854298,
    -2.0349356927,
    -3.4075607437,
    11.2750653025,
    0.2091316285,
    0.1114229716,
    -20.4306329155,
    0.9753845370,
    1.0469226043,
    -0.1725977279,
    -2.4359361564,
    -21.5691184243,
    -11.3330433341,
    -4.4989597413,
    5.0965513431,
    -3.2482946226,
    -1.5659537639,
    -8.7935271716,
    -3.6786358320,
    -0.8500728341,
    -0.4034390463,
    -4.6002659648,
    -0.0317229402,
    3.0043629006,
    2.0607679515,
    -12.4819035521,
    -21.5510782934,
    -28.4358725064,
    0.1851885307,
    -0.7802673660,
    0.5033676523,
    -0.1527691670,
    0.0000000000,
    -0.2579028283,
    -0.7416273912,
    -0.7344820025,
    -1.1802366568,
    -0.8802188945,
    0.2089851808,
    -18.8660239315,
    -1.5724789159,
    -0.1710607223,
    -1.2832167306,
    0.6952845287,
    2.1715777185,
    -0.4927862569,
    0.0220113446,
    -0.1026086482,
    -0.1871987391,
    -0.1407506681,
    -13.4225243875,
    -0.3394754240,
    1.3960435134,
    0.3134394910,
    1.5216292053,
    0.1198872091,
    0.5315379195,
    0.9474945080,
    0.1388645411,
    0.5416775354,
    0.0214356970,
    -6.8648706463,
    0.2855359490,
    0.2759450869,
    0.1399192079,
    -0.1303794483,
    0.0716396069,
    0.3118087998,
    0.2944776039,
    -0.3585001945,
    0.0000000000,
    0.0000000000,
    -1.3633310368,
    -1.3633310368,
    0.0000000000,
    -0.0230476453,
    -0.1796089310,
    0.0906817349,
    -2.9542813102,
    -0.2286843923,
    -0.1327919163,
    -0.5644892913,
    0.1518664846,
    -0.0769001463,
    -0.0769001460,
    0.1756330767,
    0.3437698312,
    -0.0399636322,
    3.3309937013,
    -0.3777556185,
    0.1722497970,
    0.0050627303,
    0.0000000000,
    -0.9915088587,
    0.0000000000,
    0.1093238103,
    -0.0370983513,
    -0.4068784501,
    -0.0159671592,
    -1.1889421485,
    0.3936863450,
    0.2148744131,
    -0.0432762833,
    0.0077608332,
    -0.0575976115,
    0.2171362588,
    -1.0021451954,
    -2.5889430822,
    -0.8673168082,
    -0.9463538515,
    -0.2336576943,
    -0.5352650931,
    0.2096435077,
    0.2096435076,
    0.0415624326,
    -0.0074758647,
    0.0000000000,
    0.0000000000,
    0.0050813062,
    0.0000000000,
    -0.0784074880,
    -0.2002307449,
    0.0137423921,
    0.0137423921,
    0.0000000000,
    -0.1219479212,
    -0.1686837313,
    -0.1618009200,
    0.0170985186,
    0.0000000000,
    -0.0383309804,
    0.0217331090,
    -0.0039053652,
    0.0170985185,
    0.0000000000,
    -0.0159671590,
    0.0077608333,
    0.0170985185,
    -0.0496808865,
    0.4259856713,
    0.4259856712,
    -0.5352650925,
    0.2526582694,
    -4.0947488349,
    -2.0575465038,
    0.1940010481,
    3.8114557113,
    0.9663503419,
    -18.5861976703,
    0.5845038762,
    -0.4331383225,
    0.1081349689,
    -1.6799802938,
    2.5295845537,
    -0.1532232961,
    0.4445309761,
    -0.6798818933,
    -1.2938245424,
    0.2073114210,
    -0.3328529622,
    4.8709033123,
    -0.7569970373,
    0.6134794415,
    -0.4498200398,
    -0.3585001937,
    -0.4331383223,
    0.4445309762,
    -0.3328529622,
    0.6134794414,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0013362260,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0154143197,
    0.0000000000,
    0.0080595304,
    0.0533419285,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0143880338,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.1281702624,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    0.0000000000,
    -0.0406625017,
    -0.0406625013,
    -0.0229064211,
    -0.0232373682,
    0.0920923175,
    -0.1938116369,
    49.1606141094,
    9.3027602399,
    49.4257478751,
    133.0694462990,
    0.0000000000,
    0.0113676382,
    -0.1525229161,
    -0.2329962891,
    0.0015058015,
    0.1516216510,
    -0.1177914260,
    0.0532013272,
    -0.1193472140,
    -0.0208864631,
    0.3834222738,
    -0.4549941254,
    -0.1950300154,
    0.1429815443,
    -0.0169011260,
    -0.0542510769,
    0.0133153961,
    0.1530364184,
    -0.2162094541,
    -124.6143725225,
    -113.4867023266,
    -118.7648822483,
    -25.9445581905,
    -15.0108747537,
    -0.5690306091,
    -4.8446827616,
    -0.6368278093,
    -0.7464392143,
    0.4913723230,
    0.3111120911,
    0.0548721464,
    0.2807460446,
    0.0363062560,
    4.0174889791,
    6.2052429183,
    -0.0010215296,
    51.1975856240,
    13.4066712657,
    11.5481729345,
    7.3481622043,
    6.2860380792,
    5.1298726661,
    6.5919068538,
    9.6354191940,
    7.8629539703,
    5.4208651470,
    10.1136144202,
    36.9213555982,
    32.1029889999,
    15.5592714330,
    13.9218355362,
    53.9147219378,
    14.7281698553,
    4.5791979168,
    10.5641466699,
    10.3414258929,
    30.4976938428,
    11.4953051927,
    16.9078276465,
    0.0000000000,
    4.5583703445,
    5.7231077358,
    6.7016645687,
    4.1591723109,
    7.3876165361,
    21.2336941410,
    9.5246334122,
    12.6270353096,
    30.5409567544,
    32.5961576105,
    8.2131738235,
    6.9617052316,
    0.0000000000,
    4.8987811675,
    16.8238924479,
    9.8402313331,
    0.6035138983,
    12.1226428008,
    12.2520960058,
    14.3257144856,
    18.5200845622,
    15.0883503277,
    19.5116506089,
    20.9703621360,
    22.9677481538,
    -44.3583312987,
    -38.6591288966,
    -46.4550689593,
    -45.8011025282,
    -10.7743940393,
    -5.2795732265,
    -27.4833826578,
    -16.1017382977,
    -12.1873088178,
    -6.0301734904,
    0.5190342320,
    30.8074201779,
    -0.3993688330,
    -10.5238713272,
    -0.2789354251,
    -0.0670498440,
    -0.2658278630,
    3.5617391119,
    -0.4498200398,
    -0.0471759975,
    -0.4369274991,
    0.0067606846,
    0.0108940522,
    1.0387462955,
    -1.3139004647,
    -20.7918271645,
    -0.0824881203,
    -0.1081760578,
    0.0005870826,
    0.0395942322,
    0.0205610094,
    -0.0043573267,
    0.0067606846,
    -4.2177057084,
    -0.5379971551,
    -3.9416460863,
    38.2674870671,
    -0.5659599915,
    -1.2600377702,
    -0.1338447847,
    -0.0440135754,
    -0.3591504217,
    -8.5872673502,
    1.0078443875,
    -0.5495129932,
    -0.6798818933,
    -0.6798818933,
    -2.5889430821,
    -2.3853529725,
    1.3614137077,
    0.0092200193,
    3.1214726418,
    -8.8582674354,
    -0.0313007710,
    2.5295845538,
    -0.0643924203,
    0.0146482404,
    -0.0106384516,
    1.0078443875,
    -0.7453586418,
    0.1470621594,
    -0.0066663843,
    0.5845038761,
    -0.0035289166,
    3.5617391119,
    0.1159045989,
    -1.0552126618,
    -0.0169887842,
    0.0000000000,
    0.4959600076,
    -0.0429218129,
    -0.4498200398,
    0.2432965971,
    0.0395068926,
    0.0000000000,
    0.0153739129,
    -0.0296305482,
    -0.2308524034,
    -0.0641159506,
    -0.0586412826,
    0.1011822809,
    -18.5861976703,
    0.0348441604,
    0.5338546619,
    -0.0578597384,
    -1.5724789159,
    0.0000000000,
    -0.2472991216,
    0.5388414298,
    -0.1238656011,
    0.0000000000,
    -0.0329351603,
    0.0581300393,
    -0.0135376130,
    0.2344239933,
    1.4757844820,
    -0.1022924435,
    0.0006812722,
    2.3298588468,
    -0.0765270859,
    1.1571381167,
    -0.0194491051,
    -0.3328529622,
    -0.0592434676,
    -0.1527691680,
    -0.1527691680,
    0.0180490864,
    0.0478611199,
    -0.1525221919,
    0.0000000000,
    0.0466736998,
    -0.3766188683,
    -0.1191912474,
    0.1230353401,
    -0.6643053620,
    -0.0821681033,
    0.0000000000,
    -0.0155560293,
    0.0000000000,
    0.0167072404,
    -0.2111993084,
    -0.8802188945,
    49.1606141094,
    38.2674870671,
    -2.9769058699,
    -15.3401304346,
    -3.5365560892,
    2.3204098510,
    0.2920416836,
    -3.4843841329,
    0.4824563848,
    50.5749272430,
    -39.3217492409,
    -17.2470493123,
    -34.7792324251,
    -7.5677234621,
    -0.7198386626,
    0.0934782543,
    -1.2649485227,
    -1.6155042528,
    0.2219483303,
    -0.1485439571,
    0.0036047139,
    0.0269463192,
    0.4731338227,
    -0.4322796573,
    -1.1816140605,
    2.8468064501,
    -0.5922889099,
    4.2823156372,
    -0.7862532598,
    1.3452698357,
    -0.1533457920,
    0.6650409424,
    -3.9985496249,
    0.6819710889,
    0.8439491732,
    -0.0799404786,
    -0.0735947563,
    -27.1177136622,
    -0.3910636796,
    5.1813779885
};

constexpr double INTERCEPT = 144.9538982036;

inline double predict(const double* features) {
    double pred = INTERCEPT;
    for (int i = 0; i < N_FEATURES; ++i) {
        // Clip features to prevent overflow
        double feat_val = features[i];
        if (!std::isfinite(feat_val)) {
            feat_val = 0.0;
        }
        feat_val = std::max(-1e6, std::min(1e6, feat_val));
        
        // Safe scaling
        double scale_val = SCALE[i];
        if (std::abs(scale_val) < 1e-10) {
            scale_val = 1.0;
        }
        double scaled = (feat_val - MEAN[i]) / scale_val;
        scaled = std::max(-100.0, std::min(100.0, scaled));
        
        pred += COEF[i] * scaled;
    }
    
    // Clip final prediction (polarizability should be positive, 0-500)
    if (!std::isfinite(pred)) {
        pred = 0.0;
    }
    pred = std::max(0.0, std::min(500.0, pred));
    
    return pred;
}

} // namespace CascadePolarizabilityV2
} // namespace Osmordred
