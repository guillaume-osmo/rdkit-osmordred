#pragma once
// Auto-generated Treelite model for deltaHc (v3.4 XGBoost)
// Trees: 300, Features: 596
// Target normalization: mean=-4494.6811068702, scale=3228.6159473816
// Library: deltahc_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadedeltaHc {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 596;
constexpr double TARGET_MEAN = -4494.6811068702;
constexpr double TARGET_SCALE = 3228.6159473816;

// Normalization stats
constexpr int N_NORM_FEATURES = 596;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0575455079,    0.2994715208,    0.0158543746,    0.0540223136,    0.0540223136,    0.0246623605,    0.0352319436,    1.2149148561,    2.5484439225,    0.0029359953,
    0.0369935408,    0.6112742220,    0.0035231944,    0.0751614797,    0.0164415737,    0.0246623605,    0.0499119201,    0.2894891368,    0.0845566647,    0.2178508514,
    0.1673517322,    7.1308525170,    0.7118049898,    -0.0303997126,    0.4729024074,    12.8870511187,    148.8059453905,    148.6284246559,    0.1466292211,    -0.2903860220,
    0.3013362114,    0.1495769233,    1.1642302032,    1.6145401876,    1.8785223490,    10.3331173852,    1.9734504106,    -1.9547149129,    2.0134040863,    -1.9606826427,
    6.2129071474,    3.4941651923,    2.4550415732,    2.6445072719,    1.6017504090,    -0.7161244862,    8.1996377929,    4.3555205620,    23.4661326707,    1.7944993510,
    1.1275063518,    22.7025272086,    12.8196260460,    4.8420322802,    7.1215049347,    3.8092199715,    31.1962066941,    4.6007361867,    3.5849691671,    5.6370184363,
    3.7407939961,    5.6301932461,    12.9028444915,    4.2600075349,    0.7780798356,    6.3629549282,    0.9753531778,    2.7961008832,    2.5852117697,    1.9847328244,
    1.6324133881,    2.3904873752,    3.8216619069,    1.8260726776,    40.7683748679,    0.1039342337,    0.0193775690,    0.0786846741,    1.1156782149,    0.0980622431,
    0.9095700556,    290.1139127386,    3.2284983094,    22.0358191427,    11.9289489137,    7.7163828538,    137.2453596373,    66.3646506166,    88.4092777452,    108.5886637131,
    119.1220843029,    543.2307692308,    1804.9777958462,    2404.7788165631,    4248.2797532478,    6936.9501765991,    1847.2148678479,    166.8528484410,    343.0382142660,    229.9458210804,
    30.2881430805,    36.9994065470,    52.1834801071,    20.8750302485,    5962.7178607201,    3574.6448963180,    2739.0994732523,    6.7306152767,    4.4428372095,    3.0010723730,
    3.0129775306,    6.1019517397,    3.7323947508,    2.5833232961,    31.2476233421,    24.6881067664,    12.0257151523,    93.4899184250,    240.1393033282,    148.4841652924,
    50.1167359211,    34.1090852693,    7.8521659935,    7.8190189668,    7.3313553029,    5.5422760589,    6.3452866094,    6.3603560233,    1.4270109224,    1.7012825040,
    0.4406559902,    0.3083712480,    167.2351201114,    149.0022934707,    158.9327740785,    -0.1741304578,    0.0271096092,    0.0014195599,    -0.0078304103,    1.4834484877,
    -0.7388502800,    2.0711930433,    0.1513399903,    0.1812970804,    36.5434829741,    -3.9742959146,    -1.3814882115,    -0.9528880449,    -16.0642570567,    1103.6423911551,
    -211.2008351251,    -14.0892053710,    1059.9141253662,    -36.3915974175,    -166.4185761884,    18.5497496287,    1.5082719301,    -0.0654898477,    0.2447846406,    -0.3882142392,
    2.3014356910,    -0.0749365348,    2.4035467271,    -0.0816753548,    5.3537420328,    -0.2342971123,    -0.8851135181,    -0.6053928995,    0.0323502267,    30.3890783500,
    -5.7046100289,    -6.6940135534,    0.4785707397,    0.0201895438,    -0.0102025421,    0.0010389197,    -0.0000924602,    0.0006477983,    3.2126921376,    -0.0669076056,
    0.0648433193,    -0.0919736271,    0.0161644088,    0.0488733168,    0.2408165664,    -2.2553097257,    -4.2723627745,    1.0937897569,    3.4627422149,    0.0844902038,
    -0.0059728585,    -0.0028195666,    -0.0070777837,    -0.0084499912,    -0.0012560902,    -0.0400710998,    1.4875385878,    -0.1863146396,    -0.0583130183,    0.1090791865,
    0.0875268903,    -0.0415143056,    -0.0368979670,    0.0308014122,    -0.0634803230,    0.0021664335,    0.1532580273,    -0.2110187899,    -0.1448358432,    -0.0544274920,
    0.0381323496,    0.0538108569,    -0.0227933959,    -0.0243598821,    -0.0555035712,    -0.1488242418,    0.0261197487,    -0.0433343901,    -0.1323072354,    -0.0403473174,
    -0.1058209456,    0.0362598911,    -0.1126264835,    1.3961673273,    0.9401835925,    0.7840288709,    1.1074256387,    1.0176994885,    0.3225440448,    1.0791020736,
    0.1880528564,    0.7501976925,    1.0131225882,    0.5822328035,    0.9744495259,    1.0936264285,    0.4991497534,    1.0981459730,    1.0868728832,    0.9068784785,
    0.7467564105,    0.2792942482,    0.8841776184,    0.8721622532,    1.1770105070,    -0.3448441356,    1.3683260293,    1.0449455242,    1.3083634269,    3.4923906936,
    2.5203201826,    2.2702084662,    13.4812845297,    10.9850878836,    2.5338486130,    0.6459085018,    3.2146207367,    58.1961587992,    4.4628595034,    29.1543083277,
    0.5196556715,    3.0366349665,    0.9686504935,    0.5482118302,    0.3630637036,    2.1579565473,    0.0386999342,    0.5273645465,    0.3659024739,    0.2813711608,
    0.6564453837,    0.3976068547,    0.2532789411,    0.1556989096,    0.0874996398,    0.0452237010,    0.0248997639,    0.0126036138,    13.3057349775,    12.3891387387,
    12.7720314405,    22.0487616857,    21.1343902916,    21.4292800940,    13.9609255224,    25.0852815971,    0.6611044785,    0.6250167843,    0.5934959201,    1.0131276189,
    0.9749303758,    0.9884810547,    0.6416659014,    1.1426978296,    103.6986400123,    51.6414941441,    72.1284318088,    103.6986400123,    7.7189351440,    51.6430229702,
    0.0000000000,    3.0460338096,    0.3404929087,    0.9714902633,    37.4019682045,    3.1560381828,    3.1763765148,    465.4997064005,    68.4052317863,    34.1962520785,
    51.0167740479,    68.4052317863,    5.3140628901,    34.1981067439,    3.0371319948,    0.3397007030,    0.9688622647,    38.0615791269,    3.2047265287,    3.1893559774,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    1.2143276571,    0.0728126835,    2.5396359366,    0.0158543746,
    0.2366412214,    1.6823253083,    0.3740458015,    0.0070463887,    0.0557839107,    0.4744568409,    0.6611861421,    0.1644157369,    0.1861421022,    0.0140927775,
    0.0886670581,    0.0017615972,    0.0041103934,    0.0833822666,    0.0493247211,    0.0258367587,    0.0035231944,    0.0258367587,    0.1015854375,    0.0299471521,
    0.1133294187,    0.0176159718,    0.0000000000,    0.3470346447,    0.6112742220,    0.3082795068,    0.0082207868,    0.1832061069,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0029359953,    0.0000000000,    0.0193775690,    0.0046975925,    0.0305343511,
    0.0035231944,    0.0029359953,    0.0129183793,    0.1056958309,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.1234365061,
    0.0841733167,    2.9722241692,    0.0313478645,    0.1183041972,    0.0808797314,    1.1055274881,    0.2329676251,    0.0785802596,    0.0460469270,    0.1848120369,
    4.1999641444,    0.9555361547,    0.2992408794,    0.0554113947,    9.5736934821,    5.5833822666,    3.9903112155,    7.8258268599,    5.1149701477,    0.0173591685,
    0.2284731010,    0.8692934744,    -0.1355258492,    -0.1794592155,    -1.9889012933,    3.1189482748,    68.5738715140,    0.3256738170,    0.3170073531,    0.4748818020,
    2.9372809223,    2.2528844081,    1.5902606090,    13.7436113948,    20.9347378106,    25.2858898630,    30.1888118991,    24.6380150207,    22.0429292701,    4.8660711109,
    0.3155808127,    0.1506196778,    0.0519355001,    0.0077101367,    0.0383683675,    0.0092144158,    0.1200209811,    0.0353868527,    0.0366206461,    19.3770996768,
    1.8803528297,    4.2825483999,    0.4578369643,    15.0945512770,    1.4225158655,    1.1041029184,    0.1167829717,    2.4800130713,    0.2486326201,    0.5509584070,
    0.0696294661,    11.9506752789,    12.7715795655,    13.5231943629,    14.1168526130,    12.2284204345,    11.6118614210,    11.2184380505,    11.0381679389,    10.4362889019,
    128.7968291251,    2.4190025852,    0.0610687023,    0.0816206694,    32.4124251321,    0.1312110981,    0.2322630668,    0.0008280104,    6.1726365238,    0.7584866551,
    39.1058756589,    4.3986755399,    92.0427510276,    4.4597768644,    6.7586611861,    1.1587524824,    0.3329030522,    0.0937196731,    0.3423495384,    0.0109779838,
    0.1222055522,    0.0726049153,    0.0282334168,    0.0671304652,    0.0272182528,    0.3982161331,    0.0316653969,    0.0750852580,    0.4609036994,    0.6227580740,
    5.7764334810,    7.3026052498,    5.4221393167,    0.1602016606,    0.7081988434,    1.4851866906,    8.2608332569,    1.3153090458,    239.1453855994,    1.7061293089,
    2.2969783984,    6.2072812683,    1.2030045166,    107.8043221985,    4.9498517149,    0.6165360480,    0.5039503045,    1.0474994366,    1.4562878023,    0.7905646170,
    0.2070349278,    0.3431275755,    16.8014103506,    7.5542712157,    6.9650375496,    20.7385072456,    169.1516030614,    59.3220470594,    1.5576829237,    2.0364077175,
    -2.0087286051,    -304.6739917205,    1.2030045166,    0.6165360480,    4.9498517149,    0.5039503045,    0.7905646170,    0.2070349278,    1.0474994366,    1.4562878023,
    107.8043221985,    1.8770479244,    0.7974704895,    33.6600887492,    0.4252863677,    0.8864797841,    0.1575743297,    1.1712408643,    2.1276867520,    15271.0784675944,
    0.8648307310,    7.7468392160,    0.6698397483,    0.9966405315,    0.2461069206,    1.2448214683,    1.7625815656,    168.7162275306,    4.2858840981,    0.4141417600,
    0.7178627568,    0.1768798681,    0.7207361091,    0.9336494183,    82.7083834632,    3.0287749661,    4.6368186816,    1.1941753720,    5.3121380405,    7.3155168135,
    704.1778957834,    0.5141526779,    0.1825704244,    0.5554885952,    0.7395186002,    59.5990209850,    0.2271511475,    0.9012097437,    1.1768898466,    91.3941960787,
    0.2478936845,    0.3073620495,    21.5321403638,    1.5340667558,    112.3111444583,    158.4757291701,    3.2646121188,    40.7683748679,    145.1155327493,    0.2706991624,
    149.5535754486,    39.5967698776,    26.9510805496,    1.4567023539,    1.9922796856,    1.5432132087,    2.9127229615,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.4812152727,    0.8788202484,    0.1465435227,    0.3242317331,    0.2752567233,    0.1729916735,    0.2469854460,    1.3464337452,    4.1915213315,    0.0640450885,
    0.2455348841,    0.9010542318,    0.0592518478,    0.2991270629,    0.2693368860,    0.1953123293,    0.2770932576,    0.6566350704,    0.3905999423,    0.6610448029,
    0.6624323745,    3.4743271335,    0.7715183772,    1.3732326798,    0.1159643782,    8.5672448574,    78.9079228411,    78.8320699431,    0.1527403321,    0.1537217654,
    0.1569821825,    0.1223273747,    0.4385031786,    0.5247606695,    0.5713408450,    0.5341611642,    0.2689982484,    0.2166750983,    0.2702507586,    0.2981148126,
    3.5884541451,    2.3887139888,    1.8189170409,    1.8139102804,    1.4021594046,    0.8553617365,    4.7986229793,    4.0889140961,    314.5379131778,    5.0661621029,
    3.9552409284,    29.0435852962,    13.6311667939,    6.4722561134,    9.3730122946,    7.6992740151,    36.9199910687,    10.2006998556,    5.6744682069,    8.8159387603,
    8.0668880215,    11.3248934411,    17.1728816378,    7.0279561482,    2.7005424768,    9.5521919964,    2.4153565102,    6.2625848436,    3.1444946779,    2.3784117940,
    1.7970895079,    2.5123682188,    4.0733192997,    2.2681117806,    23.6949778268,    0.3911856502,    0.1539469756,    0.3718328804,    3.4559735270,    0.5839020771,
    0.6928205690,    7997.5163710349,    1.5402804341,    13.8195487126,    9.2553139049,    5.4745454270,    153.3475074136,    47.8159182567,    101.6507952022,    103.1964467432,
    92.0359776153,    479.7037035125,    1041.9976412758,    1736.8873151117,    2509.8409774912,    4986.0423126226,    5550.9140441623,    103.4137349402,    319.7779085771,    155.9844943402,
    18.3567602349,    24.6750042048,    38.4915567522,    48.1490373636,    4224.2641965842,    6924.9272498866,    6670.6517868936,    5.9835135236,    5.2088936499,    5.0435585547,
    0.9166797491,    6.6551624956,    5.1212604215,    5.1664159491,    44.5190633582,    12.3566950326,    16.0510231066,    53.8096624044,    39.6521607089,    52.0868774819,
    56.7946672147,    50.7259434559,    1.0687237416,    0.6193823208,    1.9008139024,    3.4358522106,    1.1893775116,    1.0195350612,    0.4925364971,    0.2968063670,
    0.4522470559,    0.4195702387,    12.4472819238,    8.8889191471,    12.9581501130,    0.2310190231,    0.1930717777,    0.1993944113,    0.1607575222,    24.0328861156,
    20.7986656327,    3.6916240314,    3.8646918309,    2.3451212929,    40.1314683229,    7.3123556421,    14.6527179473,    18.2624032362,    79.2718266845,    1873.4959423496,
    594.1052654804,    337.4808478482,    717.7270756920,    86.2138788735,    416.8771411684,    404.3204564512,    1.4289557787,    0.4354435740,    0.7985456679,    0.8734011508,
    1.7992554505,    0.5297996035,    2.1014750433,    0.9571871831,    3.7173970800,    0.7308427316,    2.0430524810,    2.1330902410,    1.5517526465,    20.9010923882,
    12.4888034792,    11.8457668921,    7.6147901490,    0.0206011845,    0.0143300101,    0.0089324881,    0.0081405707,    0.0160083241,    1.7380528610,    1.8707260405,
    0.1587607028,    0.1006738102,    0.1339156319,    0.1427526272,    0.9521181198,    66.0443593709,    8.7811130384,    15.7170578617,    17.4909229448,    0.0797416671,
    0.0282431070,    0.0542795644,    0.0352617357,    0.0428136134,    0.0554133050,    0.0899868854,    1.0790339872,    0.4436205450,    0.4066185892,    0.4130900016,
    0.3168086645,    0.2102938653,    0.2224917176,    0.2897882728,    0.2166141990,    0.4223672981,    0.2367805697,    0.1570667260,    0.1858810425,    0.2219055416,
    0.2459792798,    0.2220858496,    0.3887751532,    0.1003442826,    0.1216908832,    0.2310066201,    0.3414935234,    0.1751019487,    0.2473642070,    0.3903455448,
    0.2012335620,    0.2957436164,    0.2059062434,    0.3260273442,    0.4630468333,    0.5588943817,    0.4520803991,    0.5257967991,    0.6452796500,    0.4431794128,
    0.3694762865,    0.3318025469,    0.4146282978,    0.9962647179,    0.2713581969,    0.3436324805,    0.7259670689,    0.2357069330,    0.3013544555,    0.3659795405,
    0.4861206052,    0.4557187863,    0.3730457650,    0.4213859599,    0.2713828948,    0.0983062886,    0.7893377170,    0.2277485684,    0.2841791776,    0.3154155145,
    0.0793190298,    0.0792302476,    1.4183909043,    0.2217484714,    0.6427651358,    0.6952072960,    1.0613511820,    106.6704725317,    2.8197744982,    53.3196172178,
    0.6025665462,    0.7714182035,    0.7263925945,    0.6560730713,    0.1910641398,    3.5487138994,    0.1747762688,    0.9864297002,    0.0780132675,    0.5228542274,
    0.1296836745,    0.1331680500,    0.1363942344,    0.1433514441,    0.0990230829,    0.0609885560,    0.0396676583,    0.0252815236,    7.0392987863,    6.5696380685,
    7.5367613808,    13.3602032518,    12.6661366626,    12.8410079974,    8.5209922298,    15.6263088301,    0.2631302448,    0.2936526007,    0.0845105159,    0.0608083818,
    0.0786674910,    0.0831912676,    0.0812445114,    0.0381764047,    171.7029217704,    84.3920384312,    111.1743290997,    171.7029217704,    5.3155991489,    84.3911472863,
    1.0000000000,    0.7769504751,    0.0826329943,    0.7274269972,    40.2677409114,    1.0096241742,    1.2893095585,    1849.4470471895,    114.4901565379,    57.2300117261,
    83.0454814984,    114.4901565379,    2.8757202713,    57.2289883913,    0.7711251125,    0.0829067747,    0.7261827734,    41.2020878578,    1.0479594426,    1.2955738901,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.3463092816,    0.2751940833,    4.1930145313,    0.1465435227,
    0.6678743363,    3.1627546576,    0.9779521380,    0.0903943320,    0.3355091209,    0.8452273084,    1.2618212387,    0.8757057698,    0.6309649954,    0.1178735385,
    0.3406422677,    0.0419344006,    0.0639804508,    0.3479321670,    0.2782555374,    0.2010880308,    0.0906000770,    0.1859150492,    0.5091215647,    0.2440997159,
    0.5226111225,    0.1634038993,    1.0000000000,    0.9021090070,    0.9010542318,    0.7119289169,    0.0902951024,    1.1873376997,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.0541052237,    1.0000000000,    0.1539469756,    0.0764847908,    0.2090329687,
    0.0592518478,    0.0541052237,    0.1129225168,    0.4960056248,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.7921473133,
    0.6355441326,    8.0713400747,    0.2977619769,    0.8689152815,    0.5255626686,    3.9715676258,    0.6036423552,    0.4150425232,    0.2946875161,    0.4682426581,
    5.0795043266,    1.9063301784,    1.1919568606,    0.4146012275,    7.4890015840,    3.5002021348,    4.8556733007,    8.0566992577,    6.3197327169,    0.0204585917,
    0.2303879421,    0.1649663087,    0.1755338428,    0.3158109795,    2.1092094084,    0.9082287748,    49.2648475210,    0.1136726343,    0.1112633773,    0.1503909230,
    0.9083245117,    0.9860367657,    0.8741487679,    7.5324597243,    8.1952288866,    9.6871085987,    17.0933034994,    12.9476950471,    11.1047889326,    4.1820804246,
    0.9659310900,    0.6050789458,    0.2515077906,    0.0602924945,    0.2550060268,    0.0825312988,    0.7424987966,    0.2928339723,    0.3254800205,    11.8215410627,
    0.1089760185,    4.5416681543,    0.3847405690,    11.2436863267,    0.4308432105,    2.3884755644,    0.2390194562,    3.2498425480,    0.2757673905,    2.2686631289,
    0.2279293785,    8.9914115975,    13.1008138607,    18.0542477686,    24.1951081171,    28.2769640641,    35.3655720701,    43.8806282627,    52.5821032311,    59.2627678494,
    280.3032454269,    0.5459180667,    0.2650616819,    0.2843074504,    36.8519539139,    0.2938342568,    0.1492708146,    0.0026787010,    4.0470837867,    0.2559608802,
    11.1734152202,    2.1090885854,    69.2903884407,    5.1442489204,    4.8603401617,    1.6143618233,    1.0640650518,    0.4771745472,    1.9443841015,    0.1855931687,
    0.8956376409,    0.7073953711,    0.2737722931,    0.4578629699,    0.1941429593,    0.6717679401,    0.2921146512,    0.3537991575,    0.4726202508,    0.6608072833,
    1.5006192977,    22.6614073398,    1.0560727868,    0.1988397457,    0.4962821172,    0.3640462844,    1.1569162417,    1.0802530900,    1333.9564598068,    1.3596644511,
    0.1655771489,    5.2317871719,    0.6556127343,    60.4094908348,    3.0263933567,    0.6460292493,    0.4139087559,    0.2720032988,    0.0831419801,    0.5113583582,
    0.3386899296,    0.1389196344,    1.6709704305,    5.8371632473,    5.1037178355,    4.7813433047,    110.4834303774,    28.0542186858,    2.6938001239,    2.2956607150,
    2.1732479453,    448.8700423836,    0.6556127343,    0.6460292493,    3.0263933567,    0.4139087559,    0.5113583582,    0.3386899296,    0.2720032988,    0.0831419801,
    60.4094908348,    3.1575834600,    1.7934127569,    66.1310332944,    1.2992598131,    0.9756653425,    0.5217745917,    0.6673891529,    0.2459771838,    24511.9351508800,
    1.5576006711,    14.0238423155,    1.1843140366,    1.0673830731,    0.5951224734,    0.6945619382,    0.9752354882,    276.8467246216,    8.3607073675,    1.0176385257,
    1.0571346715,    0.5416241391,    0.8489026392,    1.0032775586,    152.6214600468,    6.1612258179,    5.4865555075,    3.1597265321,    3.6615067957,    4.5997263755,
    1240.2175303751,    0.6389195528,    0.6863333819,    0.5081097527,    0.6121094162,    104.6431182617,    0.4578832549,    0.7078483842,    0.7935993528,    101.2198090385,
    0.4464577350,    0.5089935196,    51.8052525983,    0.4428329525,    66.6374464791,    91.0659511692,    3.3024937111,    23.6949778268,    77.2002346236,    0.0421965531,
    83.8296197313,    22.0707229150,    15.1023727087,    0.2967306461,    0.4051132968,    0.3137994104,    0.5825358186,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 502;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    0,    15,    24,    26,    27,    49,    63,    66,    67,    77,    79,    86,    88,    93,    96,    98,    138,    140,    141,    147,
    226,    291,    293,    294,    295,    296,    297,    299,    302,    303,    304,    305,    306,    307,    308,    310,    311,    312,    313,    314,
    321,    324,    326,    327,    329,    332,    334,    335,    336,    339,    347,    348,    349,    350,    352,    368,    374,    375,    379,    380,
    382,    383,    384,    385,    387,    388,    390,    393,    394,    399,    409,    411,    419,    421,    422,    423,    445,    478,    506,    511,
    520,    521,    523,    526,    531,    533,    545,    553,    556,    561,    563,    570,    580,    581,    588,    590,    596,    598,    601,    617,
    624,    625,    626,    631,    635,    640,    641,    642,    644,    645,    652,    660,    663,    666,    669,    670,    673,    679,    688,    690,
    694,    695,    696,    697,    700,    702,    705,    707,    723,    724,    730,    731,    732,    733,    734,    742,    743,    746,    748,    752,
    758,    760,    765,    767,    768,    769,    775,    776,    782,    786,    789,    792,    795,    796,    797,    801,    804,    805,    806,    808,
    813,    814,    822,    829,    831,    832,    833,    835,    839,    840,    842,    843,    847,    849,    850,    851,    852,    856,    858,    864,
    868,    869,    872,    873,    878,    900,    905,    908,    909,    912,    913,    918,    922,    931,    938,    942,    948,    951,    952,    954,
    956,    959,    960,    961,    966,    970,    973,    974,    975,    976,    977,    982,    993,    997,    1005,    1007,    1009,    1013,    1031,    1033,
    1038,    1041,    1046,    1053,    1056,    1057,    1062,    1064,    1068,    1071,    1076,    1078,    1079,    1083,    1086,    1087,    1091,    1102,    1103,    1104,
    1105,    1108,    1110,    1136,    1142,    1150,    1152,    1154,    1156,    1163,    1164,    1168,    1171,    1172,    1173,    1180,    1211,    1216,    1217,    1218,
    1219,    1220,    1222,    1232,    1288,    1293,    1310,    1323,    1335,    1347,    1349,    1350,    1351,    1352,    1353,    1354,    1355,    1356,    1357,    1358,
    1359,    1360,    1361,    1362,    1363,    1364,    1365,    1366,    1367,    1368,    1369,    1370,    1371,    1372,    1373,    1374,    1375,    1376,    1377,    1378,
    1379,    1380,    1381,    1382,    1383,    1384,    1385,    1386,    1387,    1388,    1389,    1390,    1391,    1392,    1393,    1394,    1395,    1396,    1397,    1398,
    1399,    1400,    1401,    1402,    1403,    1404,    1405,    1406,    1407,    1408,    1409,    1410,    1411,    1412,    1413,    1414,    1415,    1416,    1417,    1418,
    1419,    1420,    1421,    1422,    1423,    1424,    1425,    1426,    1427,    1428,    1429,    1430,    1431,    1432,    1433,    1434,    1435,    1436,    1437,    1438,
    1439,    1440,    1441,    1442,    1443,    1444,    1445,    1446,    1447,    1448,    1449,    1450,    1451,    1452,    1453,    1454,    1455,    1456,    1457,    1458,
    1459,    1460,    1461,    1462,    1463,    1464,    1465,    1466,    1467,    1514,    1527,    1533,    1574,    1579,    1582,    1596,    1611,    1615,    1650,    1718,
    1736,    1737,    1755,    1771,    1809,    1811,    1813,    1817,    1825,    1830,    1831,    1836,    1842,    1845,    1853,    1859,    1863,    1866,    1872,    1873,
    1878,    1879,    1880,    1884,    1885,    1889,    1891,    1893,    1895,    1897,    1966,    1967,    1968,    1969,    1970,    1971,    1972,    1973,    1974,    1975,
    1976,    1977,    1978,    1979,    1980,    1981,    1982,    1983,    1984,    1985,    1986,    1987,    1988,    1989,    1990,    1991,    1992,    1993,    1994,    1995,
    1996,    1997,    2037,    2082,    2153,    2158,    2164,    2172,    2175,    2177,    2201,    2208,    2210,    2231,    2234,    2251,    2308,    2347,    2407,    2447,
    2524,    2547,    3091,    3095,    3109,    3136,    3277,    3502,    3767,    3769,    3781,    3782,    3785,    3797,    3800,    3812,    3829,    3835,    3849,    3850,
    3868,    4041
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 20;
constexpr int N_PHYSICS_FEATURES = 74;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
    "dD",
    "dH",
    "dP",
    "HansenTotal",
    "BP",
    "deltaHvap",
    "logVP",
    "logPow",
    "logWS",
    "deltaHf",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
    "deltahc_v_flashpoint_est",
    "deltahc_v_sq",
    "deltahc_flashpoint_sq",
    "deltahc_v_logvp_est",
    "deltahc_v_sq",
    "deltahc_logvp_sq",
    "deltahc_v_l_est",
    "deltahc_v_sq",
    "deltahc_l_sq",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/deltahc_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/deltahc_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadedeltaHc
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadedeltaHc {
struct Model {
    using Namespace = CascadedeltaHc;
};
} // namespace CascadedeltaHc
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
