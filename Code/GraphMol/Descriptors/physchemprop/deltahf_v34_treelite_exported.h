#pragma once
// Auto-generated Treelite model for deltaHf (v3.4 XGBoost)
// Trees: 300, Features: 585
// Target normalization: mean=-304.6739917205, scale=448.8700423836
// Library: deltahf_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadedeltaHf {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 585;
constexpr double TARGET_MEAN = -304.6739917205;
constexpr double TARGET_SCALE = 448.8700423836;

// Normalization stats
constexpr int N_NORM_FEATURES = 585;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0575455079,    0.2994715208,    0.0158543746,    0.0540223136,    0.1315325895,    1.2149148561,    2.5484439225,    0.1027598356,    0.0223135643,    0.0029359953,
    0.0064591897,    0.3476218438,    0.2489724016,    0.0593071051,    0.0082207868,    0.6112742220,    0.0305343511,    0.1861421022,    0.0164415737,    0.1056958309,
    0.0728126835,    1.9183793306,    1.0722254844,    0.0499119201,    0.0234879624,    0.4392248972,    0.1632413388,    0.1244862008,    7.1308525170,    0.7118049898,
    -0.0303997126,    0.4729024074,    12.8870511187,    148.8059453905,    148.6284246559,    0.1466292211,    -0.2903860220,    0.3013362114,    0.1495769233,    1.1642302032,
    1.6145401876,    20.5086071174,    -1.9547149129,    -1.9606826427,    5.6587642493,    0.3768358197,    2.8639756521,    0.9599438407,    -0.7161244862,    8.1996377929,
    4.3555205620,    23.4661326707,    4.5382785474,    1.7944993510,    0.6639418813,    2.6204895112,    1.4138673107,    22.7025272086,    12.8196260460,    7.1215049347,
    22.8731609323,    4.2530250975,    15.6911978883,    1.1256913578,    1.4063668287,    3.7533257670,    3.8092199715,    31.1962066941,    4.6007361867,    4.5470059411,
    3.5849691671,    5.6370184363,    3.7407939961,    5.6301932461,    12.9028444915,    6.3629549282,    5.2075384758,    0.9753531778,    -0.1641818652,    2.7961008832,
    0.5831973463,    3.8216619069,    1.8260726776,    40.7683748679,    0.3282442748,    7.1202128208,    0.0980622431,    1.1636303038,    0.5731062830,    1.4116265414,
    125.6572186096,    103.8741088711,    137.2453596373,    67.2874204885,    108.5886637131,    119.1220843029,    136.2231835930,    2404.7788165631,    2278.7556800493,    210.7641781550,
    2.2822333647,    1.8278870411,    2.6163119401,    1.3923964773,    0.8045590219,    0.5650738237,    3.3260025038,    3.1368497730,    1.0265064640,    24.6881067664,
    12.0257151523,    62.7465582072,    41.8357458297,    31.1746993817,    199.3960293872,    185.9234744852,    71.2339644634,    7.8190189668,    5.5422760589,    6.4931505226,
    1.7012825040,    0.9281546408,    167.2351201114,    158.9327740785,    162.0110253706,    127.7789638863,    96.9443558390,    -0.1741304578,    0.0045750862,    -0.0491348553,
    0.0014195599,    -0.0078304103,    63.7368296510,    13.9549664235,    -16.2403581087,    -17.8085571575,    -7.3597081193,    -3.0545057697,    2.0711930433,    -2.6838959541,
    36.5434829741,    -3.9742959146,    7.2249113587,    -5.0268827791,    -7.9403316511,    -5.1800018930,    -1.3814882115,    -43.2250234241,    -16.0642570567,    -7.4959562139,
    1059.9141253662,    -240.4463796030,    -42.3229923872,    1.5082719301,    -0.0654898477,    -0.0278347516,    2.3014356910,    -0.0749365348,    0.2801527006,    2.4035467271,
    0.3452552869,    -0.3913859776,    -0.6011692351,    -0.2481031128,    -0.8851135181,    -1.2693567181,    0.0596910400,    30.3890783500,    -5.7046100289,    -6.6940135534,
    -0.3485089338,    -0.0000924602,    -0.0013578089,    0.0000781786,    0.0000726049,    0.6348717604,    -0.6476368482,    -0.5550123330,    -0.1986575063,    0.4567620208,
    -0.0674549018,    -0.2830157594,    -0.3016817805,    -0.2091457541,    -2.0888491717,    47.1927647335,    0.0072616438,    0.1244891381,    -0.0070777837,    -0.0039853582,
    -0.0084499912,    0.2603142106,    -0.0263264737,    -0.1563046116,    -0.1719284821,    -0.1863146396,    -0.3777191639,    -0.0185931093,    -0.0368979670,    -0.2110187899,
    -0.1448358432,    -0.0952437048,    0.0134935621,    0.0528000205,    -0.0555035712,    0.0748083151,    0.0992757597,    -0.0433343901,    0.0337273619,    -0.1265856718,
    -0.1182804395,    -0.0394663340,    -0.0443777864,    0.0284193422,    -0.1058209456,    0.0860898309,    0.0780589106,    0.0420153666,    1.3961673273,    0.9401835925,
    0.7840288709,    1.1074256387,    1.0176994885,    0.8352705641,    1.5233808553,    1.0431875141,    0.7501976925,    1.0131225882,    0.9847909272,    0.9744495259,
    1.0936264285,    0.8589394433,    0.4991497534,    1.0868728832,    0.9068784785,    0.7467564105,    0.9296388399,    0.8841776184,    1.0857257813,    0.9339327287,
    0.9096264431,    0.9458142146,    1.0575434170,    0.9039972720,    0.7305954495,    1.2889681476,    0.6969109413,    1.4102434661,    1.1770105070,    1.0636332149,
    1.3683260293,    1.0449455242,    5.1144783005,    1.3083634269,    5.7907887044,    11.8145552454,    21.3962371823,    16.3805079441,    3.4923906936,    13.4812845297,
    10.9850878836,    2.5338486130,    67.7519578737,    0.5482118302,    56.1122729113,    5.9513262800,    -2.1118083154,    18.0698766882,    0.8144450969,    0.2245663035,
    0.0322959483,    0.0086574001,    0.0246099028,    0.0763436802,    0.7797578152,    0.6564453837,    0.0874996398,    0.0158543746,    1.6823253083,    0.3740458015,
    0.0070463887,    0.0557839107,    0.4744568409,    0.6611861421,    0.1644157369,    0.1861421022,    0.0140927775,    0.0886670581,    0.0017615972,    0.0041103934,
    0.0833822666,    0.0493247211,    0.0258367587,    0.0035231944,    0.0258367587,    0.1015854375,    0.0299471521,    0.1133294187,    0.0176159718,    0.0000000000,
    0.3470346447,    0.6112742220,    0.3082795068,    0.0082207868,    0.1832061069,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0029359953,    0.0000000000,    0.0193775690,    0.0046975925,    0.0305343511,    0.0035231944,    0.0029359953,    0.0129183793,
    0.1056958309,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0246623605,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0140927775,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0229007634,    0.0275983558,    0.0311215502,    0.0287727540,
    0.0211391662,    0.0540223136,    0.0099823840,    0.0058719906,    0.0117439812,    0.1068702290,    0.1896652965,    0.0364063417,    0.1098062243,    0.0005871991,
    0.1374045802,    0.7475044040,    0.0416911333,    0.1098062243,    0.1315325895,    0.0663534938,    0.2266588373,    0.0258367587,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    2.4029798271,    0.2535921500,    2.7080138957,    0.0771920141,    0.3850873134,    3.1844583770,
    -0.0467126467,    0.0149320729,    0.1234365061,    0.4470490225,    0.2077999913,    0.0841733167,    0.0000000000,    0.0759466484,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0313478645,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.1183041972,    0.1484972824,    0.1461694011,
    0.0808797314,    0.0595707192,    0.1193442254,    0.0233853590,    0.0078588827,    0.0103632617,    -0.0964551369,    1.6571474465,    0.3268143782,    0.9054286431,
    0.0047165815,    0.6409053970,    0.0785802596,    0.0669149865,    0.0082424909,    1.1613159761,    0.3918187304,    0.2240533406,    -0.1412149443,    0.1606262794,
    0.4414818691,    0.0233189738,    9.5736934821,    0.0108268048,    0.7077291357,    3.0217423684,    0.4353908754,    0.1684868713,    0.0227096199,    0.0303700725,
    0.8272860450,    0.1653534858,    0.0298276366,    -1.5930710511,    -0.1794592155,    2.0050365488,    3.0038028583,    3.1249769530,    3.1189482748,    42.5891019462,
    74.7747015332,    0.3256738170,    0.4892494761,    0.6412907726,    0.7141522588,    0.7375422631,    0.6237960700,    0.7169773206,    2.2528844081,    1.1389726821,
    25.2864486149,    1.4055809016,    0.8381144257,    5.4225731535,    3.5833450065,    0.0383683675,    1.8803528297,    1.1041029184,    0.1167829717,    2.4800130713,
    0.5509584070,    2.6953528035,    13.8020470963,    0.0058989499,    0.0291804643,    0.0146265979,    0.0058836767,    0.4109829331,    39.1058756589,    4.3986755399,
    0.1072381392,    0.1874616063,    1.4645783784,    1.1587524824,    0.0804268127,    0.1185813551,    0.2145326307,    0.4182644186,    0.0343989094,    0.3617633915,
    0.1114828673,    0.0048823591,    1.6617733412,    0.1293666011,    0.0231295731,    2.0512748619,    0.4718320611,    0.8170804463,    0.6227580740,    5.9171073569,
    5.4221393167,    0.7963102313,    4.8700390431,    8.2608332569,    1.4185659672,    3.6664518522,    0.2825246040,    2.2969783984,    0.0223135643,    6.2072812683,
    0.0076335878,    1.2030045166,    107.8043221985,    4.9498517149,    0.6165360480,    0.5039503045,    1.0474994366,    1.4562878023,    0.7905646170,    0.2070349278,
    0.3431275755,    16.8014103506,    7.5542712157,    6.9650375496,    20.7385072456,    169.1516030614,    59.3220470594,    1.5576829237,    2.0364077175,    -2.0087286051,
    1.2030045166,    0.6165360480,    4.9498517149,    0.5039503045,    0.7905646170,    0.2070349278,    1.0474994366,    1.4562878023,    107.8043221985,    1.8770479244,
    0.7974704895,    33.6600887492,    0.4252863677,    0.8864797841,    0.1575743297,    1.1712408643,    2.1276867520,    15271.0784675944,    0.8648307310,    7.7468392160,
    0.6698397483,    0.9966405315,    0.2461069206,    1.2448214683,    1.7625815656,    168.7162275306,    4.2858840981,    0.4141417600,    0.7178627568,    0.1768798681,
    0.7207361091,    0.9336494183,    82.7083834632,    3.0287749661,    4.6368186816,    1.1941753720,    5.3121380405,    7.3155168135,    704.1778957834,    0.5141526779,
    0.1825704244,    0.5554885952,    0.7395186002,    59.5990209850,    0.2271511475,    0.9012097437,    1.1768898466,    91.3941960787,    0.2478936845,    0.3073620495,
    21.5321403638,    1.5340667558,    112.3111444583,    158.4757291701,    3.2646121188,    40.7683748679,    145.1155327493,    0.2706991624,    149.5535754486,    39.5967698776,
    26.9510805496,    1.4567023539,    1.9922796856,    1.5432132087,    2.9127229615
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.4812152727,    0.8788202484,    0.1465435227,    0.2752567233,    0.4378835957,    1.3464337452,    4.1915213315,    0.5100384133,    0.1894952416,    0.0640450885,
    0.1303343839,    0.9028589902,    0.6189585051,    0.3401236195,    0.0902951024,    0.9010542318,    0.2090329687,    0.6309649954,    0.2693368860,    0.4960056248,
    0.2751940833,    3.1779901032,    1.5051519014,    0.2770932576,    0.1552761288,    0.7568282926,    0.4352488019,    0.5306843793,    3.4743271335,    0.7715183772,
    1.3732326798,    0.1159643782,    8.5672448574,    78.9079228411,    78.8320699431,    0.1527403321,    0.1537217654,    0.1569821825,    0.1223273747,    0.4385031786,
    0.5247606695,    15.7157679937,    0.2166750983,    0.2981148126,    1.3927302969,    0.6482159337,    0.6223777042,    1.0744045629,    0.8553617365,    4.7986229793,
    4.0889140961,    314.5379131778,    6.5706059153,    5.0661621029,    2.4880302628,    5.7497961800,    3.5058351455,    29.0435852962,    13.6311667939,    9.3730122946,
    29.4817034082,    6.6818009540,    22.2478694640,    3.9431018961,    3.5670936009,    5.5164363404,    7.6992740151,    36.9199910687,    10.2006998556,    8.2521788658,
    5.6744682069,    8.8159387603,    8.0668880215,    11.3248934411,    17.1728816378,    9.5521919964,    9.8659912902,    2.4153565102,    3.1289952064,    6.2625848436,
    0.3885860164,    4.0733192997,    2.2681117806,    23.6949778268,    0.9551023317,    4.4703266844,    0.5839020771,    0.1212087185,    1.2166027678,    1.8401233387,
    107.1268493372,    89.0540505966,    153.3475074136,    161.6537324248,    103.1964467432,    92.0359776153,    153.4054518566,    1736.8873151117,    2252.0366953223,    322.4590098444,
    4.9911029361,    4.6134327944,    0.8020688509,    0.7532094332,    0.8122585515,    0.7581105097,    1.4328913096,    5.4052716824,    3.1013602058,    12.3566950326,
    16.0510231066,    105.0669013266,    74.8481581796,    55.0399417406,    44.9374595089,    52.7909084428,    59.9886702142,    0.6193823208,    3.4358522106,    0.6523338469,
    0.2968063670,    0.3804047815,    12.4472819238,    12.9581501130,    38.1973144762,    77.1767473201,    86.7359256221,    0.2310190231,    0.2174278630,    0.2342574982,
    0.1993944113,    0.1607575222,    42.0768644514,    17.9985287575,    27.7382291201,    32.6825029089,    31.4730370281,    27.0750370215,    3.6916240314,    3.2336522432,
    40.1314683229,    7.3123556421,    21.3461118010,    18.2202445346,    23.2737770496,    26.3093249656,    14.6527179473,    113.3561356687,    79.2718266845,    92.2422845360,
    717.7270756920,    400.6546036470,    380.5519943680,    1.4289557787,    0.4354435740,    0.7210959595,    1.7992554505,    0.5297996035,    1.0607020106,    2.1014750433,
    1.2006097513,    1.1351065540,    1.3322872343,    1.2822233537,    2.0430524810,    2.1266217136,    1.3518694104,    20.9010923882,    12.4888034792,    11.8457668921,
    9.9398458784,    0.0081405707,    0.0107270126,    0.0152129221,    0.0118865816,    0.8552324954,    1.2574486167,    1.4771080164,    1.6811229780,    0.2530520825,
    0.1191164163,    1.1845746526,    1.3004070821,    1.5546882767,    9.8387796249,    9.9332406247,    0.0324922103,    0.1009109887,    0.0352617357,    0.0777165981,
    0.0428136134,    0.2063052532,    0.0719711059,    0.4171363674,    0.4245348934,    0.4436205450,    0.2773031390,    0.2323517703,    0.2224917176,    0.1570667260,
    0.1858810425,    0.2915870922,    0.4422938246,    0.3653932455,    0.1216908832,    0.3561880879,    0.3661840124,    0.1751019487,    0.2268107707,    0.2395093345,
    0.2898251591,    0.1604896672,    0.1692059550,    0.2287825552,    0.2012335620,    0.3255886931,    0.2686032101,    0.2711797789,    0.3260273442,    0.4630468333,
    0.5588943817,    0.4520803991,    0.5257967991,    0.6571529853,    0.4661445777,    0.4834617301,    0.3318025469,    0.4146282978,    0.3245790870,    0.2713581969,
    0.3436324805,    0.5792045316,    0.7259670689,    0.3013544555,    0.3659795405,    0.4861206052,    0.3574635124,    0.3730457650,    0.4305168031,    0.3515474822,
    0.7028889781,    0.3594691698,    0.5516778368,    0.7173083543,    0.8738261998,    0.3925415040,    0.5091733554,    0.3828130354,    0.2713828948,    0.3581133947,
    0.7893377170,    0.2277485684,    2.2720910967,    0.2841791776,    0.1735330977,    0.3058143845,    1.7442110027,    2.5683641281,    0.3154155145,    1.4183909043,
    0.2217484714,    0.6427651358,    116.6573308164,    0.6560730713,    92.9854376588,    3.4189971824,    3.0874449810,    13.7087540700,    0.9995197469,    0.1256432653,
    0.2578465894,    0.0604260139,    0.0895199111,    0.1669420131,    0.0599650172,    0.1296836745,    0.0990230829,    0.1465435227,    3.1627546576,    0.9779521380,
    0.0903943320,    0.3355091209,    0.8452273084,    1.2618212387,    0.8757057698,    0.6309649954,    0.1178735385,    0.3406422677,    0.0419344006,    0.0639804508,
    0.3479321670,    0.2782555374,    0.2010880308,    0.0906000770,    0.1859150492,    0.5091215647,    0.2440997159,    0.5226111225,    0.1634038993,    1.0000000000,
    0.9021090070,    0.9010542318,    0.7119289169,    0.0902951024,    1.1873376997,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    0.0541052237,    1.0000000000,    0.1539469756,    0.0764847908,    0.2090329687,    0.0592518478,    0.0541052237,    0.1129225168,
    0.4960056248,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.1953123293,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    0.1319748667,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.1680723326,    0.1840735595,    0.2131200950,    0.1870595395,
    0.1700384918,    0.2958213058,    0.1345493325,    0.0904782105,    0.1639305819,    0.5074602683,    0.7775996722,    0.2217514317,    0.3925811091,    0.0242250750,
    0.4454027770,    1.2720000327,    0.2423702800,    0.3925811091,    0.4484832532,    0.3335797188,    1.0452222449,    0.2258450336,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    2.8360508727,    0.9672736952,    5.6092773883,    0.7184537489,    1.2659967942,    6.3950851812,
    1.3852231487,    0.1914735126,    0.7921473133,    1.7121196403,    0.8575091136,    0.6355441326,    1.0000000000,    0.6143745010,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    0.2977619769,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.8689152815,    0.9881987985,    1.0041927285,
    0.5255626686,    0.4853668712,    0.6508924818,    0.3251917516,    0.1529069140,    0.1305201419,    0.6217940569,    7.1174110757,    1.9828440842,    3.2484406614,
    0.1945839970,    2.1207518539,    0.4150425232,    0.4609579488,    0.1067266411,    0.9699871027,    0.5657920360,    0.5854558013,    0.4985860694,    0.6372444052,
    2.1681514465,    0.0659852623,    7.4890015840,    0.0308195025,    0.2917971704,    2.2228976475,    0.3192664721,    0.1150132818,    0.0189733633,    0.0326590588,
    0.1532483486,    0.1817857776,    0.0441684839,    3.9462401915,    0.3158109795,    0.5204873919,    0.6741523395,    0.7735739711,    0.9082287748,    25.5959302982,
    63.7469555874,    0.1136726343,    0.1599413857,    0.1554182159,    0.1511868846,    0.1588115356,    0.1479212632,    0.1485943329,    0.9860367657,    0.7530478263,
    8.8250907251,    1.7308552922,    1.8637357268,    8.5090519133,    6.0669321387,    0.2550060268,    0.1089760185,    2.3884755644,    0.2390194562,    3.2498425480,
    2.2686631289,    1.1439006448,    9.3113311544,    0.0416145755,    0.0304533995,    0.0195242154,    0.0103494591,    0.1860903684,    11.1734152202,    2.1090885854,
    0.4504599342,    0.5468830426,    2.8187961839,    1.6143618233,    0.3110666780,    0.2811274206,    0.1601268246,    0.4558095946,    0.3455635768,    1.5967105831,
    0.7588037676,    0.1122269226,    3.7686456745,    0.3517271907,    0.1960833028,    2.2760069497,    0.4690664896,    0.5848443771,    0.6608072833,    4.7316523648,
    1.0560727868,    0.2103538499,    0.6096542447,    1.1569162417,    0.1207913022,    0.5713579298,    2.2164031745,    0.1655771489,    0.1698883689,    5.2317871719,
    0.0870362920,    0.6556127343,    60.4094908348,    3.0263933567,    0.6460292493,    0.4139087559,    0.2720032988,    0.0831419801,    0.5113583582,    0.3386899296,
    0.1389196344,    1.6709704305,    5.8371632473,    5.1037178355,    4.7813433047,    110.4834303774,    28.0542186858,    2.6938001239,    2.2956607150,    2.1732479453,
    0.6556127343,    0.6460292493,    3.0263933567,    0.4139087559,    0.5113583582,    0.3386899296,    0.2720032988,    0.0831419801,    60.4094908348,    3.1575834600,
    1.7934127569,    66.1310332944,    1.2992598131,    0.9756653425,    0.5217745917,    0.6673891529,    0.2459771838,    24511.9351508800,    1.5576006711,    14.0238423155,
    1.1843140366,    1.0673830731,    0.5951224734,    0.6945619382,    0.9752354882,    276.8467246216,    8.3607073675,    1.0176385257,    1.0571346715,    0.5416241391,
    0.8489026392,    1.0032775586,    152.6214600468,    6.1612258179,    5.4865555075,    3.1597265321,    3.6615067957,    4.5997263755,    1240.2175303751,    0.6389195528,
    0.6863333819,    0.5081097527,    0.6121094162,    104.6431182617,    0.4578832549,    0.7078483842,    0.7935993528,    101.2198090385,    0.4464577350,    0.5089935196,
    51.8052525983,    0.4428329525,    66.6374464791,    91.0659511692,    3.3024937111,    23.6949778268,    77.2002346236,    0.0421965531,    83.8296197313,    22.0707229150,
    15.1023727087,    0.2967306461,    0.4051132968,    0.3137994104,    0.5825358186
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 501;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    0,    15,    24,    27,    64,    66,    67,    75,    76,    77,    81,    82,    83,    84,    85,    86,    87,    89,    96,    97,
    100,    111,    122,    138,    173,    179,    182,    183,    291,    293,    294,    295,    296,    297,    299,    302,    303,    304,    305,    306,
    307,    309,    312,    314,    315,    316,    318,    331,    332,    334,    335,    336,    338,    339,    341,    344,    345,    348,    349,    352,
    357,    358,    359,    361,    362,    367,    368,    374,    375,    376,    379,    380,    382,    383,    384,    388,    389,    390,    391,    393,
    396,    419,    421,    422,    438,    508,    511,    516,    534,    535,    543,    544,    545,    548,    561,    563,    564,    581,    582,    603,
    646,    647,    653,    656,    658,    659,    661,    665,    668,    670,    673,    681,    682,    683,    687,    689,    693,    697,    702,    706,
    724,    727,    732,    734,    736,    738,    739,    742,    744,    745,    746,    748,    750,    751,    753,    754,    755,    756,    760,    761,
    768,    769,    770,    771,    772,    773,    775,    780,    782,    787,    795,    798,    800,    804,    805,    810,    813,    814,    815,    822,
    824,    825,    826,    827,    833,    834,    838,    840,    842,    843,    845,    852,    853,    855,    857,    859,    861,    862,    863,    867,
    870,    879,    880,    886,    888,    903,    914,    921,    922,    927,    931,    939,    941,    949,    950,    951,    957,    958,    960,    974,
    975,    984,    987,    996,    1005,    1010,    1011,    1013,    1014,    1015,    1016,    1021,    1029,    1030,    1038,    1042,    1044,    1049,    1053,    1056,
    1057,    1062,    1064,    1065,    1070,    1077,    1078,    1079,    1085,    1086,    1087,    1089,    1091,    1103,    1104,    1105,    1109,    1110,    1111,    1117,
    1121,    1125,    1128,    1129,    1130,    1133,    1137,    1141,    1142,    1143,    1152,    1154,    1155,    1156,    1158,    1160,    1161,    1162,    1163,    1171,
    1172,    1173,    1200,    1232,    1254,    1256,    1258,    1281,    1282,    1289,    1291,    1302,    1303,    1304,    1333,    1349,    1353,    1408,    1410,    1411,
    1412,    1413,    1414,    1415,    1416,    1417,    1418,    1419,    1420,    1421,    1422,    1423,    1424,    1425,    1426,    1427,    1428,    1429,    1430,    1431,
    1432,    1433,    1434,    1435,    1436,    1437,    1438,    1439,    1440,    1441,    1442,    1443,    1444,    1445,    1446,    1447,    1448,    1449,    1450,    1451,
    1452,    1453,    1454,    1455,    1456,    1457,    1458,    1459,    1460,    1461,    1462,    1463,    1464,    1465,    1466,    1467,    1468,    1469,    1470,    1471,
    1472,    1473,    1474,    1475,    1476,    1477,    1478,    1479,    1480,    1481,    1482,    1483,    1484,    1485,    1486,    1487,    1488,    1489,    1490,    1491,
    1492,    1493,    1494,    1495,    1496,    1497,    1498,    1499,    1500,    1501,    1502,    1503,    1504,    1505,    1506,    1507,    1508,    1509,    1510,    1511,
    1512,    1513,    1514,    1520,    1523,    1527,    1567,    1569,    1570,    1571,    1572,    1573,    1574,    1575,    1576,    1577,    1578,    1579,    1580,    1581,
    1582,    1583,    1584,    1585,    1586,    1587,    1588,    1589,    1590,    1591,    1592,    1593,    1615,    1628,    1688,    1708,    1710,    1712,    1717,    1725,
    1739,    1808,    1809,    1816,    1818,    1819,    1826,    1828,    1832,    1834,    1839,    1840,    1841,    1844,    1845,    1855,    1857,    1858,    1859,    1861,
    1865,    1866,    1867,    1868,    1869,    1870,    1874,    1876,    1879,    1883,    1887,    1957,    1958,    1960,    1961,    1970,    1976,    1981,    1982,    1983,
    1985,    1999,    2009,    2163,    2167,    2168,    2169,    2174,    2201,    2208,    2241,    2248,    2249,    2251,    2261,    2268,    2271,    2275,    2345,    2359,
    2409,    2502,    2707,    3074,    3075,    3399,    3766,    3768,    3769,    3774,    3785,    3796,    3803,    3829,    3838,    3848,    3867,    3868,    4013,    4041,
    4072
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 19;
constexpr int N_PHYSICS_FEATURES = 65;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
    "dD",
    "dH",
    "dP",
    "HansenTotal",
    "BP",
    "deltaHvap",
    "logVP",
    "logPow",
    "logWS",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/deltahf_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/deltahf_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadedeltaHf
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadedeltaHf {
struct Model {
    using Namespace = CascadedeltaHf;
};
} // namespace CascadedeltaHf
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
