#pragma once
// Auto-generated Treelite model for deltaHvap (v3.4 XGBoost)
// Trees: 300, Features: 581
// Target normalization: mean=62.6766581280, scale=36.9767033459
// Library: deltahvap_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadedeltaHvap {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 581;
constexpr double TARGET_MEAN = 62.6766581280;
constexpr double TARGET_SCALE = 36.9767033459;

// Normalization stats
constexpr int N_NORM_FEATURES = 581;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0026501767,    0.1501766784,    0.0830388693,    1.6479681979,    4.0030918728,    0.4390459364,    0.0061837456,    0.1841872792,    0.2318904594,    0.0410777385,
    0.0198763251,    0.0119257951,    1.5397526502,    0.0605123675,    0.0039752650,    0.0030918728,    0.0119257951,    1.1024734982,    0.2164310954,    0.2102473498,
    4.5022084806,    0.1810954064,    3.6744699647,    0.5463780919,    0.4876325088,    0.6994881797,    0.1750031110,    0.4746664698,    160.2842186396,    160.0508150773,
    0.1151106829,    -0.2723586506,    0.2815520041,    0.1213599223,    1.1424606097,    1.6273557819,    1.9189120238,    22.2680827983,    1.9773117879,    -1.9938991079,
    2.0711139781,    -1.9368932660,    5.6896269517,    0.4123643840,    1.8844367543,    2.9089505809,    143.4516006686,    8.1572059870,    4.2956388196,    3.1562718819,
    41124827635.6804199219,    5.6506473613,    13.5257498592,    1.3603818288,    32.7259645413,    14.7305085528,    4.4284143882,    0.8579512222,    8.9418857225,    0.9077493110,
    15.7235998233,    3.2384637844,    2.8881862132,    5.9600348914,    14.3970408304,    3.7833479470,    2.2218514160,    0.2672261484,    45.7320776060,    0.0521201413,
    6.8605398191,    12.6613212145,    4.1604013196,    0.3105323535,    8.4276897596,    15.4213780919,    105.1035985207,    95.6775362930,    50.9906022578,    113.4430212014,
    102.9169611307,    48.9783568905,    39.5671378092,    64.9003016555,    117.2462523607,    144.3275137077,    80.1089017229,    603.4377208481,    691.1501766784,    550.7981448763,
    960.4157348516,    352.1540407968,    342.8301054770,    62.0380746025,    8155.1913788649,    4.9996446862,    2.0872383387,    1.2178809750,    0.3387204178,    2.3800998388,
    1.6476641438,    1.1595953617,    2.1487040352,    0.9891616803,    15.3288171321,    178.3970232019,    113.6403764260,    73.0825874512,    39.1157561109,    7.2696213839,
    4.4836340968,    5.9487457418,    5.6955838229,    4.5111851428,    3.4203629587,    5.9815277304,    1.3874153322,    0.8329072645,    146.5068444597,    158.1050353032,
    164.1154620668,    157.9863800909,    107.5453220315,    0.2584604258,    -0.1130772036,    -0.0079592079,    -0.0040691042,    -0.0105326980,    -0.0035509566,    -0.0032536384,
    0.0009599183,    13.8184527898,    -13.6698690792,    -7.8389631189,    -1.6932107551,    -0.6910968650,    0.5468148250,    9.9111022999,    -2.0465511088,    3.2582437411,
    -3.4910130394,    -0.6781502778,    -0.9710407804,    -0.2777976715,    271.9421481831,    -50.8661192481,    -14.6196038280,    -153.1255604778,    -250.3277831893,    1291.6549825171,
    -60.9868664406,    -121.0666559289,    33.8738341100,    -0.0455579543,    -0.1587323700,    -0.0180827887,    2.1312595766,    -0.0232601391,    2.1362362954,    -0.3677044016,
    -0.3595038724,    -1.2279438003,    0.1486430503,    -0.0117653210,    0.2013661361,    -3.0300506279,    -3.0429930349,    0.0123490356,    -0.0056791260,    0.0000770095,
    0.0003577125,    0.0001898097,    0.0003122941,    0.5944446531,    -0.1145016663,    -0.4555543535,    -0.3984261939,    0.1451275982,    -0.0609823161,    0.0201862431,
    -0.1318350022,    0.0756403042,    14.8329013573,    -1.6722586874,    -1.3555941670,    49.4311004238,    -0.0078669728,    -0.0060468522,    0.0028346337,    -0.0122234837,
    -0.0096212042,    -0.0008729207,    0.0018935985,    -0.0120166673,    0.2786923971,    -0.0180514101,    -0.1494130870,    -0.1905651901,    0.1316701845,    0.0943669236,
    -0.3395108392,    -0.0373535919,    -0.2056572035,    -0.1411015361,    0.0692498969,    -0.0565120789,    0.0279155115,    -0.0498825699,    -0.0223692174,    0.0391143037,
    0.0030899434,    -0.1101112222,    -0.0881091290,    -0.0818602051,    -0.0552189741,    1.3940343364,    1.0389033124,    0.9375032379,    0.6617261230,    0.5358009937,
    0.3650563355,    0.8711489502,    1.2403653788,    0.9958442159,    0.6549826178,    0.3282100752,    1.2709543559,    1.6030932196,    0.8366463118,    0.4689299062,
    0.3262640597,    0.2501183523,    0.7946903587,    1.0054155027,    0.7840158655,    1.0086937974,    0.7035752111,    0.3614841281,    1.0743983257,    0.9220110372,
    1.2764895907,    0.9427559582,    0.8239160175,    0.9558317895,    1.1036150737,    0.9680292200,    1.1054593728,    0.9658368438,    0.9540648550,    1.3254441027,
    1.1428660264,    0.9347871678,    0.3216778609,    1.4226396542,    1.0780157698,    0.7546418119,    4.9267931524,    1.1230831107,    3.0587812370,    1.0261163946,
    4.7102555370,    1.2640760574,    10.4195506700,    5.7763067426,    21.6184053926,    11.7892341950,    21.5528278535,    16.7055380083,    3.4670838212,    2.5157438136,
    3.2684706063,    2.3179570213,    3.2702943365,    2.2642519852,    2.0990675036,    1.0081451379,    13.3551416858,    10.9806573195,    2.6491987050,    78.3709713249,
    39.4256887065,    60.5315735853,    78.7105878162,    39.4086220801,    0.5716156184,    3.1189913458,    0.3280545282,    1.0567332786,    40.3794218522,    3.2635608904,
    3.3391339209,    86.6972624298,    43.0760476135,    65.8788735320,    86.3060475152,    5.9015124248,    43.0777106129,    -0.5419207651,    3.1181290325,    0.3281749538,
    1.0567098491,    40.5249768125,    3.2727033405,    3.3404395495,    79.3745923850,    39.8770783488,    61.1740410171,    79.6812060522,    5.3360945964,    39.8796013650,
    0.3886861243,    3.1198631785,    0.3283326708,    1.0572468811,    40.3936070647,    3.2628191449,    3.3380288548,    79.2520064220,    39.8256284465,    61.1079208016,
    79.5753528997,    5.3281412424,    39.8281471419,    0.4091368562,    3.1198956680,    0.3283328327,    1.0572533069,    40.3868514689,    3.2623801319,    3.3379266481,
    79.0607469288,    39.7378896476,    60.9816956022,    79.3990610263,    5.3166632166,    0.3237008452,    0.3695892036,    0.2097624836,    0.0180322726,    1.0580751176,
    0.5228962235,    0.5252343341,    0.2494423616,    0.6611797544,    0.1112745511,    0.0088339223,    0.2822438163,    1.2579505300,    0.4390459364,    0.0061837456,
    0.0379858657,    0.3590989399,    0.5026501767,    0.1139575972,    0.2318904594,    0.0000000000,    0.0348939929,    0.0000000000,    0.0004416961,    0.0318021201,
    0.0026501767,    0.0185512367,    0.0000000000,    0.0092756184,    0.0485865724,    0.0291519435,    0.0154593640,    0.0066254417,    0.0000000000,    0.1841872792,
    0.3431978799,    0.3140459364,    0.0000000000,    0.0000000000,    0.0000000000,    0.0004416961,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0410777385,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0198763251,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0092756184,    0.1636904663,    1.5921918148,    0.3378957204,    0.6162367807,    0.7691499689,
    0.1463911977,    0.2910139199,    0.7089964047,    0.5669769303,    0.0189542411,    1.1063123367,    0.8443465612,    0.2855885154,    159.2990282686,    0.3151461378,
    5.6030256184,    0.5190021903,    0.0094332961,    0.8319284371,    3.7251265003,    0.3278278781,    0.0166944006,    -0.2431867874,    -2.7456250152,    1.8238709755,
    3.0758504107,    3.2715393907,    44.3586338666,    89.5112723247,    0.2865424905,    0.4262723042,    0.6098194120,    0.7008871509,    0.7349040126,    0.6886274729,
    0.7222545407,    3.2614370388,    1.2423603472,    19.6921098605,    24.6578904327,    25.2008453299,    25.0802784797,    32.9343331812,    25.0320720256,    7.2199187738,
    0.0473365639,    0.0041961131,    0.3802965582,    0.0462916403,    1.5605954782,    0.4001766784,    0.0004416961,    0.0008833922,    0.3288124546,    17.1301722615,
    0.0763498426,    0.0433860783,    0.0290573982,    0.0006193882,    0.7928679557,    5.7822770955,    6.7540420474,    0.4100698050,    0.0263958211,    3.2445069904,
    0.8126770634,    0.3652278269,    0.5406360424,    0.4994781051,    0.0765998323,    0.0271663562,    1.6347488078,    0.0213925730,    0.0157214472,    0.0077341050,
    4.8396470807,    0.3237748624,    0.1496821150,    0.1137491832,    0.1001137901,    0.2382548634,    0.0588655463,    2.8186891981,    0.0930362191,    0.3740454947,
    0.3661130742,    0.6106342756,    5.0146837456,    7.5021445144,    5.4959227383,    0.7537348397,    0.6669663532,    4.5307112951,    4.8322035099,    0.0257119359,
    4.3848576156,    1.3957249410,    1994.1406846290,    0.5941821893,    1.6546609580,    3.3790927104,    3.6108488428,    0.6721286381,    2.2815530572,    0.0132508834,
    0.0949646643,    1.3716204605,    121.2876833909,    5.0305324987,    0.4233403126,    0.3888426630,    0.9803359838,    1.4512999197,    0.6050575829,    0.0945943209,
    0.3648782430,    18.5845584452,    16.6313955947,    5.1329133762,    4.6789074835,    183.7202871585,    1.3716204605,    0.4233403126,    5.0305324987,    0.3888426630,
    0.6050575829,    0.0945943209,    0.9803359838,    1.4512999197,    121.2876833909,    2.5654405505,    0.4406244184,    34.5460574038,    0.2388693068,    0.5380075664,
    0.0464762014,    1.0352411425,    2.1114121573,    19695.9220408360,    0.5509464316,    9.2711857150,    0.5382336579,    0.8007875188,    0.1214093943,    1.3091655121,
    1.9958648771,    224.1421611593,    2.4897099538,    0.1774489452,    0.4039158869,    0.0441121905,    0.4626814052,    0.6448599025,    53.4131778664,    2.0463446780,
    3.2848201035,    0.4764223238,    4.8908734537,    7.3753305286,    818.3547660282,    0.2978813764,    0.0548304146,    0.3784243568,    0.5661592673,    47.3383273731,
    0.0739738571,    0.6310949164,    0.8968732409,    73.1012201129,    0.0958246703,    0.1384936113,    10.5439399921,    1.4289441853,    116.6168397279,    177.0254398222,
    4.2480361876,    45.7320776060,    168.3169951940,    0.2684558960,    170.1406782347,    45.2446319658,    30.3219208477,    1.3571516795,    1.8588369870,    1.4398489388,
    2.7161910526
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.0593847242,    0.4069514829,    0.4184296175,    1.4042512834,    6.2487800349,    0.7599715040,    0.1027738683,    0.4369191776,    0.9178388902,    0.2407106036,
    0.1602030036,    0.1272813089,    2.4892367476,    0.4481557249,    0.0695906209,    0.0629738465,    0.1125476019,    10.2845605008,    0.4928592407,    0.6518261455,
    6.6928442933,    0.5479446350,    6.6788087281,    2.0627448244,    1.0968259922,    0.7671747707,    1.3608462510,    0.1182050174,    89.9561973673,    89.8504325910,
    0.1416546107,    0.1577831057,    0.1601932853,    0.1128254876,    0.4268755670,    0.5356160702,    0.5867259548,    18.8132750939,    0.2281529196,    0.1866279068,
    0.2193379509,    0.2393569933,    1.5452677913,    0.5749679022,    0.4025066900,    0.5974609933,    141.1498383505,    4.4996487733,    2.9630520725,    2.1754123981,
    1299444511571.6420898438,    6.0153576690,    219.8066486788,    3.0984333690,    39.7849264109,    10.9910139030,    5.8443937355,    3.0070976715,    9.8780855580,    4.5154448359,
    17.1865926636,    8.6836607443,    6.2051118475,    9.9346558023,    15.2297844299,    6.0105609560,    4.2749459256,    0.5247110008,    27.3127820438,    0.2394872904,
    3.1785825011,    7.9344317209,    0.4034001388,    0.0790927090,    57.2672357282,    12.6601752625,    112.1166723447,    253.6769791413,    216.3557886270,    83.1515673284,
    103.1276533842,    95.1675756991,    91.5081910327,    35.9306534737,    117.5094557408,    230.4365775155,    184.5337857616,    577.8501237829,    611.1898813679,    601.1318552526,
    1918.6683257855,    391.8410018640,    293.5765835625,    45.9073364842,    9129.9468982200,    5.4301847336,    4.4080508464,    4.6027322645,    2.7040655782,    0.7009310507,
    0.5457633261,    0.6935214025,    5.4882534377,    3.1812476013,    21.5253852443,    52.5688360414,    46.2923966443,    52.9114659162,    50.3311012942,    1.5829004599,
    3.5384892895,    1.2363170647,    1.4807495279,    2.4697963392,    2.7470416286,    1.1883551319,    0.5244956715,    0.3874867316,    5.9231463394,    11.4754849503,
    31.2492958113,    48.2332495262,    84.1842100379,    0.2794689639,    0.1445205701,    0.1278051001,    0.1095200293,    0.1075524810,    0.0951622336,    0.0450963302,
    0.0443535031,    13.9306491886,    24.9965781981,    26.6049384937,    22.4701986216,    18.0860167459,    17.9685839297,    6.8351373428,    3.8388033744,    16.9433825827,
    14.7824531004,    12.1819012745,    8.0190737151,    6.0004626009,    378.2387847209,    112.5972898726,    159.8437759567,    595.4112938799,    598.7899718083,    909.9736849735,
    74.9743727735,    403.8129446867,    387.7081476748,    0.2056875225,    0.6808620899,    0.3651286015,    1.7854754445,    0.8628550625,    2.1560502418,    0.9846015357,
    1.1992657307,    2.6577401174,    1.7528226219,    1.4886474732,    1.2360286197,    4.8845494027,    12.3474414323,    0.0135724032,    0.0083129396,    0.0049067652,
    0.0066384088,    0.0056644789,    0.0043818847,    0.6296544911,    0.6755416947,    0.8654078479,    1.0732783545,    0.9351646658,    0.0934023765,    0.1256074692,
    0.3682499341,    0.6901503248,    35.4912673066,    5.9633932869,    10.4525020605,    9.0985239295,    0.0340102251,    0.0425961764,    0.0336852655,    0.0523285692,
    0.0634007204,    0.0444062053,    0.0335135759,    0.0452729689,    0.2441113693,    0.1139587818,    0.3840645740,    0.4346491708,    0.5945146731,    0.3962030782,
    0.2372782901,    0.3180394730,    0.1344389370,    0.1579026696,    0.2263266969,    0.3104026427,    0.2254559540,    0.3363154281,    0.0834169374,    0.3674310455,
    0.1882403677,    0.1805264800,    0.2370843047,    0.1400505064,    0.2102003862,    0.2956124277,    0.3291768929,    0.4009290845,    0.6600845571,    0.7507712548,
    0.5913774054,    0.3931200780,    0.4324038983,    0.4541772899,    0.7070808969,    0.5462069840,    0.3642007843,    0.4847176860,    0.4275716107,    0.5089092290,
    0.4555746339,    0.4210904729,    0.3207301674,    0.7701481499,    0.9675721260,    0.3831050408,    0.6937350889,    0.6009746002,    0.3319488348,    0.5509405655,
    0.2937744137,    0.3145547812,    0.4576979870,    0.3542487636,    0.3998109568,    0.3127645045,    0.3590151562,    0.3332259575,    0.6746139682,    0.3718575878,
    0.2516857642,    0.3603622265,    0.5067918195,    0.3335613577,    0.3107599691,    0.4327584951,    1.3503312939,    0.6065780549,    0.5420169205,    0.1904552823,
    2.2698379491,    0.2219404374,    8.0099297848,    0.0837315627,    19.0991887905,    0.1138456900,    1.9787946250,    2.7459479918,    0.3304565380,    0.0628603697,
    0.3507543378,    0.0648218814,    0.4158634574,    0.0675002510,    0.5510218445,    0.3320174000,    1.5503708635,    0.2006363636,    0.6563378663,    169.0779459084,
    84.5528685287,    130.8889294213,    169.1169931062,    84.5424097212,    0.8731372392,    0.7858033277,    0.0729397628,    0.6946299678,    44.1776603207,    0.9558778775,
    1.2040468220,    173.5342366538,    86.6822422275,    133.3547032965,    173.3567473876,    4.0993781670,    86.6814675073,    1.1144013599,    0.7842397346,    0.0738809833,
    0.6931964884,    44.2776653601,    0.9688773893,    1.2102432235,    169.0033157085,    84.5268876182,    130.8352832991,    169.0650342249,    4.0416335034,    84.5257765350,
    0.6443950495,    0.7843265360,    0.0737915358,    0.6933643897,    44.1953011950,    0.9610193985,    1.2082959505,    168.9178702543,    84.4872949806,    130.7918630348,
    168.9860365086,    4.0422113020,    84.4861872377,    0.7257301135,    0.7843614708,    0.0737785977,    0.6933857212,    44.1862463336,    0.9606164540,    1.2081715468,
    168.7439724977,    84.4046046054,    130.6931561759,    168.8198808077,    4.0382254950,    0.6961782373,    0.1919955068,    0.1286778759,    0.0782085008,    2.0807465601,
    0.7006254680,    1.1107703974,    0.0693437651,    0.8470403425,    0.1021759444,    0.0981798162,    0.7098020806,    2.4822120615,    0.7599715040,    0.0783932833,
    0.2384553647,    0.6051357650,    1.0989040676,    0.7324504288,    0.9178388902,    1.0000000000,    0.2104212653,    1.0000000000,    0.0210119256,    0.1945710233,
    0.0514116061,    0.1381683053,    1.0000000000,    0.1127969423,    0.2696807079,    0.1857036705,    0.1579167075,    0.0811267232,    1.0000000000,    0.4369191776,
    0.5656289095,    0.6809216561,    1.0000000000,    1.0000000000,    1.0000000000,    0.0210119256,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.2407106036,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.1602030036,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.0958623037,    0.8225211748,    3.7619612733,    1.8624968772,    2.6696513574,    0.6404142561,
    0.7523911612,    1.5317481625,    1.7007097182,    0.5656144575,    0.3996666201,    2.0334078863,    2.5727196102,    1.5885760774,    343.5841501985,    0.1999319582,
    3.4036398864,    0.0650230622,    0.0320559121,    0.3132544088,    5.4011772224,    0.2924109019,    0.0377132799,    0.2996736247,    2.4540654301,    0.3941028965,
    0.6232221702,    0.8017339749,    22.4961443071,    66.4107237535,    0.1058291190,    0.1368676804,    0.1544346425,    0.1526616616,    0.1587924526,    0.1436767143,
    0.1498755645,    0.9346583191,    0.8281577013,    8.5541516359,    9.2108222925,    9.2983061615,    9.5836002515,    22.2888043044,    17.9099810240,    11.7647010091,
    0.2165793179,    0.0532448436,    1.0178894402,    0.1229970870,    2.0676349393,    0.7434757242,    0.0210119256,    0.0297087840,    0.2851197502,    18.4690136956,
    0.0437648707,    0.0330185946,    0.0293399888,    0.0018861428,    0.2430977715,    0.8132537689,    0.8636516581,    0.9752993773,    0.0990187246,    2.3592455054,
    0.7119555681,    0.4151053898,    0.7250750796,    1.2596468922,    0.4006575783,    0.1978216345,    3.5766355689,    0.1548557027,    0.2209042703,    0.1979503920,
    6.3041575649,    0.6402952855,    0.4530674991,    0.2971376105,    0.4059733829,    0.4548179129,    0.3187274544,    2.9452425768,    0.1914344598,    0.3210484208,
    0.3230054788,    0.4086472714,    3.0600066133,    2.0522285737,    1.4479748833,    0.2291849201,    0.4531172058,    44.8811689976,    0.7106087642,    0.0327176058,
    2.9806133481,    0.1122175571,    9873.9655222973,    0.2549956354,    1.1532316842,    31.4471388859,    0.6750681597,    0.5665260115,    0.2075813862,    0.1288753909,
    0.3273343707,    0.8271020873,    70.6060896701,    3.0397039631,    0.5112801562,    0.2960923677,    0.2723646478,    0.0716986785,    0.4146237906,    0.1937217486,
    0.1332834877,    2.9536339250,    1.5469627523,    3.8164432601,    3.4150239182,    105.9841417485,    0.8271020873,    0.5112801562,    3.0397039631,    0.2960923677,
    0.4146237906,    0.1937217486,    0.2723646478,    0.0716986785,    70.6060896701,    5.0327094906,    1.1739707079,    64.7032330333,    0.3375854405,    0.6434502552,
    0.1322644072,    0.7776326929,    0.2121056551,    34831.9755014365,    0.8651026436,    17.8921833923,    0.6507524741,    0.8013028277,    0.2968768708,    0.7571723833,
    1.2067784034,    417.2084673711,    4.4829741610,    0.2567191319,    0.7337116340,    0.1208643888,    0.6862466424,    0.8131957540,    89.8244056956,    2.4532641242,
    3.5667210818,    1.1330149502,    3.0224007679,    4.5452061199,    1490.3616562910,    0.3448145649,    0.1319690190,    0.2979705017,    0.4318384583,    56.2711479807,
    0.1879646972,    0.5314599328,    0.6415996860,    75.1077090287,    0.2069320470,    0.2850090369,    25.3607857215,    0.4369967317,    67.0392851319,    104.2027729454,
    3.6428696103,    27.3127820438,    98.3120619291,    0.0363827851,    100.1833858211,    26.8351489533,    17.6515224175,    0.2797733243,    0.3723461080,    0.2884180551,
    0.5410235389
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 501;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    12,    15,    26,    66,    67,    78,    79,    82,    89,    98,    99,    102,    111,    130,    135,    149,    150,    160,    181,    183,
    215,    217,    218,    220,    233,    293,    294,    295,    297,    299,    302,    303,    304,    305,    306,    307,    308,    309,    311,    312,
    313,    314,    315,    316,    317,    318,    319,    320,    325,    327,    333,    335,    336,    339,    348,    349,    350,    361,    366,    372,
    374,    376,    382,    383,    384,    388,    389,    410,    422,    475,    509,    512,    514,    519,    522,    531,    543,    546,    548,    554,
    556,    559,    560,    562,    563,    564,    567,    570,    573,    574,    585,    602,    618,    626,    638,    642,    645,    647,    650,    651,
    655,    657,    666,    668,    672,    689,    691,    693,    695,    700,    703,    708,    709,    711,    712,    714,    725,    728,    733,    734,
    736,    737,    739,    741,    742,    743,    744,    745,    746,    748,    749,    751,    754,    755,    756,    757,    758,    759,    769,    770,
    773,    774,    775,    776,    777,    780,    787,    788,    789,    795,    796,    799,    801,    805,    809,    812,    813,    819,    822,    825,
    826,    833,    837,    838,    839,    841,    844,    849,    850,    854,    855,    856,    857,    859,    860,    861,    862,    866,    870,    872,
    877,    878,    885,    888,    889,    903,    916,    917,    923,    925,    926,    928,    929,    933,    939,    943,    950,    951,    954,    955,
    957,    969,    974,    975,    978,    985,    988,    993,    997,    1003,    1014,    1015,    1032,    1037,    1040,    1053,    1054,    1056,    1058,    1059,
    1060,    1061,    1062,    1064,    1066,    1068,    1069,    1070,    1072,    1074,    1075,    1076,    1078,    1081,    1082,    1088,    1090,    1092,    1093,    1097,
    1101,    1104,    1105,    1109,    1111,    1118,    1119,    1126,    1129,    1133,    1134,    1136,    1140,    1141,    1143,    1145,    1151,    1152,    1153,    1154,
    1155,    1156,    1157,    1158,    1159,    1160,    1161,    1162,    1163,    1164,    1165,    1166,    1167,    1168,    1169,    1170,    1171,    1172,    1173,    1174,
    1175,    1176,    1190,    1192,    1193,    1194,    1195,    1196,    1197,    1198,    1199,    1200,    1201,    1202,    1203,    1204,    1205,    1206,    1207,    1208,
    1209,    1210,    1211,    1212,    1213,    1214,    1215,    1216,    1217,    1218,    1219,    1220,    1221,    1222,    1223,    1224,    1225,    1226,    1227,    1228,
    1229,    1230,    1231,    1232,    1233,    1234,    1235,    1236,    1237,    1238,    1239,    1240,    1241,    1242,    1243,    1271,    1288,    1289,    1303,    1319,
    1322,    1324,    1336,    1346,    1353,    1408,    1409,    1410,    1411,    1412,    1413,    1414,    1415,    1416,    1417,    1418,    1419,    1420,    1421,    1422,
    1423,    1424,    1425,    1426,    1427,    1428,    1429,    1430,    1431,    1432,    1433,    1434,    1456,    1457,    1458,    1459,    1460,    1461,    1462,    1463,
    1464,    1465,    1466,    1467,    1468,    1469,    1470,    1471,    1472,    1473,    1474,    1475,    1476,    1477,    1497,    1512,    1533,    1591,    1595,    1609,
    1629,    1692,    1694,    1710,    1717,    1737,    1791,    1792,    1803,    1806,    1811,    1812,    1816,    1818,    1825,    1826,    1843,    1845,    1853,    1855,
    1857,    1859,    1861,    1865,    1866,    1867,    1868,    1869,    1871,    1875,    1877,    1878,    1882,    1885,    1887,    1888,    1889,    1891,    1894,    1960,
    1966,    1973,    1981,    1982,    1983,    2014,    2039,    2090,    2149,    2153,    2165,    2166,    2167,    2173,    2177,    2185,    2198,    2237,    2250,    2254,
    2274,    2275,    2303,    2344,    2377,    2378,    2405,    2414,    2445,    2528,    2669,    3038,    3040,    3076,    3406,    3439,    3502,    3764,    3765,    3766,
    3767,    3768,    3770,    3783,    3785,    3796,    3800,    3802,    3803,    3807,    3824,    3838,    3839,    3842,    3846,    3847,    3848,    3866,    3868,    4010,
    4023
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 15;
constexpr int N_PHYSICS_FEATURES = 65;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
    "HansenTotal",
    "dD",
    "dH",
    "dP",
    "BP",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/deltahvap_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/deltahvap_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadedeltaHvap
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadedeltaHvap {
struct Model {
    using Namespace = CascadedeltaHvap;
};
} // namespace CascadedeltaHvap
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
