#pragma once
// Auto-generated Treelite model for dH (v3.4 XGBoost)
// Trees: 300, Features: 604
// Target normalization: mean=5.9269525249, scale=4.3687857877
// Library: dh_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadedH {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 604;
constexpr double TARGET_MEAN = 5.9269525249;
constexpr double TARGET_SCALE = 4.3687857877;

// Normalization stats
constexpr int N_NORM_FEATURES = 604;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0210300970,    0.0031482181,    0.2332199975,    0.0635940058,    0.0254376023,    0.0052890064,    0.0045334341,    0.1059060572,    0.0293413928,    0.0366452588,
    0.0151114469,    0.0152373756,    0.0287117491,    1.6903412668,    3.0379045460,    0.0255635310,    0.6638962347,    0.0074297947,    0.3741342400,    0.0787054527,
    0.0214078831,    0.5521974562,    0.0123410150,    0.4008311296,    0.1133358519,    0.1009948369,    1.9783402594,    1.4532174789,    0.0002518574,    0.0776980229,
    0.0041556479,    0.0633421483,    0.0123410150,    0.4454098980,    3.9688956051,    0.2279309911,    8.2553378339,    0.5542881401,    -0.3461563449,    0.5156439006,
    15.2176896507,    185.1291647148,    184.8261450675,    0.1723958015,    -0.3211904100,    0.1660862798,    1.1919419812,    23.4881710977,    10.1997951967,    2.0800792506,
    -2.0528056144,    2.1425281833,    -2.0375781990,    5.9322633222,    0.2604941892,    2.0012236111,    2.9148943424,    3.5168518899,    1.4049125635,    -0.6559816144,
    8.5190060350,    76.2619463038,    4.5473354379,    0.6222088548,    2.3073878397,    1.3532132987,    26.6240155202,    18.8746660577,    5.5529324594,    9.6146865859,
    3.0748555696,    30.3249885645,    4.5746413652,    4.3616736621,    28.2386254936,    25.3907366830,    5.6556887860,    4.7489536896,    13.7106537598,    9.0688002585,
    6.0144064228,    0.8510384257,    -0.3358275501,    3.1657165648,    3.6736415903,    0.1741875447,    0.6155096127,    0.4567434832,    2.6737521937,    49.4834324644,
    0.1472106788,    0.0100742979,    0.0668681526,    2.1882519688,    170951.8097496803,    14.5159299836,    124.2019359512,    94.0988760006,    148.2176620737,    183.3265011909,
    788.4051127062,    6541.7582589166,    362.2376934341,    3.1873808650,    1.3802046340,    3.1001090654,    3.5683509775,    2.1042669163,    36.1417768629,    23.6838725272,
    204.3056815750,    246.6619120703,    193.2375074605,    160.6979195712,    7.8195209575,    7.7931183745,    7.6005297810,    7.1856803806,    6.2918942408,    6.2738538688,
    5.6335238409,    1.4930302619,    0.9180610281,    167.7020535978,    165.1927764170,    123.9309187683,    0.3907302798,    -0.0025407478,    0.0002108502,    -0.0045593285,
    0.0126208464,    -0.0078309373,    0.0053592706,    -18.1872188016,    -12.3028222367,    -5.4234094823,    -3.0144847874,    -1.0405655787,    -0.4886830840,    41.7664496854,
    -5.3019107275,    -3.1981018099,    -3.0893044688,    -53.2184796260,    -42.7248274358,    4.8173366318,    1519.6249231006,    3.5448156496,    -206.3227605790,    -308.3182747853,
    -199.0400119729,    -62.2404209364,    -0.2100763966,    -0.3119796209,    -0.0870389532,    0.4824736938,    -0.3652756134,    -0.2898732474,    -0.5750241350,    -1.5945064003,
    -0.3233293534,    -9.3567061133,    -1.1422401780,    0.0171688395,    -0.0082911332,    -0.0001789552,    0.0001091403,    -0.0003630785,    0.0001488122,    0.0006015569,
    0.7427315538,    0.0679320169,    -0.4452809035,    -0.1997700269,    0.0912739223,    -0.0801390674,    -0.0392407480,    2.0031537489,    -0.2197295237,    -0.1641333903,
    -0.1132781146,    15.1825466538,    -0.4399606481,    48.4147256802,    -1.9341838609,    -1.9677420756,    -0.8094265886,    -0.0059113474,    0.0064903741,    -0.0062632392,
    -0.0111928286,    -0.0128464209,    0.1387442563,    -0.0077665830,    0.0114356065,    0.2800905227,    -0.0371943509,    0.0086040521,    1.7360354649,    -0.2087191438,
    -0.3996764069,    0.0286067921,    0.2291070112,    -0.0665986687,    -0.1672770271,    -0.1393828809,    -0.0781147266,    0.0363045765,    0.0770340947,    -0.1293528131,
    -0.0701822806,    -0.0278326811,    0.0043308026,    -0.0431636967,    -0.0780202574,    0.0347606281,    0.0414183184,    0.0504645922,    -0.0880332291,    -0.1027197546,
    -0.0338407917,    -0.0069265191,    -0.0885577973,    -0.1192814949,    1.4282848002,    1.1128060572,    0.8090123904,    0.6357276044,    1.2003821238,    1.1566570113,
    0.9955378977,    0.7376864782,    1.0866232774,    1.0491149960,    0.9716524818,    1.1956326609,    1.0618278354,    1.0928800202,    0.6196921423,    0.8649583937,
    1.0795326683,    1.0951597569,    1.0385756497,    0.8949202861,    1.0775122077,    0.7421366792,    0.9021132171,    1.0816225828,    1.0317050648,    0.7327508838,
    1.2633067721,    1.3595594708,    1.1348211996,    1.0971867731,    0.3942828974,    -0.3653886073,    5.3942858439,    0.9967423520,    5.4748394903,    11.0737090397,
    21.7007163493,    2.5023208432,    2.3044481227,    2.1428461390,    0.8977846569,    10.9459961488,    2.6296370994,    3.3508590091,    5.3117659781,    76.6724121674,
    5.3846501904,    0.3526456395,    0.6155096127,    0.0041109055,    0.0079137160,    0.0284737006,    0.0960618380,    0.1628989076,    0.0033299297,    0.0065739281,
    0.0203719781,    0.0538742407,    0.0861398817,    0.9937508764,    0.0866221021,    0.3175817767,    0.0989082279,    0.5685449073,    0.0496463899,    0.1090384789,
    0.0216795612,    1.8241350985,    2.3648158668,    3.2293587729,    0.8871491766,    1.0509950379,    1.2550298932,    9.3004069230,    5.7515106821,    5.0105453962,
    3.5292433063,    2.4245823175,    1.6260363273,    0.9667785285,    0.5495318121,    0.7735768942,    0.4946676462,    0.3482370437,    0.2328044015,    0.1502940680,
    0.0910432754,    0.0569814326,    0.0333178224,    7.9838093934,    4.5917445531,    3.5186000071,    2.2410298236,    1.4016471156,    0.8507997276,    0.4778011456,
    0.2473741459,    0.6707366383,    0.4013567876,    0.2566578073,    0.1583823012,    0.0958839510,    0.0540283590,    0.0314363018,    0.0166055876,    16.4647609453,
    15.4133015332,    0.9758042348,    50.0346157834,    3.6181408662,    3.7398918289,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0439491248,    3.4041467703,    0.7621702437,    0.0505729495,    0.0173754620,    0.5093281527,    0.0749466298,    2.7467877717,    -0.0030319796,
    0.1936885319,    0.0994913700,    0.0648239206,    0.4401614977,    0.0342404969,    0.2795659195,    0.0371703153,    0.0560320430,    0.0261264422,    -0.0509404559,
    0.0888398691,    0.0178025451,    0.3771352184,    0.4304321887,    1.9938611200,    0.0203331096,    0.4187037781,    0.3190566559,    0.8664836092,    0.0149879868,
    0.3179593532,    0.4699349775,    0.2628237266,    0.3307161835,    0.5637385901,    0.1642398050,    0.0236302005,    0.5873663614,    -2.6707892423,    2.9927078803,
    3.5673348437,    0.6671751976,    0.7874354500,    0.2965663072,    0.4622089631,    0.6514232425,    0.7397497804,    0.7661776157,    0.7688556697,    3.2337941541,
    2.4610396249,    1.1287573429,    14.6808368044,    23.2198718052,    45.8924438470,    34.4086633400,    5.6613747137,    2.5749953147,    1.2288797965,    26.6240155202,
    18.8746660577,    5.5529324594,    4.7214025180,    2.4975721651,    1.1385743581,    0.6222088548,    0.4585489903,    8.6776072521,    0.1133828264,    0.8396087426,
    3.0748555696,    30.3249885645,    4.7392960850,    16.8374126392,    0.0000000000,    1.3290046783,    1.1995386455,    12.7904030132,    4.5746413652,    4.3616736621,
    28.2386254936,    13.6895681601,    0.6138883554,    0.9163174308,    0.0000000000,    2.9735799937,    0.8687138739,    4.4262942587,    4.9714148403,    5.8921911320,
    8.6266744506,    14.2248216806,    4.7489536896,    7.4797182396,    13.7106537598,    5.8104601695,    5.6556887860,    9.0688002585,    0.4230380806,    0.3782435358,
    5.6649487570,    0.4525689366,    0.4100264156,    0.6595904487,    0.0580376582,    0.2011080620,    0.1254629222,    27.7105893464,    0.0170444140,    0.2489910669,
    0.0498070100,    0.4639476522,    10.6869962772,    0.1327288755,    1.3776602443,    0.6870962159,    0.0816377335,    1.4913446950,    3.9100344360,    0.0658664768,
    0.0693245832,    0.2859970035,    0.2381618618,    0.1543489626,    0.9755218669,    0.4606179953,    0.0126002777,    0.0524476379,    0.0077849684,    0.0174451816,
    0.0406320513,    0.0087266258,    0.0183958536,    0.2671993250,    0.1517666581,    7.8659253166,    0.2490870167,    0.0536456366,    0.0419792221,    0.4513769917,
    0.0396092715,    0.0385873511,    0.1434263947,    0.5089701549,    0.5055490492,    0.8522364941,    0.6249842589,    5.7111382697,    7.1614580958,    0.6181300760,
    5.0931429265,    4.0432706951,    1.9743594568,    2.1980610016,    0.2119688624,    0.0793350963,    0.0117113714,    0.0021407883,    0.0266968896,    0.0442009822,
    0.0020148596,    0.0719053016,    1.4580408668,    131.3191661671,    5.7597828346,    0.6182368213,    0.5455426893,    1.0775670350,    1.4801189262,    0.8561887095,
    0.1555690020,    0.4014455057,    19.6012377937,    17.1895529530,    1.4580408668,    0.6182368213,    5.7597828346,    0.5455426893,    0.8561887095,    0.1555690020,
    1.0775670350,    1.4801189262,    131.3191661671,    2.6293858522,    0.8203569832,    43.3709486187,    0.4874863056,    1.1083354017,    0.1072077855,    1.2513471193,
    2.1989764171,    21454.4487942777,    1.0504718269,    10.4611563171,    0.9269530264,    1.3886626250,    0.2346478188,    1.5491266592,    2.1730442473,    236.8348340084,
    4.9406832043,    0.4662380393,    0.8525109915,    0.1523092843,    0.7260602096,    0.9667828961,    100.5323802153,    3.9475903013,    6.1836839500,    1.0875103785,
    6.2469589522,    8.6802228948,    952.6435103445,    0.6531656517,    0.1454327018,    0.5889671869,    0.8194354870,    83.5615013436,    0.2066917391,    0.9757861957,
    1.3047506470,    128.2315950044,    0.1827993075,    0.2371976453,    21.1388737287,    1.6025083769,    140.5309218015,    196.4810404530,    4.2262865559,    49.4834324644,
    175.0342300678,    0.2826177433,    173.8976845266,    49.8610390045,    32.8297915418,    1.3429454438,    1.7971061070,    1.3920324048,    2.6421122759,    19.6012377937,
    17.1895529530,    0.8068291935,    8.3668460920,    100.0937361164,    0.8930478639,    2.4116848406,    0.3978080982,    0.4197066171,    24.0474177964,    2.6008846187,
    0.2120342009,    1.4064594098,    1.1944252089,    3.5125135059,    7.5598698596,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.2303854224,    0.0663143580,    0.6107458745,    0.3183679392,    0.2388059550,    0.0775667788,    0.0725841195,    0.4818756387,    0.1931203929,    0.2386673928,
    0.2294813901,    0.1433389755,    0.1909202395,    1.5230070028,    4.3575783352,    0.2056409514,    1.1597030226,    0.1067909737,    0.6830975301,    0.3555395877,
    0.1548285344,    0.7500672979,    0.1126606818,    1.0310110669,    0.4083250489,    0.3334596425,    2.6334732346,    1.7034181320,    0.0158680187,    0.3648482666,
    0.0751633101,    0.3638249314,    0.1253583608,    1.2540118314,    5.8740647209,    0.7577368150,    3.4646774856,    0.6882235414,    1.7261185944,    0.1327989451,
    9.8957151661,    91.8738121496,    91.6400275961,    0.1475065761,    0.1459739169,    0.1219943979,    0.3791149975,    18.1671208117,    0.9495206283,    0.2698469257,
    0.2001474999,    0.2376083916,    0.2663310803,    1.4857749981,    0.5639488400,    0.4091752778,    0.7017342247,    2.1461575947,    1.3616960923,    0.7931202794,
    111.8773340869,    36.3905908322,    5.5811096606,    2.4349424830,    3.8860426131,    3.3588661694,    28.1721074885,    16.0944539459,    6.8674776425,    13.6400852446,
    6.2549699991,    30.5145837048,    5.7634485273,    7.2475886422,    30.2602326356,    27.0205210733,    9.8144569952,    8.4305888751,    15.4143455709,    25.5973234831,
    8.1957057715,    2.0377185350,    4.6046306583,    7.0773968856,    3.6029235911,    1.0197629368,    0.3505204252,    0.8459174301,    1.9621666237,    24.9159139049,
    0.5150927866,    0.1083319372,    0.3247528699,    0.2276268484,    15222966.9423217215,    10.2052555213,    96.2504495717,    201.8522546457,    129.3254865318,    222.1531617317,
    806.8194537799,    6958.4069829659,    217.3129309942,    0.9739782500,    0.7597357978,    1.2749591514,    6.6984097381,    4.8327518764,    64.7837560914,    46.8319848690,
    51.2938372524,    41.8637569322,    54.5996543396,    53.1357339663,    1.0223358202,    1.3135873794,    1.6978564665,    2.2745838369,    0.6664214757,    1.1912036909,
    2.1047527623,    0.6420795978,    0.4294228816,    15.5745091779,    31.1309290999,    78.2411331251,    0.3652348509,    0.1672148984,    0.1738779605,    0.1558550370,
    0.1378929532,    0.1131594245,    0.0954583854,    33.2156255613,    36.8812992893,    32.6710744754,    3.4023834014,    4.8660179849,    4.2941027710,    45.9350924333,
    23.4621093200,    18.5162370127,    125.3904014621,    145.4506874078,    145.7602095350,    93.8353359119,    2327.1892184112,    182.5195866189,    761.5909158363,    455.0866029126,
    502.1666806702,    464.3543218401,    0.9444045531,    1.0888254852,    0.3939199203,    1.5504415801,    1.5896647488,    0.8369275028,    2.3299570834,    2.4512901738,
    2.3346822737,    17.9592459084,    14.7314658548,    0.0165306606,    0.0100083695,    0.0054529220,    0.0053184407,    0.0058139089,    0.0066247806,    0.0076598116,
    0.6859746152,    0.8048863986,    0.9548255258,    1.6809913868,    0.1723114165,    0.0954409181,    0.1175616393,    2.5909334421,    0.4507389213,    0.9700361411,
    1.3515849418,    31.2822340984,    7.8602923842,    9.7240727391,    3.9206952340,    8.0844748493,    13.5506652879,    0.0205145803,    0.0302479219,    0.0245968010,
    0.0506545871,    0.0811551673,    0.1521551595,    0.0293767243,    0.0511774319,    0.2132741400,    0.0847945967,    0.1119536968,    1.5092321832,    0.5561980370,
    0.2284406284,    0.2659816828,    0.1894796017,    0.3042649440,    0.1419691168,    0.1567495628,    0.1820676868,    0.2314638527,    0.2066008929,    0.1558411366,
    0.1851702019,    0.3381914700,    0.1660398842,    0.1662018237,    0.2075067383,    0.3226651222,    0.3720151882,    0.1898300444,    0.1830768653,    0.2464003371,
    0.1202151586,    0.2602700005,    0.1822343685,    0.1914254194,    0.2888452926,    0.3891354899,    0.6706589130,    0.7000758750,    0.3533114598,    0.3694492947,
    0.4469535609,    0.2945091982,    0.2910284280,    0.3629933394,    0.5249940139,    0.2903890310,    0.2164248797,    0.2486680226,    0.5685227589,    0.3331839106,
    0.3723019966,    0.4645085424,    0.6669436870,    0.3030328790,    0.3364359914,    0.8547044693,    0.3120100854,    0.3513408889,    0.6365289371,    0.8691538486,
    0.3713010637,    0.3142236859,    0.2164286593,    0.2754546445,    0.4749107376,    0.0997997515,    1.2069032614,    0.1222809291,    2.1567032581,    7.7564146786,
    1.9561791454,    0.0644101791,    0.0647581355,    0.5313402033,    0.2982492039,    0.2235233150,    0.7481745993,    0.7729235129,    2.8924439911,    100.7440576259,
    2.9097119705,    0.1612601704,    0.3505204252,    0.0331893133,    0.0553090894,    0.1051303784,    0.2010597513,    0.3752473806,    0.0270998849,    0.0481633507,
    0.0871652950,    0.1578590876,    0.2914830530,    1.0221281390,    0.1932505516,    0.8198150500,    0.4221885175,    0.7899854290,    0.2858276297,    0.2758398340,
    0.1018740473,    2.3392977363,    3.4374555491,    5.8270373561,    1.2021831713,    1.8303695383,    2.8634637469,    4.3921187269,    2.9273991705,    2.7811246761,
    2.4076408042,    2.0110779591,    1.6591329515,    1.1968961066,    0.8567766698,    0.0486451325,    0.0499781855,    0.0590236867,    0.0622130870,    0.0605669867,
    0.0506905424,    0.0391392675,    0.0283232751,    3.8655855015,    2.5369105394,    2.1457258720,    1.7160129209,    1.3575813975,    1.0225047820,    0.7187443979,
    0.4657982586,    0.1253011137,    0.1269212340,    0.1503254014,    0.1147588212,    0.0989400575,    0.0719453581,    0.0470318765,    0.0286493684,    7.9650712257,
    7.6491393014,    0.0889723399,    44.9821814311,    1.0259311311,    1.1852007086,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    0.2563048954,    3.2291411138,    1.7936874191,    1.2726663680,    0.9645138753,    1.3504793159,    0.4945290618,    6.5880103207,    0.0706309190,
    1.2666133531,    0.7912824709,    0.4954601527,    0.8216141677,    0.5934567533,    0.4916306540,    0.2037389329,    0.4596895853,    0.3473598695,    0.4391406621,
    0.6771265556,    0.1829400683,    2.0337488914,    0.6111184163,    3.7286521122,    0.1849004321,    1.8276496843,    0.1769749777,    0.3353399703,    0.0363749008,
    0.1035766107,    0.0196928957,    0.2911321091,    0.3122113067,    0.1926839344,    0.1991966307,    0.0457565546,    0.1427380354,    1.9672845581,    0.5826726236,
    0.7480628949,    0.1349192691,    0.1380131637,    0.1032646548,    0.1290458205,    0.1277703152,    0.1201839646,    0.1176955358,    0.1284453828,    0.8804396971,
    0.9099649531,    0.6989352931,    8.5884450663,    8.9542513701,    22.3005754860,    18.1855809540,    4.3265999400,    8.8571048018,    4.4515815667,    28.1721074885,
    16.0944539459,    6.8674776425,    6.9878241798,    4.9511722942,    3.3571144666,    2.4349424830,    1.9319224763,    10.9232525282,    0.8867806300,    2.7980067448,
    6.2549699991,    30.5145837048,    7.2012912984,    19.7880577266,    1.0000000000,    3.8563305247,    3.1422608143,    12.7280173815,    5.7634485273,    7.2475886422,
    30.2602326356,    16.4816106732,    3.5042228817,    3.7932956591,    1.0000000000,    9.4366207416,    3.0850152729,    10.0024071128,    7.2383287940,    7.6276555291,
    9.6168429165,    24.3936004257,    8.4305888751,    12.0471781168,    15.4143455709,    10.9874263519,    9.8144569952,    25.5973234831,    0.8080453317,    1.0554626258,
    8.0794227142,    1.3275385092,    0.3208473700,    1.6111379680,    0.1341711389,    0.1984481081,    0.2880683729,    28.3717446033,    0.0696169342,    0.1381781864,
    0.0306905468,    0.1851101031,    165.4051481472,    0.5152386029,    1.8149637891,    1.6268476189,    0.3826324531,    1.5100137682,    3.1226000292,    0.2806321227,
    0.2183554820,    0.4047137301,    0.1418188677,    0.1554071862,    0.7553232938,    0.4175779604,    0.1998017101,    0.2850114155,    0.1289848125,    0.1959642598,
    0.2123786603,    0.1302957376,    0.1583003269,    1.3296640921,    1.3756707540,    9.2098346466,    0.5845366955,    0.2620108034,    0.2450087352,    0.6844905417,
    0.2166634934,    0.3691408733,    0.2843420099,    0.4628758569,    0.4647575775,    0.6376864763,    0.6561939537,    3.1893084634,    30.2570700966,    0.3572347515,
    0.7154897054,    2.4444073771,    0.3855838653,    26.3525943098,    2.8464648888,    0.4024260407,    0.1308246117,    0.0462191015,    0.4055930996,    0.2091850858,
    0.0475673983,    0.3580337228,    0.7095792294,    64.8823966222,    3.1930941603,    0.6619216086,    0.4357401516,    0.3003271624,    0.0906883744,    0.6125979884,
    0.2881077422,    0.1205247267,    3.8233266417,    1.8032977603,    0.7095792294,    0.6619216086,    3.1930941603,    0.4357401516,    0.6125979884,    0.2881077422,
    0.3003271624,    0.0906883744,    64.8823966222,    3.7534257888,    1.6421595518,    69.3843240265,    1.3252732185,    2.1450529407,    0.3707125954,    0.8538511427,
    0.2711466381,    28615.3347581489,    1.7671265205,    15.6261642094,    1.7137173037,    2.1572070150,    0.6041785067,    0.8203287070,    1.0900436187,    325.2428535999,
    8.9091615896,    1.1642880521,    1.5881546229,    0.5093391952,    0.9733783104,    1.0617295166,    166.9185857932,    8.3866359197,    10.7635468897,    3.0817796159,
    4.1371758972,    5.0723381708,    1362.6954004434,    1.5421330814,    0.4933004784,    0.5313742248,    0.6778881895,    148.0448276984,    0.5981559077,    0.8550561687,
    0.9795779587,    187.1187509120,    0.3688961179,    0.4481591733,    54.5745276665,    0.4933212525,    79.5775968076,    101.3788004257,    3.0797308534,    24.9159139049,
    81.9619871541,    0.0455524054,    81.2750907314,    25.3161612336,    16.2205991556,    0.2696486044,    0.3527524620,    0.2732408821,    0.5117567895,    3.8233266417,
    1.8032977603,    0.1593013513,    5.4854008594,    140.2910616727,    0.0964090569,    2.8122139106,    0.1868676630,    0.2126234502,    12.1824263210,    0.2739227909,
    0.0903304219,    0.1051165443,    0.1747774366,    3.1406424905,    4.5856073122,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 502;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    0,    4,    15,    16,    17,    19,    22,    26,    27,    28,    32,    36,    38,    66,    67,    69,    78,    79,    83,    84,
    85,    86,    88,    89,    93,    100,    111,    122,    136,    141,    146,    150,    151,    155,    215,    217,    291,    293,    294,    295,
    296,    297,    299,    302,    303,    305,    306,    309,    310,    311,    312,    313,    314,    315,    316,    317,    318,    327,    331,    332,
    336,    337,    338,    341,    344,    345,    348,    349,    350,    353,    356,    357,    367,    368,    369,    374,    376,    382,    384,    386,
    388,    390,    391,    393,    394,    395,    396,    410,    421,    422,    425,    437,    452,    513,    522,    531,    544,    548,    563,    564,
    574,    593,    599,    652,    657,    661,    665,    667,    669,    671,    687,    688,    689,    690,    698,    699,    700,    701,    715,    716,
    719,    723,    728,    732,    736,    739,    741,    743,    744,    746,    747,    748,    749,    754,    755,    757,    761,    764,    765,    768,
    773,    775,    779,    780,    781,    785,    786,    787,    790,    798,    799,    802,    807,    808,    814,    824,    825,    832,    833,    834,
    836,    843,    845,    849,    850,    851,    852,    853,    854,    857,    859,    860,    861,    864,    868,    869,    871,    876,    877,    879,
    883,    885,    887,    903,    904,    905,    908,    913,    914,    922,    924,    926,    930,    931,    932,    939,    942,    946,    948,    951,
    957,    962,    965,    969,    974,    975,    976,    978,    980,    981,    983,    987,    990,    1006,    1008,    1010,    1011,    1014,    1015,    1024,
    1029,    1041,    1045,    1047,    1053,    1062,    1066,    1067,    1069,    1071,    1077,    1078,    1087,    1088,    1089,    1101,    1102,    1103,    1107,    1110,
    1111,    1112,    1113,    1117,    1119,    1123,    1125,    1127,    1129,    1131,    1133,    1141,    1142,    1143,    1148,    1150,    1151,    1154,    1155,    1157,
    1161,    1164,    1166,    1169,    1170,    1172,    1173,    1181,    1230,    1254,    1269,    1288,    1300,    1301,    1302,    1303,    1304,    1305,    1306,    1307,
    1308,    1309,    1310,    1311,    1312,    1313,    1314,    1315,    1316,    1317,    1318,    1319,    1320,    1321,    1322,    1323,    1324,    1325,    1326,    1327,
    1328,    1329,    1330,    1331,    1332,    1333,    1334,    1335,    1336,    1337,    1338,    1339,    1340,    1341,    1342,    1343,    1344,    1345,    1346,    1347,
    1348,    1349,    1350,    1351,    1352,    1353,    1354,    1355,    1356,    1357,    1358,    1369,    1396,    1397,    1398,    1399,    1400,    1401,    1402,    1403,
    1404,    1428,    1506,    1510,    1512,    1515,    1516,    1529,    1533,    1551,    1569,    1579,    1583,    1611,    1616,    1617,    1618,    1628,    1649,    1653,
    1680,    1687,    1699,    1710,    1735,    1752,    1793,    1806,    1810,    1816,    1820,    1824,    1829,    1831,    1838,    1840,    1843,    1846,    1853,    1856,
    1858,    1868,    1871,    1872,    1873,    1874,    1875,    1876,    1877,    1878,    1879,    1881,    1884,    1885,    1890,    1891,    1897,    1906,    1907,    1908,
    1909,    1910,    1911,    1912,    1913,    1914,    1915,    1916,    1917,    1918,    1919,    1920,    1921,    1922,    1923,    1924,    1925,    1926,    1927,    1928,
    1929,    1930,    1931,    1932,    1933,    1934,    1935,    1936,    1937,    1938,    1939,    1940,    1941,    1942,    1943,    1944,    1945,    1946,    1956,    1959,
    1960,    1962,    1978,    1981,    1982,    1984,    1986,    2153,    2162,    2164,    2166,    2174,    2216,    2230,    2232,    2237,    2241,    2251,    2254,    2260,
    2267,    2269,    2271,    2272,    2274,    2275,    2410,    2414,    2447,    2470,    2472,    2490,    2500,    2512,    2547,    2669,    2711,    2743,    3109,    3136,
    3142,    3225,    3765,    3766,    3767,    3768,    3769,    3770,    3782,    3800,    3803,    3824,    3845,    3847,    3867,    4011,    4015,    4021,    4029,    4036,
    4072,    4087
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 12;
constexpr int N_PHYSICS_FEATURES = 74;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
    "HansenTotal",
    "dD",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
    "dh_a_logpow_est",
    "dh_a_sq",
    "dh_logpow_sq",
    "dh_a_logws_est",
    "dh_a_sq",
    "dh_logws_sq",
    "dh_a_dp_est",
    "dh_a_sq",
    "dh_dp_sq",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/dh_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/dh_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadedH
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadedH {
struct Model {
    using Namespace = CascadedH;
};
} // namespace CascadedH
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
