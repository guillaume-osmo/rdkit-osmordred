#pragma once
// Auto-generated Treelite model for DipoleMoment (v3.4 XGBoost)
// Trees: 300, Features: 616
// Target normalization: mean=2.3571127668, scale=1.4574470237
// Library: dipolemoment_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadeDipoleMoment {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 616;
constexpr double TARGET_MEAN = 2.3571127668;
constexpr double TARGET_SCALE = 1.4574470237;

// Normalization stats
constexpr int N_NORM_FEATURES = 616;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0088207985,    0.0123026927,    0.0819405757,    0.0143918292,    0.0055710306,    0.0069637883,    0.0111420613,    0.0359795729,    1.1204735376,    1.8590993500,
    0.0415506035,    0.0986536676,    0.0376044568,    0.0116063138,    0.0833333333,    0.1682915506,    0.3064066852,    0.5517641597,    0.0617455896,    0.0188022284,
    0.1543639740,    0.0236768802,    0.1543639740,    0.0434076137,    0.0427112349,    0.2771587744,    0.0127669452,    1.6357938719,    0.0123026927,    0.0691736305,
    0.1996285980,    0.1390436397,    1.8609563603,    0.2156453110,    0.1787372331,    0.1898792943,    7.8961777893,    0.6100822562,    0.5158060071,    13.1566973016,
    179.8242267874,    179.4788648510,    0.1621134460,    -0.2992675743,    0.1543946870,    1.1517948724,    1.9957484853,    28.4946544545,    10.4348093513,    -1.9775605552,
    -1.9448689176,    6.3745776449,    0.4575199854,    2.7801930700,    6.7129642663,    3.7527131005,    2.6540974380,    3.4949651197,    1.5292936978,    -0.7705615949,
    1794370764073.8879394531,    4.2968862038,    3.4384868051,    0.5876832076,    0.7438949845,    1.2487079119,    17.7709237185,    6.8669387269,    4.9984813465,    6.2062833000,
    13.3330943408,    17.2919940610,    1.4588912269,    11.2027488293,    3.2621533884,    4.2715693370,    17.5479368516,    25.7310190344,    3.9805909892,    4.6509019201,
    10.6363665681,    13.7923021861,    6.1077775421,    5.7927885452,    1.0874746097,    2.2167566108,    1.7743732591,    0.2432683380,    2.6724698236,    0.2474466110,
    47.2608814763,    0.1388115135,    0.4173630455,    0.0710306407,    0.0494428969,    0.0069637883,    1.1920867726,    0.3032201214,    11.1532033426,    120.6327448343,
    161.7461582942,    55.6603678230,    80.3410515755,    845.2370009285,    264.9839832869,    6884.4972757582,    360.8469802020,    37.3727630430,    1.6383148511,    1.0408632065,
    2.8182601413,    1.6008304068,    1.0063461643,    3.3229606015,    4.0379585669,    3.3892086067,    3.2352283459,    1.2385531047,    33.2393859590,    123.7325569037,
    47.2636914492,    229.8305140032,    266.8635188907,    173.4287978763,    96.3507083971,    7.9077863395,    5.9315853382,    5.7365024281,    1.8070418386,    1.6405312739,
    156.4339022148,    147.9174028414,    131.5801953859,    80.7590103292,    -0.1368997861,    -0.0063860151,    -0.0044881448,    -0.0146990033,    0.0097132979,    0.0008255108,
    -14.0656041823,    -17.8540606454,    -10.7994192126,    -3.8392737126,    0.1685181308,    2.7185925228,    -2.3555526746,    -3.5307372905,    -2.4760472369,    -0.3857997938,
    34.6539555205,    -3.2000385649,    -2.4443855544,    -6.5471925248,    -6.2262852886,    -1.4702462933,    -8.0283901304,    -69.4996786977,    -36.8418452421,    -12.2402897507,
    -61.3597043600,    -89.7851606857,    -253.2104062294,    -191.0040425677,    -0.2279713669,    -0.3610931885,    -0.0563672058,    -0.3248411327,    -0.5154368656,    -0.3815886921,
    -0.0172983704,    -0.1685580443,    -0.4874426295,    0.0192515995,    -3.5407502742,    -7.7368002392,    0.7262705931,    -0.0076075246,    -0.0001146593,    -0.0001811200,
    0.0000518537,    0.0006209930,    -0.0000062863,    0.5735798822,    -0.4954376358,    -0.1959329263,    0.5068313189,    0.0753700379,    -0.0756551932,    0.0430195348,
    0.1647874410,    -0.2577903567,    -0.2536489678,    -0.0109918416,    22.7773702495,    -0.3004998479,    -1.2066117838,    -3.0837267677,    -2.2813005901,    -0.9293556208,
    118.6025777407,    -15.9242750908,    -6.9534827670,    -0.1374587942,    -0.0125554112,    -0.0089387694,    -0.0026562805,    -0.0179483077,    0.0009103128,    0.1298479174,
    -0.0065758169,    0.0002575122,    -0.0495477200,    0.0034941567,    0.0084986082,    1.6838999071,    -0.1267659731,    -0.2119776857,    -0.0977044942,    -0.3720835782,
    -0.0440717790,    -0.0221364824,    0.0128274554,    -0.0448183157,    -0.1367876772,    -0.1267490639,    -0.0530549747,    -0.0754270370,    0.0950953550,    0.0839613479,
    -0.1305923919,    0.0353826628,    -0.0696302963,    -0.0888780101,    -0.0320367299,    0.0079613081,    -0.1174572004,    0.0067642075,    -0.1215768585,    -0.0086801776,
    -0.0836765358,    0.0410588253,    -0.0260295326,    -0.0236087460,    -0.1024656687,    -0.1238751071,    -0.0182536809,    -0.0999824318,    -0.1363931522,    0.0493174584,
    -0.0777352603,    -0.1303245807,    -0.0582526138,    0.0666143185,    0.0731307960,    1.0054644911,    0.9670172922,    0.8571118466,    0.7036191001,    1.0364266656,
    0.9142427225,    0.7758228334,    1.0959700392,    0.6546397801,    0.3364763830,    0.9444553036,    0.7574591379,    0.9693397913,    1.0903472374,    1.0775106992,
    0.9024095378,    0.8468949721,    0.9099740277,    1.0794728687,    0.9473022984,    0.6485139266,    0.4297403245,    0.8505992436,    0.9452478735,    1.0033013714,
    0.9701132567,    0.6823915361,    0.5370825650,    0.8007016337,    0.8423822891,    1.1310539781,    1.0353208534,    0.6560340718,    0.8083610905,    0.8399704481,
    1.0418238063,    1.1130920553,    0.8424281283,    0.8301293388,    1.0451912673,    1.0337106333,    1.1312583710,    1.0984692229,    0.6601925823,    1.2628598404,
    1.0652365610,    0.9028339141,    -0.3681450679,    1.1205364882,    1.0206685967,    5.3045012672,    1.1722711177,    15.9339583932,    0.9149627799,    10.7881927082,
    0.9208182753,    59.4474575065,    30.0457668339,    44.6972028991,    60.0407656645,    4.2147634307,    30.0673345567,    72.5361229219,    5.2228454567,    36.1404852795,
    -0.6631178201,    3.2259179475,    0.3197467031,    1.1526263000,    46.3603418270,    3.5401138239,    3.5331426106,    63.4230976299,    31.9669041064,    47.4912589661,
    63.8361251142,    4.5345944560,    31.9734486037,    0.5226580501,    3.2307992175,    0.3201100978,    1.1539832792,    46.0702545450,    3.5202359060,    3.5289288455,
    63.5183911572,    32.0192946262,    47.5840527742,    63.9398207798,    4.5418135433,    0.5328029712,    0.3768697234,    0.5099814299,    0.1100493534,    0.0639039698,
    0.1146647886,    0.7986248933,    0.0554267071,    0.1892020354,    0.0337298149,    0.6234013886,    0.0601933316,    0.1096585753,    0.0252460876,    1.9601269065,
    2.6237610011,    0.9491271562,    1.2875566045,    1.7673704861,    8.5191767061,    5.4290411755,    0.3460545251,    0.0313410766,    0.0507910478,    0.7878964645,
    0.7681761794,    0.6418618043,    1.8528319406,    0.0118384401,    0.3238161560,    2.9236304550,    0.3117455896,    0.0064995357,    0.0724233983,    0.4315227484,
    1.2811049211,    0.1429897864,    0.1543639740,    0.0000000000,    0.0601207057,    0.0004642526,    0.0020891365,    0.0389972145,    0.0194986072,    0.0492107707,
    0.0002321263,    0.0522284123,    0.0986536676,    0.0712627669,    0.1056174559,    0.0206592386,    0.0002321263,    0.1682915506,    0.0188022284,    0.0000000000,
    0.0006963788,    0.0018570102,    0.0095171773,    0.0097493036,    0.0002321263,    0.0000000000,    0.0341443540,    -0.0450579038,    0.1159235260,    1.5121718520,
    -0.0083308750,    0.2921406143,    1.3641936639,    0.4231154132,    0.3219495386,    0.1498688613,    0.1002087001,    0.0289413330,    0.0416990587,    0.0272422127,
    4.4868288706,    0.2593431825,    -0.0301683271,    0.2971085462,    4.4687011595,    0.5567806640,    6.0782265552,    0.4869548775,    0.6932318500,    0.2791979147,
    2.3554009552,    0.1821410191,    0.2714137464,    0.6123677479,    0.8337597709,    -0.1321033376,    1.4122288739,    2.1416310360,    2.8404625151,    3.3158713488,
    81.1223150854,    0.7528973741,    0.4947007315,    2.1448313527,    0.9705910398,    17.9403029880,    26.1596661133,    31.2664591692,    42.2533806859,    24.9962487070,
    4.8262675702,    1.9132999051,    1.4259103473,    0.1036735253,    167.3994893222,    0.1255803157,    29.4249117920,    0.0224044587,    0.0084079932,    0.4284292140,
    0.9800371402,    0.0499930118,    0.8651593214,    0.2950848629,    0.5413685138,    0.2086815227,    0.0332495255,    0.0575336244,    0.1041735373,    0.0248802375,
    0.1113680861,    0.0641793788,    0.0201837955,    0.0715099040,    0.0005770917,    0.0271580132,    0.0006083080,    0.9204617096,    0.0204885319,    0.1811560308,
    0.0450908791,    0.2898957168,    2.1492023885,    0.0698848937,    3.7266266903,    0.0933377437,    0.5210136955,    1.0408964717,    0.8714772516,    0.2950775173,
    6.4495415068,    5.7460026471,    0.7218434600,    2.8504587990,    1.4997459777,    50.4523505344,    2.0897195215,    1.4573085999,    3.8468222710,    1.9184853676,
    0.0239090065,    0.0169452182,    1.3320078544,    125.4043152033,    5.8067944459,    0.8648354269,    0.5262409536,    1.1705521477,    1.4569369975,    0.9017136993,
    0.1117707780,    0.3641640632,    16.8141798896,    6.7319572673,    7.8405138545,    20.4504889523,    142.8860894667,    55.2273659702,    2.0199240649,    2.3930514249,
    -1.7825416378,    -232.5341940158,    -5065.3154846913,    11.7132860620,    345.6924874563,    3.3970834993,    1.3320078544,    0.8648354269,    5.8067944459,    0.5262409536,
    0.9017136993,    0.1117707780,    1.1705521477,    1.4569369975,    125.4043152033,    2.2051754127,    1.2027771577,    43.2138606305,    0.3894366174,    1.0133022200,
    0.0665694311,    1.4777368641,    2.1287709822,    19760.6627187006,    1.3386977986,    9.5929256288,    0.7948558641,    1.2978296897,    0.1357614899,    1.5461873798,
    1.9481258698,    208.0032790913,    6.5044135849,    0.4977456749,    0.9900428411,    0.0948226547,    1.0969040175,    1.2847472631,    132.8340265182,    3.5263901677,
    6.0544638283,    0.6313451338,    6.9053840131,    8.5339490079,    915.9152678739,    0.5439906932,    0.0786256461,    0.5975464671,    0.7678036096,    74.2183847565,
    0.1189898875,    1.0909741800,    1.3311991934,    124.5309708384,    0.1334163267,    0.1655984075,    12.3780709522,    1.7105837325,    147.1877426759,    183.7921004035,
    4.3725588577,    47.2608814763,    156.2082322956,    0.2711853959,    173.8081320468,    42.6233592418,    31.3510788008,    1.3987562009,    1.9138049438,    1.4824269351,
    2.7980453048,    20.4504889523,    16.8141798896,    0.7090091670,    10.8675632897,    143.8799178645,    0.8356950887,    3.6363090627,    0.5101316070,    0.5476935410,
    31.3805283645,    2.4359990648,    0.2628678259,    1.3494334453,    1.0865656194,    4.7398474173,    9.7415553122,    7.8405138545,    156.2082322956,    77.1625953302,
    29952.4058026823,    93.2211198403,    1158.7094727813,    93.2211198403,    0.6899214351,    2.5345204197
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.1426509932,    0.1432057344,    0.3920267838,    0.1531984186,    0.0832631486,    0.0859042869,    0.1194474095,    0.2287501699,    1.3571293090,    3.6466960570,
    0.2030194782,    0.3741509085,    0.2349993965,    0.1174430504,    0.3417292218,    0.4986026495,    0.7047298711,    0.7653499743,    0.3030239399,    0.1408597255,
    0.5557056037,    0.1747693521,    0.4571590741,    0.2212497088,    0.3657013754,    0.8220318746,    0.1495100463,    1.7546569278,    0.1259577582,    0.2998708551,
    0.5481291312,    0.7341189016,    4.2293716116,    0.6694461856,    0.5374490822,    0.7952795298,    3.3220350102,    0.7401863071,    0.1259040438,    8.5487280279,
    86.4037286155,    86.1891414646,    0.1333532352,    0.1385885336,    0.1106701217,    0.3905519986,    0.5514499032,    22.7178270361,    1.6080981427,    0.2283958311,
    0.2839551469,    1.7618159860,    0.7144713994,    0.6160159830,    3.5640412797,    2.3043198081,    1.7919536121,    2.8333777617,    3.7721402551,    0.9373579924,
    117055815593330.3281250000,    3.5942422434,    4.5494310323,    2.3025715493,    2.3717100775,    3.3778243062,    15.8775675538,    7.4584821710,    7.2393686886,    7.1123766196,
    13.7478244288,    25.7682027457,    3.3272627409,    10.7774775413,    5.2994852402,    7.5655718839,    24.9193611759,    25.0426690635,    5.8754142673,    6.7818106855,
    16.3845566567,    19.4371515950,    9.7430192565,    7.8109383596,    2.0809889131,    4.9978893578,    1.7083477120,    0.7658954351,    1.8792997694,    0.4970250197,
    24.3808113891,    0.4688511797,    0.7921945771,    0.2955349492,    0.2382175487,    0.0885652249,    0.1197417991,    0.0910329633,    8.6347111813,    82.9158452047,
    132.7469080549,    109.6057087372,    115.0596864042,    852.0868738733,    544.2486297697,    6373.3295578553,    272.4511251246,    20.7707480307,    3.9818709634,    3.3084654837,
    0.7503680410,    0.8418052935,    0.9368454864,    2.1623656169,    5.5130829496,    4.3855215643,    4.3300937051,    3.2212202387,    52.1705544942,    416.8965905417,
    171.2995958915,    66.0838091605,    56.1794842513,    64.2530819760,    79.2389295629,    1.0689031582,    3.3183653145,    1.7034078852,    1.1503727154,    0.8565066553,
    28.8793452522,    56.4003448672,    71.6952604354,    85.8439087327,    0.1695563317,    0.1452967915,    0.1517294412,    0.1659255843,    0.1291993281,    0.0671586148,
    26.5926819534,    29.9798500939,    32.5855489865,    28.4016658591,    23.2240856462,    3.9560900778,    3.0509071368,    4.4720905273,    4.7357339442,    4.3421658236,
    33.9046842294,    5.8150765987,    15.5927717484,    20.4572303457,    20.3622936624,    19.6940059301,    144.8148748037,    239.5769971989,    203.9692470875,    112.2703826105,
    568.5441088731,    411.6923476411,    412.0666677212,    463.4511270471,    0.7015179586,    0.8708034781,    0.6285984790,    1.0464549925,    1.2247778210,    1.1841381079,
    0.5672071314,    1.8057929824,    3.2728316155,    2.5890079232,    13.5854427528,    12.7999486683,    9.5542847562,    0.0116505072,    0.0066570076,    0.0058627291,
    0.0063667253,    0.0092218248,    0.0091480701,    0.9410428236,    1.1116452702,    1.9381302886,    0.2436435753,    0.2131726314,    0.0998544018,    0.1230344417,
    1.0081046069,    1.1090670407,    1.3412205810,    1.3072039438,    44.1644467930,    12.2938199295,    13.4912822322,    14.2433970538,    14.6967576669,    21.8386708440,
    255.8452267944,    79.7548625838,    11.6936150950,    17.8842687522,    0.0412649207,    0.0482746091,    0.0534786951,    0.0596095329,    0.0582290507,    0.1275669140,
    0.0552913075,    0.0613728570,    0.1564445689,    0.2049631317,    0.1567278962,    1.3350071282,    0.5752734930,    0.5310734571,    0.4705233490,    0.2477243429,
    0.2147191016,    0.1887159858,    0.3479475068,    0.2154065854,    0.2249990039,    0.2714957617,    0.3367666721,    0.2209080779,    0.2661149267,    0.2248705434,
    0.2025347898,    0.2261726963,    0.2167156293,    0.2609165587,    0.4463697890,    0.1528586869,    0.2738048912,    0.1495758968,    0.2162756188,    0.4446129314,
    0.2480322610,    0.3872973819,    0.2077204144,    0.1915810321,    0.2248472800,    0.2913420899,    0.4971981919,    0.2194544275,    0.2208495896,    0.3788222273,
    0.2111171942,    0.2153798341,    0.2199196534,    0.3071570865,    0.2599093802,    0.3488153358,    0.4398687501,    0.5843863929,    0.7011385722,    0.3728812394,
    0.6293238774,    0.7801580822,    0.4077101195,    0.4961834378,    0.4644432705,    0.4567502491,    0.3364639110,    0.4208355138,    0.5809768455,    0.8492573087,
    1.0770180968,    0.3210435730,    0.2989525557,    0.3716693511,    0.6312143806,    0.9662009035,    0.8289326290,    0.3211550786,    0.6279995703,    0.2600626248,
    0.3782500580,    0.5729546795,    0.5892786669,    0.3754353897,    0.3734778652,    0.5561409900,    0.7812778543,    1.0433651638,    0.3561952623,    0.3307685998,
    0.3968451107,    0.5237314032,    0.9034752035,    0.3778192876,    0.4095923935,    0.7582249639,    0.4296825726,    0.4053017061,    0.7118531693,    0.4046639991,
    0.3520719503,    0.3862459335,    0.0934095539,    0.8195735506,    0.1850564024,    2.2400269389,    0.4495449863,    2.4010160880,    0.3104020920,    0.6189119551,
    0.7743886370,    94.0927818186,    47.0701455610,    67.5217676115,    94.1930446346,    2.5502230700,    47.0572813734,    104.7008955468,    2.7639190286,    52.3334930912,
    0.8462598162,    0.7864466618,    0.0858165574,    0.7464545858,    40.0627312402,    1.1091359195,    1.3459845536,    95.2744875879,    47.6723692335,    68.2625486261,
    95.3616284630,    2.5119619778,    47.6682584463,    0.4629583070,    0.7887887045,    0.0856067517,    0.7472189539,    39.9580196624,    1.0931140733,    1.3413012454,
    95.3024583549,    47.6859500769,    68.2770401570,    95.3895655474,    2.5187491669,    0.5052128610,    0.1711324005,    0.8800600868,    0.1607336001,    0.3410906164,
    2.0074791023,    0.7171904332,    0.2005033823,    0.4290467362,    0.2078537279,    1.4857471894,    0.3914446561,    0.5190811849,    0.2790293809,    2.2201743045,
    3.6484727111,    2.5046910018,    9.3252885740,    26.2467664727,    3.9987989829,    2.8302863667,    0.0820816779,    0.0272697043,    0.0981025392,    0.4388565204,
    0.5056779118,    0.1071606588,    3.6459710357,    0.1222622563,    0.8498288186,    3.6562444016,    0.7870123910,    0.0911827944,    0.3244178773,    0.7679754297,
    1.6418238056,    0.6013599358,    0.5557056037,    1.0000000000,    0.2671372084,    0.0304678450,    0.0456593035,    0.2204960159,    0.1464229296,    0.2610453757,
    0.0152339225,    0.2635592249,    0.3741509085,    0.3390146060,    0.3899098941,    0.1620731862,    0.0152339225,    0.4986026495,    0.1608625049,    1.0000000000,
    0.0263798007,    0.0430530107,    0.1166399317,    0.1051047685,    0.0152339225,    1.0000000000,    0.2793735334,    0.4463421068,    0.8859967895,    4.4967880377,
    0.1236524741,    1.8981368576,    4.1255400340,    0.5469590259,    1.5964791431,    0.7352007945,    0.4499935509,    0.2244021956,    0.3321336208,    0.2169358956,
    5.3418755983,    1.6687654249,    0.4083680051,    0.5052783036,    5.3196076826,    0.0683361226,    5.6651911957,    0.3561828397,    0.2925838524,    0.1132104794,
    1.8315659648,    0.1943710060,    0.2111211581,    0.1796117949,    0.1535537293,    0.1752298008,    0.2790682851,    0.4610224725,    0.5873537956,    0.8144759634,
    62.7027878532,    0.1435470276,    0.1369413286,    0.8998339202,    0.6635263922,    10.8140053609,    10.9488827517,    11.8725290203,    19.9129162692,    11.5629860301,
    3.7624333471,    0.1124341295,    0.4127040473,    0.1820541733,    221.7913163182,    0.3376213456,    26.4362568633,    0.0631878960,    0.0119625591,    0.1661581617,
    1.6893271390,    0.2832747902,    1.1919522376,    0.7573418864,    0.4271686081,    0.5267662316,    0.3119169850,    0.3064012180,    0.4251300019,    0.2657295967,
    0.3702950311,    0.5589895850,    0.2255619148,    0.5596992112,    0.0378732239,    0.3681522673,    0.0399218777,    0.9756095604,    0.2557876451,    0.7563255926,
    0.3708690860,    1.0227583887,    2.5108267601,    0.2527566101,    3.0207098647,    0.2197374655,    0.4582264395,    0.5870282871,    0.6928230062,    0.0760054267,
    2.2971841463,    1.5323295646,    0.5569059417,    2.0454052951,    0.3388424446,    24.6099982061,    0.3519211448,    0.1135276512,    0.7050503231,    2.1612354411,
    0.1918350592,    0.1864508712,    0.6564529598,    63.5170878353,    3.0813956080,    0.6744159265,    0.3354207450,    0.3279398324,    0.0781381302,    0.4474534887,
    0.2325440265,    0.1419461651,    1.4809130736,    3.9075711332,    3.9609263851,    3.2485922133,    102.9046455896,    24.1224995395,    2.3331782563,    1.8689383056,
    1.6663937356,    369.1588360903,    3230.9017890832,    75.5846078285,    65.4911139653,    2.6916586925,    0.6564529598,    0.6744159265,    3.0813956080,    0.3354207450,
    0.4474534887,    0.2325440265,    0.3279398324,    0.0781381302,    63.5170878353,    3.1054130727,    1.6746714073,    57.9840899981,    0.5123145138,    0.8902185527,
    0.3211666648,    0.9996946078,    0.2290342873,    25459.9375019558,    1.6068514428,    12.9856810626,    0.9113728156,    1.1856723906,    0.3320409038,    0.7999891285,
    0.9633910235,    279.0351688811,    8.2748328868,    0.5910014551,    1.0390929473,    0.2590701111,    1.0037904408,    1.0079609871,    164.1879703605,    3.9716457680,
    5.7628358137,    1.6239000940,    4.2067451875,    4.5688241550,    1191.9859524462,    0.5053403736,    0.2543015342,    0.3859004764,    0.4895600474,    83.2227703548,
    0.3264738939,    0.6526946964,    0.6881435357,    114.2490063554,    0.2996241762,    0.3500601041,    29.6465763676,    0.5110912420,    82.9103866757,    93.7910305385,
    3.2081674585,    24.3808113891,    74.5076772270,    0.0401241659,    89.0174956226,    20.8772365958,    15.8792719588,    0.2878645850,    0.4090582963,    0.3168551939,
    0.5816289929,    3.2485922133,    1.4809130736,    0.1674624876,    5.0770056145,    130.9181860038,    0.1030673844,    2.8355632703,    0.1755537139,    0.2055574700,
    11.7775754762,    0.2648196886,    0.0831221773,    0.1075268920,    0.1641869343,    3.0684788265,    4.1703712598,    3.9609263851,    74.5076772270,    73.4387396737,
    44991.7922521375,    46.5950323661,    694.9746818796,    46.5950323661,    0.4326074502,    1.0135480022
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 502;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    0,    17,    26,    41,    43,    51,    60,    64,    66,    67,    73,    75,    76,    77,    80,    82,    83,    86,    87,    88,
    89,    90,    93,    94,    96,    97,    102,    122,    128,    138,    140,    183,    215,    222,    223,    226,    291,    293,    295,    296,
    297,    299,    302,    303,    305,    306,    308,    309,    310,    312,    314,    315,    316,    318,    321,    324,    326,    327,    331,    332,
    333,    335,    338,    341,    342,    345,    349,    350,    351,    352,    353,    357,    362,    366,    367,    368,    369,    374,    378,    379,
    383,    384,    385,    388,    390,    393,    399,    407,    411,    412,    422,    428,    438,    475,    483,    486,    516,    519,    531,    544,
    545,    549,    567,    570,    577,    592,    600,    624,    648,    649,    651,    656,    658,    661,    662,    663,    664,    668,    670,    680,
    684,    687,    688,    690,    693,    696,    702,    718,    723,    725,    735,    737,    738,    740,    742,    743,    744,    745,    747,    749,
    753,    754,    755,    757,    758,    760,    761,    762,    763,    765,    768,    769,    771,    772,    773,    774,    779,    781,    782,    784,
    793,    797,    798,    799,    807,    808,    811,    816,    817,    818,    823,    832,    836,    837,    842,    843,    848,    850,    851,    852,
    854,    855,    856,    859,    861,    864,    867,    868,    869,    875,    878,    880,    881,    884,    885,    886,    887,    888,    889,    891,
    894,    897,    906,    908,    916,    917,    919,    925,    929,    930,    931,    938,    942,    945,    946,    948,    950,    951,    952,    957,
    958,    959,    963,    966,    967,    968,    969,    976,    979,    980,    981,    982,    983,    984,    986,    989,    992,    997,    999,    1002,
    1008,    1010,    1013,    1021,    1023,    1024,    1027,    1031,    1039,    1043,    1046,    1047,    1048,    1051,    1052,    1054,    1056,    1057,    1058,    1062,
    1065,    1066,    1069,    1073,    1075,    1077,    1078,    1079,    1080,    1081,    1082,    1085,    1086,    1087,    1089,    1091,    1092,    1093,    1097,    1102,
    1104,    1106,    1107,    1109,    1110,    1112,    1113,    1115,    1117,    1118,    1119,    1120,    1122,    1125,    1127,    1129,    1133,    1135,    1138,    1141,
    1143,    1144,    1150,    1152,    1154,    1155,    1156,    1162,    1170,    1172,    1180,    1187,    1188,    1189,    1190,    1191,    1192,    1203,    1204,    1205,
    1206,    1207,    1208,    1209,    1210,    1211,    1212,    1213,    1214,    1215,    1216,    1217,    1218,    1219,    1220,    1221,    1222,    1223,    1224,    1225,
    1226,    1227,    1228,    1229,    1230,    1232,    1288,    1292,    1304,    1309,    1310,    1311,    1312,    1313,    1314,    1315,    1316,    1317,    1318,    1320,
    1321,    1322,    1323,    1324,    1325,    1326,    1335,    1340,    1354,    1365,    1366,    1367,    1407,    1408,    1409,    1410,    1411,    1412,    1413,    1414,
    1415,    1416,    1417,    1418,    1419,    1420,    1421,    1422,    1423,    1424,    1425,    1426,    1427,    1428,    1429,    1430,    1431,    1432,    1444,    1461,
    1462,    1463,    1464,    1465,    1466,    1475,    1531,    1545,    1548,    1553,    1560,    1591,    1595,    1617,    1626,    1628,    1630,    1632,    1685,    1688,
    1695,    1699,    1717,    1718,    1796,    1812,    1813,    1814,    1818,    1820,    1827,    1829,    1831,    1835,    1839,    1842,    1854,    1855,    1856,    1858,
    1865,    1869,    1873,    1879,    1882,    1884,    1885,    1887,    1890,    1895,    1897,    1976,    1980,    1982,    1996,    2082,    2153,    2161,    2169,    2174,
    2232,    2241,    2251,    2257,    2275,    2297,    2373,    2378,    2379,    2408,    2472,    2513,    2525,    2526,    2560,    2599,    2656,    3135,    3219,    3242,
    3243,    3250,    3399,    3441,    3764,    3765,    3766,    3768,    3769,    3777,    3781,    3785,    3800,    3805,    3812,    3819,    3833,    3838,    3848,    3850,
    4004,    4006
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 24;
constexpr int N_PHYSICS_FEATURES = 65;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
    "dD",
    "dH",
    "dP",
    "HansenTotal",
    "BP",
    "deltaHvap",
    "logVP",
    "logPow",
    "logWS",
    "deltaHf",
    "deltaHc",
    "MP",
    "Flashpoint",
    "logHenrycc",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/dipolemoment_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/dipolemoment_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadeDipoleMoment
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadeDipoleMoment {
struct Model {
    using Namespace = CascadeDipoleMoment;
};
} // namespace CascadeDipoleMoment
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
