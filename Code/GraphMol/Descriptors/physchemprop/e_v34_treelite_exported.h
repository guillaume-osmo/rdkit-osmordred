#pragma once
// Auto-generated Treelite model for E (v3.4 XGBoost)
// Trees: 300, Features: 505
// Target normalization: mean=1.0043685671, scale=0.8485110829
// Library: e_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadeE {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 505;
constexpr double TARGET_MEAN = 1.0043685671;
constexpr double TARGET_SCALE = 0.8485110829;

// Normalization stats
constexpr int N_NORM_FEATURES = 505;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0308557323,    0.0065825562,    0.0091881514,    0.2619308832,    0.0069939660,    0.0052111903,    0.0045255074,    0.0191991223,    0.1275370269,    0.0382611081,
    0.0120680197,    1.5122051563,    2.6385079539,    0.0349698300,    0.6268513439,    0.0469007131,    0.3544980801,    0.0866703236,    0.0226275370,    0.2653592979,
    0.0181020296,    0.0500548546,    0.0163192540,    0.0154964344,    0.0063082830,    3.0308557323,    0.1833516182,    0.0374382885,    0.1150575974,    0.0075425123,
    0.0146736149,    0.9089413055,    1.8181568843,    0.0063082830,    0.0726823917,    0.1150575974,    0.5248217224,    3.2018650576,    1.4255348327,    0.6518102030,
    8.2686967875,    0.5315639625,    -0.2061798786,    0.5395417809,    14.6379191993,    206.4120198848,    206.0482351287,    0.1706594711,    -0.3247171087,    0.3323622190,
    0.1697454803,    1.1408257087,    2.1442688267,    10.2094164676,    -2.0612937633,    2.1629788138,    -2.0401367033,    0.3638880912,    2.7216709338,    325.3726303496,
    8.7880763431,    4.7273194530,    3.9907870553,    2.7172076330,    -0.9645335397,    23089901384180.7929687500,    11.9212500214,    5.6978955843,    1.6096196359,    0.7086851069,
    1.3351135465,    1.2242040061,    26.1603729800,    22.6895565649,    5.8739031002,    12.8331684751,    2.3298549794,    2.1847394191,    2.5142034415,    33.6165235875,
    5.3601757552,    5.7599301240,    6.9822220955,    6.6608116385,    6.0267230985,    5.2794396872,    1.3568163092,    -0.0444818068,    3.0796681541,    0.7495885902,
    0.4222435546,    2.0015085025,    0.3468184312,    0.3337904553,    4.1343293750,    56.0412487658,    0.0046626440,    0.0072682392,    0.2814042787,    0.4588590236,
    0.0039769611,    0.0061711465,    2.2447934146,    1.2059899185,    153.4021146199,    199.6749393100,    97.3653106887,    54.0073144028,    133.6627543402,    998.5927043335,
    3366.5203504275,    3562.8253013553,    6810.4704758976,    5.6853325410,    0.7665667055,    3.0240179010,    2.4946556039,    1.0228953004,    3.4539726822,    2.1042635683,
    20.6330081391,    158.7745594858,    216.3523289601,    257.5812201038,    209.2178069223,    176.6471050083,    7.7472494561,    7.6989096057,    7.5664887772,    6.3297485928,
    6.2780143637,    6.0972925643,    5.9383963830,    5.6862481522,    1.5863334279,    1.8416443266,    164.2867830898,    159.1944863802,    -0.0098051002,    0.0017121560,
    89.6788902541,    23.2560243338,    -16.2401661819,    -21.7051997063,    -16.4983874326,    4.7340749190,    -1.9553029701,    -1.9329778606,    0.2411309255,    42.3887002236,
    -3.2179111663,    -5.6529679513,    -3.2081603313,    -1.4369858860,    328.5594454626,    7.2548811426,    -36.2652605323,    -18.1219695286,    -1.7616171859,    -28.1548695436,
    -277.6392679464,    2.0387727218,    0.3278411390,    -0.0792858666,    -0.1293761621,    -0.0661755325,    -0.1067254437,    0.4793857730,    -0.4654616641,    -0.1903073483,
    -0.1646301598,    -1.4960151063,    -0.3208332905,    -1.6669358804,    -7.7770890744,    -2.5217022933,    -0.4302893098,    0.6597717377,    0.0170663477,    -0.0085884178,
    -0.0000748807,    0.0002904393,    0.7599833819,    -0.4546717938,    -0.1691581551,    -0.0593315870,    -0.1693992862,    -0.1720796067,    -0.0511500455,    49.3135626397,
    -0.7958946467,    -5.3624692759,    -1.6793349895,    -0.0071508472,    -0.0018394348,    -0.0048175372,    -0.0007619388,    -0.1203019779,    -0.0603336843,    -0.1681576190,
    0.0627090251,    -0.0044830040,    0.0285604871,    0.0062738034,    -0.0041343721,    -0.1238927130,    0.0570398661,    0.0655441882,    0.0049182185,    -0.0967891300,
    -0.0900893065,    0.0863362521,    -0.0347026688,    0.0546264108,    0.0566122144,    -0.0291381226,    -0.0861858119,    -0.0718752949,    -0.1073720822,    1.4062444724,
    1.0386372658,    0.7057830594,    1.0555973785,    1.4289180497,    0.7853938852,    0.9488315750,    1.0847857301,    0.8457310099,    0.9183495204,    1.0623381708,
    1.0934149722,    0.7041099842,    1.0761547382,    0.8693529475,    1.0491799623,    1.1637829359,    1.0137756007,    0.5103603079,    1.2913978868,    1.1020850502,
    1.0876803355,    0.9822337083,    0.8496536096,    0.7357376187,    0.6061872583,    0.4575294899,    0.3832494221,    -0.3767032237,    5.3929035763,    1.1274450859,
    3.2334304392,    1.0064896250,    5.3716933419,    1.2172253666,    11.3127779874,    5.7566387408,    11.7910455226,    21.9094464890,    3.5659329433,    2.4756754167,
    3.3655244667,    13.8376114527,    10.9013444084,    2.3446813137,    87.1250317171,    43.9537048546,    65.6088901838,    87.8536723905,    5.1817573070,    43.9583819512,
    0.9501671452,    3.5514017132,    0.2897807644,    1.4407605577,    63.3824935924,    3.9514296960,    4.0349377259,    87.0707259946,    43.9299614157,    65.5831131198,
    87.8083810125,    5.1779813957,    43.9348100340,    0.9633760374,    3.5514190453,    0.2897747326,    0.6738563143,    6.9318851539,    3.9609591637,    14.1236972024,
    22.4137410861,    0.9544706528,    0.0355183763,    5.0736423478,    6.0636313769,    25.1083379046,    0.3283163275,    0.1998329632,    0.0259188151,    3.8896050466,
    1.0041140976,    1.9171695008,    2.3236423478,    0.3926220516,    0.1139605047,    0.4865944005,    0.0030768416,    0.0198974240,    3.3099748687,    0.9819139796,
    0.7565979856,    0.0355171427,    0.4083293543,    0.3846069202,    0.0159231527,    1.1323878214,    63.4806219683,    3.9549749326,    4.0351112620,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0002742732,    0.0000000000,    1.5120680197,    0.0582830499,    2.6339824465,    0.0065825562,    0.2959407570,
    2.7351892485,    0.6268513439,    0.0039769611,    0.0410038398,    0.6379594076,    1.5774821722,    0.2925123423,    0.2653592979,    0.0000000000,    0.0918815140,
    0.0000000000,    0.0031541415,    0.1385079539,    0.0375754251,    0.0222161273,    0.0000000000,    0.0451179375,    0.1505759737,    0.1199945145,    0.0540318157,
    0.0447065277,    0.0006856829,    0.3861766319,    0.6733406473,    0.0000000000,    0.0012342293,    0.0197476687,    0.0000000000,    0.0000000000,    0.0016456391,
    0.0160449808,    0.0000000000,    0.0072682392,    0.0082281953,    0.0429237521,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0499177180,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0161821174,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0181020296,    0.0382611081,    0.0267416347,    0.0573230938,    0.0430608886,    0.0969555677,    0.0451179375,    0.0304443225,
    0.0474492595,    5.0069586657,    -0.0616075554,    0.0607645338,    7.5611044298,    0.0291742252,    0.0359011059,    1.2582966716,    0.5508629467,    0.0516402393,
    0.8774676871,    0.0531716836,    1.4244226752,    1.1738141268,    1.3016141923,    0.3733964716,    0.0704593544,    2.3555848278,    1.4213126762,    0.4906532494,
    0.2734469276,    0.0254075855,    0.4546215732,    0.7773784541,    0.2530458116,    0.0251958022,    -1.5163192540,    0.2491682721,    -2.9628537874,    2.2639728631,
    0.6840821308,    0.7785462009,    2.3659272688,    1.4914912203,    24.8651554238,    31.4068927164,    36.8902050773,    24.9574218850,    1.9887302922,    0.2200221672,
    0.0243352058,    0.0581796661,    5.6911669242,    0.4175503946,    1.4185044534,    2.8468585063,    33.7771530444,    3.1750649512,    3.4291116574,    3.7583877495,
    2.6692085363,    5.9406482378,    17.6248942772,    0.2232825386,    3.0248217224,    0.0846442945,    0.0494297276,    0.0236182371,    0.8178058853,    112.4222856555,
    13.9639189678,    0.0483648886,    0.2335116495,    1.4210039982,    5.0681875105,    0.1335890106,    0.2246404289,    1.1342999302,    0.0149906926,    0.1636754955,
    0.0699957336,    0.0212415807,    0.0684758022,    0.0495388817,    3.1009032823,    0.5352160953,    0.0072469771,    0.0625442298,    0.0952857009,    10.4543987952,
    0.2091153169,    0.1430467181,    0.0283202997,    0.1369526556,    0.0180459084,    0.0550801661,    0.1189565116,    0.0532276571,    0.0423749907,    2.1756256622,
    0.5185522359,    0.4673321346,    0.0130852119,    0.2380179660,    0.2118324191,    0.6871448162,    1.1742251783,    0.9908420187,    6.9564801152,    1.5159437561,
    6.0810502502,    5.6869265334,    0.7078852250,    2.7995380900,    0.6222042531,    1.4290071945,    59.7632611169,    3.8044976242,    0.0064454196,    0.0098738343,
    0.0075425123,    0.0015085025,    1.5898808378,    147.9632471786,    7.0316636375
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.3172792706,    0.0949088234,    0.1149688084,    0.8046859482,    0.0833369692,    0.0809654230,    0.0957479565,    0.1449989705,    0.8805036587,    0.2121918730,
    0.1233436693,    1.5944360256,    3.8313870155,    0.1959836344,    1.5787806502,    0.2527848068,    0.7315684035,    0.4781604957,    0.1514541222,    0.7942064075,
    0.1516098166,    0.3073273162,    0.1522630569,    0.1331343440,    0.0842099053,    3.1080835598,    0.6763640335,    0.2894135376,    0.4043894302,    0.0997701430,
    0.1236168252,    1.9399068943,    9.9485433928,    0.0825653376,    0.3034538638,    0.5407764825,    1.7917692628,    6.1102376999,    6.3192902416,    1.6851349909,
    3.6437738949,    0.6182877983,    1.4113686952,    0.1456138776,    10.1233256832,    107.8946412584,    107.6708053971,    0.1400938791,    0.1520200161,    0.1520559422,
    0.1220780644,    0.3576454949,    0.5402943316,    1.6630073105,    0.2057898747,    0.2414002227,    0.2790507503,    0.6258883063,    0.6300685998,    297.0444890539,
    4.5314024601,    2.8307574848,    2.8952663349,    2.4448795043,    0.9649669878,    1284791727224731.2500000000,    282.3920925167,    7.8497349512,    4.1755697875,    2.2735506608,
    5.3298596573,    4.8531792909,    25.3959501207,    19.1079958221,    8.5493920451,    15.7999957569,    5.0526744708,    6.1791767171,    6.8975010796,    36.4783185629,
    12.5839320731,    8.6384101626,    9.3624921567,    10.1775833473,    15.9687030821,    9.7161818662,    2.6530819951,    3.0509964363,    3.6045131866,    1.2900069932,
    0.9906939516,    2.1052589184,    0.7296231893,    1.3052677163,    3.5111850532,    28.8658695942,    0.0920908693,    0.0926648679,    0.8713579811,    1.2691029453,
    0.0784559127,    0.0783138775,    0.2359477531,    0.0982358669,    113.8067262256,    231.7467237214,    196.2087548031,    160.2372467614,    193.8498400368,    1013.4712322549,
    3436.4834484726,    3999.5757776985,    9724.0585088553,    3.4141659769,    2.1829865326,    0.8373374148,    0.7474811769,    0.8797586672,    3.2401001511,    3.0166292132,
    22.8713123939,    357.2867644772,    53.9782845656,    44.8141801042,    58.1635963946,    58.1950130866,    0.7825292997,    1.0440919188,    1.3417607015,    0.8423052473,
    0.5223397504,    1.0573341742,    1.2615138006,    1.6094662772,    0.6996100072,    0.4903718494,    11.1502694817,    38.0633064499,    0.2227355146,    0.1282151914,
    60.3944390567,    25.1675622380,    35.4141757780,    37.1523698599,    41.0201511115,    6.1685120719,    3.9766044582,    5.8149323990,    4.2842504973,    44.1902121265,
    16.8554352804,    20.5985094838,    17.6265042924,    15.9869689947,    401.4368780870,    39.8882880441,    131.4476734471,    147.3079033964,    130.7906571283,    448.7192186928,
    603.7006884450,    1.8459400216,    1.0401203969,    0.9688473689,    0.8400454834,    0.7249040011,    0.5783878067,    1.4603481165,    1.5473411136,    1.3518279124,
    2.8330251711,    4.7126901377,    2.8535950240,    15.0248888933,    14.4265445482,    14.6734460624,    14.4223160416,    12.7297371757,    0.0145563143,    0.0094741782,
    0.0057843762,    0.0077045491,    0.6630812408,    0.9823353983,    1.5883675923,    0.0896470126,    0.8314765396,    1.0025466569,    0.9825850091,    9.1543101552,
    4.4019569916,    8.5163381810,    13.3366592324,    0.0387011319,    0.0371681915,    0.0694116719,    0.1590196298,    0.3618537700,    0.3846434308,    0.3693731465,
    0.4845945313,    0.2027153231,    0.2925288951,    0.3257511999,    0.1828157403,    0.2147536459,    0.3658687835,    0.1889536503,    0.4649142642,    0.2139930582,
    0.1920557452,    0.3620971470,    0.1460009270,    0.1925490610,    0.1959592783,    0.1714249321,    0.1871239640,    0.2019333728,    0.1750955210,    0.3035056241,
    0.3459580203,    0.3115368859,    0.3474107271,    0.3753741699,    0.4252027498,    0.4104087840,    0.4610097587,    0.9935755332,    0.6658391191,    0.3284091315,
    0.2996050823,    0.5769711110,    0.6069724037,    0.3184386197,    0.3371119787,    0.3755694408,    0.3230932984,    0.6150007592,    0.3462106905,    0.2266753204,
    0.2610396466,    0.2857970427,    0.3551478699,    0.4512045220,    0.5064258704,    0.4890881087,    0.0877908423,    0.0918225649,    1.1562789154,    0.6463815201,
    0.5068138338,    0.1477131066,    2.1940208873,    0.3160475548,    7.7145703973,    0.6909361246,    1.6361789245,    2.4420936996,    0.2809027427,    0.0779514925,
    0.3031201083,    1.4276265868,    0.3458702841,    0.6407540892,    115.4114703996,    57.8038867025,    86.3655188888,    115.6660286806,    2.7413321499,    57.8005089221,
    0.9824021334,    0.8901356351,    0.0724586577,    0.7331719919,    61.0201770414,    1.2230624498,    1.2904803340,    115.4263536617,    57.8112349917,    86.3784584210,
    115.6805247765,    2.7435337192,    57.8077355079,    1.0094894804,    0.8902003879,    0.0724252609,    0.6938039399,    3.6163531343,    1.2275527344,    8.4597107919,
    16.0229314173,    1.1302262804,    0.2007257610,    5.5589576008,    5.6081409148,    15.9830993307,    0.1660993645,    0.1086141951,    0.1760873842,    3.9273457246,
    1.4423401523,    1.8861583456,    3.8085024128,    1.0008857204,    0.4400884474,    0.3634899011,    0.0277349528,    0.0819230614,    2.8069762584,    1.4044774071,
    0.0482800819,    0.0248264751,    0.8344240150,    0.1498901645,    0.0273355912,    0.0344792041,    61.0588328501,    1.2302621657,    1.2937151300,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    0.0165589236,    1.0000000000,    1.5944370695,    0.2701632204,    3.8304740470,    0.0825439238,    0.7669603472,
    3.1660407181,    1.5787806502,    0.0671542343,    0.2441694903,    1.0264075491,    1.9421566304,    0.9792884768,    0.7942064075,    1.0000000000,    0.3490523543,
    1.0000000000,    0.0651251535,    0.4180032084,    0.2139230556,    0.1641150855,    1.0000000000,    0.2400391375,    0.5054106021,    0.4103710374,    0.2753124851,
    0.2520964408,    0.0261765693,    0.9225735104,    0.9048156516,    1.0000000000,    0.0651898068,    0.2951324664,    1.0000000000,    1.0000000000,    0.0405330844,
    0.1449093846,    1.0000000000,    0.0926648679,    0.0947803335,    0.2334966578,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    0.3066796038,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.1509207934,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    0.1835270834,    0.2121918730,    0.1858197732,    0.2675642726,    0.2154479957,    0.3575938234,    0.2253041458,    0.1765307475,
    0.2548440620,    6.1640067156,    1.6842394750,    0.3556416895,    10.5976834029,    0.3720273957,    0.3315960194,    4.5235759281,    0.6250270547,    0.2794740997,
    3.1908758597,    0.3165022559,    3.7483085393,    3.5153708845,    0.9166625374,    0.5483441459,    0.3950634330,    4.0150150811,    3.7392009220,    0.0591289671,
    0.1666219689,    0.0645088238,    0.3208473911,    0.3013099291,    0.2673001184,    0.0156713915,    4.8089519999,    0.1959361481,    2.0676965955,    0.5649424649,
    0.1346032886,    0.1336432221,    0.8658282661,    0.7437192650,    9.3290012149,    11.2801186471,    18.3802434753,    11.6535754670,    2.2173903337,    0.6297855545,
    0.1723685209,    0.2568167380,    5.2270289828,    0.2990791492,    2.4566148756,    3.4794373222,    74.2155676147,    0.7456131051,    1.0725982099,    1.8717182459,
    2.8795229675,    1.8095438500,    12.3813219172,    0.2228578303,    2.2621951845,    0.0360685024,    0.0268659897,    0.0191365237,    0.2105040976,    75.2667991108,
    308.7234578939,    0.2754757509,    0.6197903446,    2.1268385634,    4.0795518197,    0.2955847718,    0.1592438462,    0.7397226679,    0.2947891166,    0.5450380304,
    0.5991130640,    0.2309730228,    0.3623915685,    0.3012503196,    4.3929536957,    2.0962214079,    0.1548588374,    0.5447401175,    0.6313149755,    12.1806365110,
    0.5626343392,    0.3744935059,    0.2375917778,    0.5202601653,    0.1813193109,    0.2698765360,    0.6041751626,    0.2289949319,    0.3647990649,    2.3045976924,
    0.7908926806,    0.6086421547,    0.1339705629,    1.2804201116,    0.3526746618,    0.7213287152,    0.8348403844,    0.8241006190,    3.9765177445,    0.2781118760,
    1.6526310421,    1.1516252050,    0.1931086940,    0.4761802474,    0.3510374146,    0.3558654702,    32.5160436125,    0.5400446909,    0.0897190908,    0.1016114565,
    0.0865194940,    0.0388101390,    0.8004026433,    74.0337692301,    4.0847746003
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 502;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    0,    1,    13,    15,    21,    25,    30,    34,    35,    38,    50,    66,    67,    73,    78,    80,    83,    84,    85,    89,
    94,    98,    99,    108,    110,    111,    130,    134,    141,    149,    152,    155,    160,    161,    172,    184,    211,    215,    216,    220,
    291,    293,    294,    295,    296,    297,    299,    302,    303,    304,    305,    306,    308,    310,    312,    313,    314,    316,    318,    319,
    322,    324,    327,    329,    332,    333,    336,    338,    340,    342,    346,    347,    348,    349,    351,    353,    361,    363,    372,    374,
    375,    378,    379,    382,    386,    389,    390,    391,    394,    398,    402,    409,    412,    418,    419,    422,    441,    445,    449,    459,
    468,    484,    513,    516,    544,    546,    549,    551,    567,    574,    579,    583,    594,    643,    650,    653,    654,    659,    662,    667,
    672,    678,    687,    688,    689,    690,    698,    699,    700,    707,    715,    717,    718,    719,    723,    724,    732,    737,    745,    749,
    750,    751,    753,    754,    755,    760,    761,    764,    767,    768,    771,    773,    775,    776,    777,    778,    782,    783,    785,    797,
    799,    804,    806,    810,    811,    812,    814,    815,    817,    832,    833,    835,    838,    842,    843,    845,    846,    848,    849,    850,
    854,    857,    859,    862,    864,    869,    880,    881,    884,    903,    904,    906,    908,    917,    920,    928,    945,    949,    950,    951,
    954,    961,    962,    963,    966,    968,    972,    982,    995,    1000,    1008,    1012,    1013,    1014,    1030,    1038,    1040,    1045,    1047,    1053,
    1055,    1061,    1069,    1070,    1073,    1077,    1080,    1083,    1090,    1096,    1101,    1107,    1113,    1125,    1127,    1133,    1136,    1140,    1141,    1142,
    1143,    1144,    1145,    1146,    1147,    1148,    1149,    1150,    1151,    1152,    1153,    1154,    1155,    1156,    1157,    1158,    1160,    1161,    1163,    1164,
    1165,    1171,    1172,    1173,    1174,    1175,    1176,    1177,    1178,    1179,    1180,    1181,    1182,    1183,    1184,    1185,    1186,    1187,    1188,    1189,
    1190,    1191,    1192,    1193,    1194,    1195,    1232,    1256,    1276,    1280,    1281,    1282,    1283,    1284,    1285,    1286,    1288,    1289,    1290,    1293,
    1294,    1295,    1296,    1297,    1298,    1299,    1306,    1308,    1329,    1332,    1333,    1340,    1348,    1350,    1356,    1372,    1396,    1397,    1398,    1399,
    1400,    1401,    1402,    1403,    1404,    1405,    1406,    1407,    1408,    1409,    1410,    1411,    1412,    1413,    1414,    1415,    1416,    1417,    1418,    1419,
    1420,    1421,    1422,    1423,    1424,    1425,    1426,    1427,    1428,    1429,    1430,    1431,    1432,    1433,    1438,    1439,    1440,    1441,    1442,    1443,
    1444,    1445,    1446,    1447,    1448,    1461,    1462,    1463,    1464,    1465,    1466,    1467,    1468,    1469,    1470,    1471,    1472,    1473,    1474,    1475,
    1476,    1477,    1478,    1479,    1480,    1481,    1482,    1483,    1484,    1485,    1486,    1511,    1512,    1531,    1534,    1547,    1574,    1595,    1609,    1632,
    1638,    1687,    1698,    1699,    1708,    1710,    1716,    1735,    1799,    1805,    1806,    1808,    1814,    1818,    1829,    1832,    1844,    1850,    1853,    1855,
    1868,    1869,    1879,    1880,    1885,    1887,    1891,    1894,    1957,    1966,    1970,    1973,    1977,    1978,    1981,    1983,    1993,    1998,    1999,    2001,
    2005,    2007,    2009,    2149,    2154,    2165,    2166,    2168,    2177,    2210,    2216,    2242,    2248,    2251,    2254,    2268,    2271,    2274,    2319,    2346,
    2365,    2373,    2378,    2379,    2405,    2407,    2486,    2513,    2526,    2669,    3041,    3077,    3078,    3102,    3103,    3108,    3157,    3230,    3277,    3399,
    3401,    3437,    3611,    3637,    3765,    3766,    3768,    3769,    3770,    3780,    3781,    3785,    3796,    3798,    3800,    3812,    3819,    3848,    4001,    4020,
    4069,    4071
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 3;
constexpr int N_PHYSICS_FEATURES = 0;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/e_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/e_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadeE
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadeE {
struct Model {
    using Namespace = CascadeE;
};
} // namespace CascadeE
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
