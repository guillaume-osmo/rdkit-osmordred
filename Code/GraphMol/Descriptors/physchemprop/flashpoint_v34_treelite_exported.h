#pragma once
// Auto-generated Treelite model for Flashpoint (v3.4 XGBoost)
// Trees: 300, Features: 588
// Target normalization: mean=377.0336211258, scale=70.1664587059
// Library: flashpoint_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadeFlashpoint {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 588;
constexpr double TARGET_MEAN = 377.0336211258;
constexpr double TARGET_SCALE = 70.1664587059;

// Normalization stats
constexpr int N_NORM_FEATURES = 588;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0026062877,    0.0151490471,    0.2050822610,    0.0902427105,    0.0195471575,    0.0058641473,    0.0047238964,    0.0084704349,    0.0490307868,    0.0474018570,
    0.0052125753,    0.0078188630,    0.0086333279,    0.0091220068,    1.4533311614,    2.5930933377,    0.0245968399,    0.4577292719,    0.0550578270,    0.3046098713,
    0.3707444209,    0.5851115817,    0.2138784818,    0.0990389314,    0.2291904219,    0.0076559700,    2.4699462453,    0.0785144160,    1.6041700603,    0.5999348428,
    1.6064505620,    0.0070043981,    0.1641961231,    2.8946082424,    0.4899820818,    0.6369115491,    0.6079165988,    8.0323268648,    0.5051401231,    -0.1095632923,
    0.5283354158,    13.6932665499,    175.7857849813,    162.4095478091,    175.4885431112,    65.1382961394,    0.1631967412,    -0.3279081495,    0.3343296662,    0.1637005926,
    1.1902873484,    1.7257478159,    2.1008101789,    23.8235313234,    10.2104162436,    2.1163561564,    -2.0075227111,    5.9759496003,    0.3284129065,    1.9968346393,
    2.8570751383,    228.9626007978,    7.1699898379,    7.5782953256,    -0.7760810488,    4.6930902693,    73.1879392807,    0.5784281297,    2.1495832189,    1.2997403208,
    1.2380041270,    18.7672207539,    6.5275421755,    5.0123604210,    10.2120496018,    1.1637433104,    5.0111029620,    12.4384775907,    4.4703881894,    16.3262372417,
    28.6822055709,    3.3760280806,    4.8889585751,    8.5086012263,    5.0958439508,    13.2827236960,    6.2714546962,    5.0027833993,    4.1794724955,    1.1627601392,
    0.0087726175,    3.9330510093,    0.0952923929,    0.2977683662,    4.0049375813,    2.3676595765,    48.1116867079,    0.0161264050,    0.3101482326,    0.0081446490,
    0.0863332790,    0.0047238964,    1.1896443998,    120.9846430130,    160.5663013529,    140.8576033639,    149.1795495308,    853.2878318944,    2485.5275105871,    585.1734276260,
    36.2960834329,    37.3341518126,    3.0120136809,    2.2699516141,    0.5398790282,    3.2005039574,    2.3107491051,    1.3786475656,    0.7984369491,    3.0866572865,
    16.4457715288,    13.1297230655,    6.6992800936,    250.3255007127,    166.4815829506,    135.8003075338,    7.7499063006,    7.7354482289,    7.6883430814,    6.5349710997,
    3.9782283938,    5.9942910038,    1.2910644992,    0.9500773263,    0.8002828904,    164.6350294960,    160.3890874907,    163.5602935842,    121.2900653890,    0.3748616750,
    0.0098275741,    0.0006230862,    -0.0066015129,    3.5346935430,    -20.0779020933,    -6.2543209201,    3.2313419683,    -3.7201948244,    -0.3675583475,    7.1741807374,
    -3.0090386206,    -1.0542043838,    -2.4994044970,    295.3192925669,    3.2832461984,    -1.0677268598,    -43.3360854714,    -11.9645373959,    -165.0524107473,    -62.9611438356,
    -29.8066698607,    -284.3301007492,    -0.0559516101,    -0.2160188377,    -0.0222753960,    -0.5242782107,    -0.0038152680,    2.6738678011,    -0.0711846480,    0.4371980087,
    -0.3421288907,    -0.1057425109,    -0.2401509606,    -0.4006967375,    -0.0904725071,    -2.3640817830,    -2.8399493301,    0.0170949750,    -0.0085176093,    0.0002399933,
    0.0000712709,    -0.0000302824,    3.2022526367,    0.7255619128,    0.0424584381,    -0.4644114333,    0.1077198225,    -0.0814613213,    -0.1881527752,    -0.2357493829,
    0.0076312866,    -0.1095695116,    -0.3754087648,    -0.7578875040,    -0.1160873098,    79.9760529781,    -0.7516164478,    -9.7071479319,    -6.2017215770,    49.2839596836,
    -1.5146713642,    4.6584449263,    0.0095675350,    0.2804531620,    -0.0078977416,    -0.1149627774,    -0.1087917244,    0.0151632921,    -0.0225642396,    -0.0009529907,
    0.0324002387,    -0.1568121808,    0.0866498231,    -0.1266911410,    -0.0821913856,    0.0229762758,    0.0029355549,    -0.0081807981,    -0.0712886270,    -0.0073313168,
    0.0194530877,    -0.0393973563,    -0.0328644786,    -0.0924281821,    -0.0247201475,    -0.0888963045,    -0.0313423088,    -0.1106791068,    -0.0883539075,    -0.0502248772,
    -0.0161710445,    0.0685036096,    -0.0615085099,    -0.0647809017,    0.0100914001,    1.4083319297,    0.9955748276,    1.0437969014,    1.0026227070,    0.7796318127,
    0.6359469323,    0.7335537430,    1.1297850207,    0.8209008828,    1.1767256390,    0.9326288816,    0.2785012418,    0.5120733979,    0.8805370720,    0.7046981494,
    0.9282714139,    0.9286548684,    1.0721224444,    0.8787168139,    1.1332925668,    1.0905751230,    0.8618939011,    0.8592268751,    1.0768518666,    1.0698674003,
    1.0635512033,    1.1216209183,    0.8077297047,    0.6551059556,    0.3723781343,    -0.3703640770,    5.3609000141,    1.0074608745,    11.2335924053,    5.7526899594,
    23.3288022723,    15.8448720843,    2.4911952326,    10.9407316513,    -0.7655715133,    6.4466908449,    0.3659358972,    0.2167802662,    1.9433132432,    0.0916354428,
    0.0127498022,    0.4925701999,    0.2476533979,    0.1484259066,    0.0489081981,    63.9865907117,    128.1897080837,    9.1115659621,    63.9871067165,    0.0000000000,
    3.3107624834,    0.3094494261,    1.2422276784,    45.8265714523,    3.5076938099,    3.6567708169,    532.4199381007,    81.7723097452,    40.8819966022,    60.7513913922,
    81.7723097452,    5.9168439222,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    1.4531682684,    0.0814464897,    2.5891839062,    0.0086333279,
    0.2949991855,    2.1751099528,    0.4577292719,    0.0097735788,    0.0568496498,    0.5318455775,    1.1135364066,    0.1782049194,    0.2138784818,    0.0000000000,
    0.1005049682,    0.0000000000,    0.0021176087,    0.0851930282,    0.0177553347,    0.0345333116,    0.0000000000,    0.0298094152,    0.0845414563,    0.0837269914,
    0.0633653690,    0.0133572243,    0.0000000000,    0.1806483141,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0006515719,    0.0187326926,    0.0000000000,    0.0127056524,    0.0187326926,    0.0346962046,    0.0117282945,    0.0026062877,    0.0185697996,    0.2291904219,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0001628930,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0667861215,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0133572243,    0.0000000000,    0.0000000000,    0.0000000000,    2.8860325701,    0.1124637947,    0.1236388158,    -0.0535833973,    2.7032100082,    -0.0671658580,
    0.2566213695,    0.0816209399,    0.5404033473,    0.4084797093,    0.5736851067,    0.7102653950,    -0.0288165014,    0.5005723129,    1.2836918429,    0.7716939134,
    2.0767647188,    4.7910619402,    0.0661606639,    0.6402119945,    0.2035845980,    0.5524342346,    9.3999256626,    0.2945769155,    0.4731659131,    0.4896780626,
    0.2087272310,    0.0242933205,    0.8180733691,    0.0399990411,    0.0295893778,    0.0095371856,    1.3661067728,    2.1747735487,    2.9851130080,    3.5335808023,
    52.9610373910,    0.7877223406,    0.3060099566,    0.4811089896,    0.6533298787,    0.7354894839,    0.7621163957,    1.4977919934,    1.0981744980,    32.7525608415,
    27.8908127350,    24.0702441822,    23.2647564479,    4.3513080848,    5.1675828862,    0.0598270600,    0.1723436068,    0.0645324865,    1.0017913269,    0.0905395800,
    0.2158189925,    13.4564261280,    2.6230308090,    2.9646651167,    0.0086333279,    0.2455981691,    30.8906629744,    1.2661671282,    0.0450892545,    0.2304271859,
    0.0842134719,    0.4425128581,    42.3465946679,    102.6658709888,    0.1090657376,    0.0206521457,    1.2210037899,    0.3574386917,    4.2167064835,    2.8329600407,
    0.5278272501,    0.1386981501,    0.0145209099,    0.2210379927,    0.1482904812,    1.0599856417,    0.7151734403,    0.4379130358,    0.0185814792,    0.0174600610,
    0.0334206794,    0.3590081880,    0.1727097272,    0.0363177781,    0.2168814278,    0.0090407973,    8.5384304089,    0.3116142694,    2.0978986806,    -0.0019476281,
    0.0438869039,    0.1057018855,    -0.0036288955,    0.0109189133,    2.4600296714,    0.1048995588,    0.1191112320,    0.1618113699,    0.5602055709,    0.9697548461,
    0.7636626486,    5.7772972797,    7.3515825045,    8.0201412071,    5.5922546601,    0.3737290423,    1.4510795814,    2.3307420299,    8.6456172771,    1.2002509286,
    1.4498097446,    2.2326259274,    0.5794521922,    3.7318575963,    312.7334167123,    1.5156746051,    0.2179604539,    0.1039257208,    0.0324157029,    0.0477276429,
    0.0697181951,    1.3901987763,    127.5138786236,    5.8536124876,    0.7588927619,    0.5779821059,    1.0918721891,    1.4735875489,    0.9091616533,    0.1771574432,
    0.3873235365,    17.0775341232,    7.0457897149,    6.7471235299,    20.3888735904,    195.2242872156,    63.8338813148,    1.0105456302,    2.5101647494,    -2.3641633375,
    -313.5769694304,    -5288.2159641402,    26.2420570418,    1.3901987763,    0.7588927619,    5.8536124876,    0.5779821059,    0.9091616533,    0.1771574432,    1.0918721891,
    1.4735875489,    127.5138786236,    2.3150680979,    0.9671819215,    41.8293745134,    0.4753037523,    1.0752330362,    0.1136522124,    1.2737768987,    2.1772254436,
    19539.4025457648,    1.1518372857,    9.6574057957,    0.8893697026,    1.3372763827,    0.2377924057,    1.4989860295,    2.0534721026,    212.0688537749,    5.5187210548,
    0.5083937346,    0.9123072861,    0.1719190876,    0.9085604002,    1.1478981744,    111.4194318512,    3.8836667910,    6.1004555622,    1.1303183313,    6.4991254053,
    8.6992294917,    894.8503859268,    0.6302526047,    0.1397614250,    0.6336062302,    0.8539665466,    81.3942199357,    0.2052993021,    1.0516888104,    1.3607927030,
    125.1462776111,    0.2107952476,    0.2649093747,    21.8381417458,    1.6164544025,    138.8143292407,    188.8341967822,    4.0938930268,    48.1116867079,    164.3189244770,
    0.2797602697,    172.3234967802,    46.0083685737,    31.8784696559,    1.3729674942,    1.8420300783,    1.4268303633,    2.7057907139
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.0509852423,    0.1729326677,    0.5352535899,    0.3663669160,    0.1701136235,    0.0784572813,    0.0709039291,    0.0968299774,    0.2955503570,    0.2412184887,
    0.1081717318,    0.1018038116,    0.1101927361,    0.1094114686,    1.4544940427,    3.8885673093,    0.1718435237,    0.9069585606,    0.2823442388,    0.6384512971,
    0.7437841129,    0.7568204508,    0.6452777521,    0.3751058557,    0.7327901764,    0.0960535577,    2.9197666823,    0.4813099171,    1.6054016393,    1.4216486426,
    7.3079826860,    0.0853294936,    0.7832846403,    5.0648637061,    1.3707039923,    1.1971130394,    1.4178518388,    3.3705160419,    0.5330372562,    1.2834117999,
    0.1304960464,    8.3753540079,    76.6519867740,    72.1651497298,    76.4839516891,    29.1370974709,    0.1382761163,    0.1429806943,    0.1430231076,    0.1212059202,
    0.3694495505,    0.4586231063,    0.5282084435,    18.2989396522,    0.3250275419,    0.2252652269,    0.2434304081,    1.4286618070,    0.5684029926,    0.3893310269,
    0.5992119704,    194.8296767590,    3.3936776314,    3.3503253616,    0.8068257373,    3.7018591366,    31.5354692838,    2.1313025819,    4.3953694104,    3.2254479507,
    4.3034235185,    14.7999446847,    7.5831986992,    7.0542685234,    12.1910007597,    2.9514580435,    11.0231488594,    11.7790971387,    5.8647739270,    17.8847313778,
    25.5095330830,    7.2423674633,    6.7802159686,    10.2485264618,    8.7716557305,    16.4019211142,    9.4461347096,    14.1555318260,    6.7139904094,    2.2993879450,
    2.6271828822,    5.6740598806,    0.3456037045,    0.8488735603,    3.7097764149,    1.7614209063,    21.8664824523,    0.1429242717,    0.6796171135,    0.0916738764,
    0.3299274953,    0.0709039291,    0.1003547574,    80.3017415941,    139.0623289774,    167.2193528292,    142.0802290540,    617.2550629508,    2523.3339903513,    1279.1087081390,
    17.2430537572,    47.0660665168,    3.8455142759,    3.7817003377,    2.4923247890,    0.8284032656,    0.6799418109,    0.7391541148,    0.8060619130,    4.3336368659,
    38.2023050670,    24.3260820840,    15.9666701127,    41.2374476314,    53.5993412085,    52.6379364463,    0.8181815401,    0.4420673294,    0.9410897141,    2.7649658070,
    3.6731402575,    1.2095046697,    0.4091372082,    0.4268016126,    0.4686799784,    9.4400333791,    15.2236549783,    24.0156773863,    79.0346168260,    0.3068970982,
    0.1519418501,    0.1544551068,    0.1509740443,    25.1171569426,    31.2405986864,    32.4414937135,    3.8465764324,    4.6322296750,    4.1796967127,    18.2814858112,
    15.2668118774,    19.9605332608,    15.8819041920,    367.1208046049,    35.8212327301,    116.9186439174,    136.6835138995,    94.7163929114,    626.5958520606,    521.2472261195,
    93.0374159481,    447.4490478306,    0.3077203618,    0.6923384624,    0.5505967799,    1.2927690381,    0.8743953130,    2.0908772662,    0.4664131889,    1.3063832718,
    1.1210743446,    1.2530657465,    0.9066036305,    2.2341780826,    2.2399001427,    6.5298061820,    13.9193562265,    0.0148020022,    0.0098463533,    0.0050246584,
    0.0049232310,    0.0069763846,    1.4072004281,    0.6683342956,    0.6849861315,    0.8274462398,    0.1403910871,    0.0963753869,    0.3602887821,    1.2168107333,
    1.1330397588,    3.9519109239,    8.0638164729,    12.7858176629,    9.8112515627,    189.3728298600,    21.9900237069,    52.2173920131,    80.2466480466,    8.2381587698,
    4.1858587565,    17.3435312888,    0.0362605185,    0.2168658562,    0.1270879756,    0.3231550429,    0.4016596484,    0.5535225877,    0.1706058136,    0.2402446888,
    0.3360132376,    0.1565932523,    0.2222042475,    0.1580779119,    0.3089449341,    0.3716594019,    0.1624022768,    0.4275662095,    0.3351754340,    0.4271956856,
    0.4773647302,    0.1665794352,    0.1343301423,    0.1781559105,    0.1261346738,    0.3473111730,    0.1379115823,    0.2430368107,    0.3317573513,    0.1533264367,
    0.2781298881,    0.3843358387,    0.1840684090,    0.1969747096,    0.2428746796,    0.2960154430,    0.3337799427,    0.3476647047,    0.3740124484,    0.6810760543,
    0.7681350117,    0.3269050881,    0.3128357668,    0.7227303516,    0.3561059072,    0.4097792022,    0.4377341143,    0.9519924298,    0.7571400518,    0.8558622362,
    0.3048777159,    0.2474567366,    0.3632028909,    0.7533729601,    0.3005609114,    0.2392606511,    0.3102486763,    0.3511846645,    0.3673891724,    0.3316826649,
    0.2516422278,    0.2240015387,    0.4010170527,    0.4849613708,    0.0902388449,    0.0920776200,    1.1392005347,    0.1538202522,    7.8441123613,    0.0726835335,
    18.5264009867,    2.2527934457,    0.0661464638,    0.2152947840,    0.8587560227,    3.3229164837,    0.1585419769,    0.1061473598,    1.8350390022,    0.1338885530,
    0.0579294499,    0.0496659638,    0.1528781362,    0.1066543773,    0.0512308384,    71.4569740534,    143.5331676495,    5.0153671869,    71.4565303661,    1.0000000000,
    0.7127051179,    0.0673824341,    0.6382722867,    36.4057877588,    0.9279998036,    1.1217156078,    1333.0938624244,    100.1386486838,    50.0683528360,    72.2460379369,
    100.1386486838,    2.6172653797,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.4544888070,    0.3045179579,    3.8880724422,    0.0976532203,
    0.7860110699,    2.9264969773,    0.9069585606,    0.1093551902,    0.2885555221,    0.8086642108,    1.5271803127,    0.7957211498,    0.6452777521,    1.0000000000,
    0.3455411262,    1.0000000000,    0.0555921068,    0.3270017224,    0.1427310634,    0.2160971687,    1.0000000000,    0.1991776860,    0.3625943568,    0.3320733895,
    0.3026598898,    0.1356148377,    1.0000000000,    1.0927548736,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    0.0255175894,    0.1391371148,    1.0000000000,    0.1269955288,    0.1493024124,    0.2260195119,    0.1076603066,    0.0509852423,    0.1420551933,    0.7327901764,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.0127619139,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.3440362196,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    0.1344083265,    1.0000000000,    1.0000000000,    1.0000000000,    3.0579543947,    0.7708345259,    0.6545461474,    0.7252245007,    5.7205996901,    0.5215124087,
    1.3216590380,    0.6859150819,    2.3694268158,    3.1425040405,    0.6061980359,    1.8475204554,    0.1350219463,    2.3085675783,    0.9241289928,    0.8800033858,
    3.7572497153,    5.3600285711,    0.3877740377,    2.3504776374,    0.1255673193,    0.0644350853,    7.6944340770,    0.1034280833,    0.0173469918,    0.3028581808,
    0.2126138576,    0.0159776999,    0.1221408141,    0.0464025448,    0.0495155185,    0.0665396314,    0.2879407660,    0.4947566167,    0.5543454851,    0.7741957514,
    26.3473505742,    0.1318134646,    0.0994238315,    0.1322481258,    0.1260774575,    0.1192921554,    0.1296797533,    0.7769880306,    0.6929117067,    15.0585581255,
    12.9482238953,    10.1930392428,    9.6290255464,    3.9597693264,    5.3919579983,    0.5582607002,    0.4035307023,    0.2741967108,    1.7493580977,    0.1596028207,
    0.2109866555,    42.6674505492,    0.4838761572,    0.6703184131,    0.0925137479,    0.2326834734,    27.2046198317,    1.0135120020,    0.0971454729,    0.1228733053,
    0.0368983699,    0.1625802359,    10.3798734802,    66.8595808777,    0.4213265748,    0.0878161480,    1.2958751820,    0.4974365640,    2.9419240657,    3.4151844860,
    0.9515349673,    0.2990016291,    0.0559132549,    0.1503358748,    0.1559805293,    0.7406114493,    1.2770169230,    1.2183748235,    0.3489628232,    0.2260623561,
    0.2643638477,    1.7347263306,    0.9616508451,    0.6536480929,    0.7386675228,    0.1971436497,    8.5598514312,    0.8260384090,    2.2033812402,    0.0377178333,
    0.2427836360,    0.5553299664,    0.1730081461,    0.1280576243,    2.3755837602,    0.2952819330,    0.4830221655,    0.2849259748,    0.4550722696,    0.5953508697,
    0.6301236418,    2.7463055806,    33.7527027145,    1.8686740830,    1.1642527692,    0.1106613152,    0.3507040268,    1.3124557324,    1.0808812554,    0.8564587694,
    0.1166007306,    0.3461218969,    0.2065310868,    0.5690292122,    1228.1054962948,    1.3364588782,    2.9894398585,    0.4611817561,    0.2099299347,    0.2517299004,
    0.2944235514,    0.6183974937,    57.2679081521,    2.7503809479,    0.6255107493,    0.3758196875,    0.2856431715,    0.0759287776,    0.4986563189,    0.2868230338,
    0.1161280871,    1.5727038841,    4.4575677297,    4.0519413496,    3.5651192758,    110.6583970805,    26.1770035671,    2.5311215062,    1.9437969264,    2.0239416278,
    378.6195103298,    2948.2477629219,    89.5104391761,    0.6183974937,    0.6255107493,    2.7503809479,    0.3758196875,    0.4986563189,    0.2868230338,    0.2856431715,
    0.0759287776,    57.2679081521,    2.9959141935,    1.5220720234,    51.3581893743,    0.6173451220,    1.1761456862,    0.3452532328,    0.8118898714,    0.2280984543,
    23552.3533886227,    1.3360161645,    11.9731291256,    0.9554058597,    1.2651152254,    0.4338379775,    0.6922479258,    0.9211578964,    264.3497143882,    6.9779949249,
    0.6707797340,    1.1141707999,    0.3837730555,    0.8777111906,    0.9720580012,    134.3837623032,    4.3258451776,    6.2099714929,    2.2121714237,    3.6062740327,
    4.2205339484,    1074.9529671448,    0.6821470431,    0.3141279922,    0.4445415405,    0.5606646361,    87.2912097009,    0.4263665048,    0.7033836758,    0.7846336481,
    119.5141599940,    0.3731325158,    0.4338472526,    39.9907510847,    0.4644659446,    68.5913115351,    86.5253672749,    2.8499745979,    21.8664824523,    71.9690861006,
    0.0378696881,    77.7674523541,    20.7102357396,    14.3169770380,    0.2597551214,    0.3388701746,    0.2624877086,    0.4938234135
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 501;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    7,    14,    15,    16,    17,    19,    22,    24,    26,    27,    30,    34,    42,    50,    66,    67,    73,    78,    80,    82,
    83,    86,    89,    93,    97,    109,    111,    114,    122,    155,    158,    161,    214,    215,    220,    232,    233,    291,    293,    294,
    295,    296,    297,    298,    299,    300,    302,    303,    304,    305,    306,    307,    308,    309,    310,    313,    314,    315,    316,    317,
    318,    319,    321,    322,    332,    335,    337,    342,    343,    345,    347,    349,    350,    351,    353,    355,    365,    366,    367,    370,
    374,    375,    378,    380,    382,    384,    385,    386,    389,    390,    391,    392,    401,    418,    419,    421,    422,    427,    438,    470,
    474,    500,    516,    544,    545,    546,    565,    573,    583,    587,    624,    630,    645,    646,    650,    652,    654,    657,    659,    665,
    673,    674,    676,    688,    690,    691,    696,    697,    699,    702,    704,    709,    726,    728,    729,    732,    735,    736,    739,    741,
    743,    744,    746,    752,    754,    756,    760,    762,    765,    770,    771,    774,    775,    777,    778,    779,    781,    784,    791,    792,
    796,    798,    805,    807,    812,    817,    821,    822,    823,    824,    825,    828,    832,    833,    837,    841,    842,    849,    850,    851,
    852,    854,    858,    859,    860,    861,    868,    870,    877,    881,    884,    886,    887,    891,    892,    894,    895,    897,    899,    903,
    904,    911,    923,    939,    944,    949,    952,    953,    959,    961,    962,    975,    980,    981,    985,    988,    990,    994,    1001,    1002,
    1003,    1006,    1013,    1015,    1021,    1025,    1029,    1032,    1033,    1037,    1041,    1043,    1046,    1048,    1049,    1053,    1054,    1055,    1056,    1058,
    1059,    1061,    1063,    1066,    1071,    1072,    1076,    1084,    1090,    1091,    1093,    1094,    1096,    1098,    1101,    1103,    1109,    1110,    1111,    1119,
    1134,    1142,    1145,    1146,    1149,    1150,    1151,    1154,    1157,    1158,    1159,    1162,    1164,    1172,    1206,    1256,    1288,    1289,    1295,    1304,
    1308,    1334,    1351,    1352,    1354,    1374,    1376,    1377,    1378,    1379,    1380,    1381,    1382,    1383,    1384,    1385,    1386,    1387,    1388,    1389,
    1390,    1391,    1401,    1402,    1403,    1404,    1405,    1406,    1407,    1408,    1409,    1410,    1411,    1412,    1413,    1414,    1415,    1416,    1417,    1418,
    1419,    1420,    1421,    1422,    1423,    1424,    1425,    1426,    1427,    1428,    1429,    1430,    1431,    1436,    1437,    1438,    1439,    1440,    1441,    1442,
    1443,    1444,    1445,    1446,    1447,    1448,    1449,    1450,    1451,    1452,    1453,    1454,    1455,    1456,    1457,    1458,    1459,    1460,    1461,    1462,
    1463,    1464,    1465,    1466,    1467,    1468,    1469,    1470,    1471,    1472,    1473,    1474,    1475,    1476,    1506,    1512,    1514,    1515,    1533,    1552,
    1580,    1581,    1591,    1600,    1609,    1654,    1689,    1699,    1708,    1713,    1735,    1736,    1787,    1792,    1807,    1812,    1817,    1820,    1824,    1826,
    1829,    1832,    1839,    1841,    1843,    1848,    1854,    1855,    1856,    1859,    1861,    1870,    1872,    1873,    1874,    1875,    1877,    1880,    1881,    1891,
    1892,    1894,    1895,    1898,    1961,    1965,    1967,    1968,    1981,    1982,    1984,    1994,    1997,    1998,    2147,    2149,    2153,    2155,    2160,    2164,
    2165,    2174,    2201,    2210,    2241,    2250,    2251,    2252,    2254,    2255,    2257,    2268,    2270,    2271,    2272,    2274,    2306,    2308,    2360,    2373,
    2374,    2407,    2409,    2428,    2499,    2618,    2669,    2864,    3034,    3094,    3109,    3157,    3203,    3246,    3399,    3441,    3467,    3765,    3766,    3768,
    3769,    3770,    3782,    3783,    3785,    3806,    3812,    3820,    3829,    3835,    3838,    3841,    3842,    3848,    3849,    3850,    3867,    4011,    4012,    4058,
    4086
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 22;
constexpr int N_PHYSICS_FEATURES = 65;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
    "dD",
    "dH",
    "dP",
    "HansenTotal",
    "BP",
    "deltaHvap",
    "logVP",
    "logPow",
    "logWS",
    "deltaHf",
    "deltaHc",
    "MP",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/flashpoint_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/flashpoint_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadeFlashpoint
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadeFlashpoint {
struct Model {
    using Namespace = CascadeFlashpoint;
};
} // namespace CascadeFlashpoint
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
