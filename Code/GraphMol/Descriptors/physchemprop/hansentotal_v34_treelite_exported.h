#pragma once
// Auto-generated Treelite model for HansenTotal (v3.4 XGBoost)
// Trees: 300, Features: 578
// Target normalization: mean=19.6012377937, scale=3.8233266417
// Library: hansentotal_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadeHansenTotal {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 578;
constexpr double TARGET_MEAN = 19.6012377937;
constexpr double TARGET_SCALE = 3.8233266417;

// Normalization stats
constexpr int N_NORM_FEATURES = 578;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0210300970,    0.0052890064,    0.2332199975,    0.0254376023,    0.0052890064,    0.0060445788,    0.1059060572,    0.0293413928,    0.0249338874,    0.0054149351,
    1.6903412668,    3.0379045460,    0.6638962347,    0.3048734416,    0.3741342400,    0.0787054527,    0.5521974562,    0.0601939302,    0.4008311296,    0.0064223649,
    0.5063594006,    0.0624606473,    0.0159929480,    0.2031230324,    1.9783402594,    0.0797128825,    0.0152373756,    0.0127188012,    0.0112076565,    0.0015111447,
    1.4532174789,    0.0210300970,    0.0055408639,    0.0633421483,    0.0220375268,    0.0402971918,    0.2279309911,    0.1710112077,    8.2553378339,    0.5542881401,
    -0.3461563449,    0.5156439006,    15.2176896507,    185.1291647148,    184.8261450675,    0.1723958015,    -0.3211904100,    0.3347055277,    0.1660862798,    1.1919419812,
    1.7227748286,    23.4881710977,    10.1997951967,    2.0800792506,    -2.0528056144,    -2.0375781990,    2.9148943424,    7.5666877726,    7.9830046163,    5.7515106821,
    4.5897526526,    3.5168518899,    8.5190060350,    1.1385743581,    3.0491103323,    5.5529324594,    9.6146865859,    0.8396087426,    3.0748555696,    30.3249885645,
    4.7392960850,    1.3290046783,    12.7904030132,    4.5746413652,    28.2386254936,    0.9163174308,    25.3907366830,    4.9714148403,    5.8921911320,    14.2248216806,
    4.7489536896,    13.7106537598,    3.5944934962,    0.8510384257,    3.1657165648,    3.6736415903,    0.1741875447,    1.6234731142,    0.4567434832,    0.3988162700,
    4.5716107798,    2.6737521937,    49.4834324644,    0.1472106788,    0.0591865004,    0.2386349326,    0.0551567813,    1.1706433666,    14.5159299836,    124.2019359512,
    174.3984377376,    127.5205249151,    605.0983503337,    788.4051127062,    9406.3883269521,    46.0362186464,    73.6844783990,    9834.1344745458,    6.6664030425,    4.5129248358,
    2.7496098716,    2.2232664497,    5.9378223881,    3.1001090654,    3.8838901887,    2.9612480554,    25.6953210038,    15.8922498735,    112.6466405617,    7.8644319541,
    7.7634643650,    7.8195209575,    7.1856803806,    6.3739165513,    6.4487079200,    5.6810777424,    6.2738538688,    163.1663967301,    165.1927764170,    159.7239397276,
    0.3907302798,    -0.1854816242,    -0.0140567499,    0.0126208464,    -0.0078309373,    20.0744443736,    -16.4617840568,    -18.1872188016,    13.1236634107,    3.2265939038,
    -2.6589088425,    -4.0411920734,    -5.3019107275,    -3.1981018099,    -0.8740616996,    306.0912012225,    1.4167548319,    -3.0893044688,    -29.2538162433,    -11.9753596781,
    -206.3227605790,    -81.4388964794,    1312.2246694063,    -93.3823256859,    -199.0400119729,    -77.3264120054,    2.9836732208,    -0.0902567282,    -0.2100763966,    -0.0870389532,
    -0.1585040114,    -0.0289754395,    -0.3652756134,    -0.2898732474,    -0.5750241350,    -1.5945064003,    -0.9964793216,    41.2781185044,    -3.1083724254,    -1.1593416539,
    0.0171688395,    -0.0001789552,    0.0001488122,    0.0004882116,    0.0001054038,    3.1626153897,    0.7427315538,    -0.4452809035,    -0.0249290859,    -0.0745656395,
    0.0029944398,    0.0251887925,    -0.2197295237,    -0.2250306578,    -0.0139526196,    15.1825466538,    -0.2254237542,    -1.4765269895,    -2.5752421412,    -8.7449659488,
    48.4147256802,    -1.9341838609,    -6.2565515282,    -3.8982269687,    1.6691578374,    1.9262902324,    -0.0107982188,    -0.0079907614,    0.1308013932,    -0.0164106029,
    -0.0074842968,    -0.0077665830,    -0.0119484228,    -0.0173597660,    0.2800905227,    -0.0152689053,    -0.0371943509,    1.7360354649,    -0.1010404479,    0.0184027354,
    -0.3996764069,    -0.0213488213,    -0.0303963111,    -0.1378530382,    -0.0665986687,    0.0543841980,    0.2052297274,    -0.0007631461,    -0.1293528131,    -0.0781974949,
    -0.0241361661,    -0.0970714345,    -0.0078322263,    -0.0047281455,    -0.0431636967,    -0.1282982848,    -0.0780202574,    0.0414183184,    -0.0351373078,    -0.0280067615,
    -0.1027197546,    -0.0637181376,    -0.0703375678,    -0.0069265191,    -0.0645729511,    -0.1192814949,    0.0467377555,    1.4282848002,    1.0061826781,    0.9005327109,
    0.7527382606,    0.7566189726,    1.1378725087,    1.0572901299,    0.6357276044,    1.2003821238,    1.5373536732,    1.1566570113,    0.8988195240,    0.9955378977,
    1.0017906119,    1.0689034951,    0.9541928093,    1.0491149960,    0.9716524818,    0.7158128348,    0.9557889595,    1.0475980904,    1.1956326609,    1.0618278354,
    0.9822831450,    0.8672457222,    0.7337403958,    0.4348482651,    0.8782290139,    0.8649583937,    1.0951597569,    0.8949202861,    1.0317830388,    0.9021132171,
    0.8740515779,    1.0896477940,    0.4890422600,    1.2633067721,    1.1085953210,    1.3595594708,    1.1348211996,    1.0971867731,    0.5558489319,    -0.3653886073,
    0.9967423520,    5.7703411226,    11.7927466216,    21.7007163493,    15.8508967892,    3.5805445493,    2.5023208432,    3.4079253724,    2.2507619325,    0.8977846569,
    13.7983308783,    2.6296370994,    5.1820799077,    78.7384716521,    39.6707128295,    0.3044516037,    0.3526456395,    0.5773832011,    0.4649288503,    0.0538742407,
    0.0861398817,    0.9937508764,    0.7735768942,    0.2328044015,    0.1502940680,    0.0569814326,    0.0333178224,    0.2566578073,    0.0958839510,    0.6847113323,
    0.5996285484,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0002518574,    0.0070520086,    0.0000000000,    0.0171263065,    0.0064223649,
    0.0601939302,    0.0123410150,    0.0025185745,    0.0000000000,    0.0000000000,    0.0190152374,    0.0287117491,    0.0103261554,    0.0288376779,    0.0232968140,
    0.0375267599,    0.0162448054,    0.0110817277,    0.0167485203,    0.0327414683,    0.1718927087,    0.0635940058,    0.0580531419,    0.0000000000,    0.2181085506,
    0.5879612140,    0.0929353986,    0.0580531419,    0.2036267473,    0.0438231961,    0.0697645133,    0.0289636066,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    3.4041467703,    0.3641670405,    3.1663298159,    0.0309189412,    0.7621702437,    2.8478941167,    0.0505729495,
    0.0118548445,    0.0772967274,    0.0173754620,    0.5093281527,    0.0975045544,    -1.2455442284,    0.0000000000,    0.3231465427,    0.0000000000,    0.0034277433,
    0.1741244415,    0.0234538291,    0.1716962401,    0.0665876873,    0.0749466298,    2.7467877717,    6.0221297118,    0.1096477318,    0.5985980567,    1.0443506435,
    2.2590536651,    0.5004723909,    0.3311112529,    0.0271157348,    0.0342404969,    0.0261264422,    0.0547186338,    1.1681140383,    0.9400200893,    -0.4150539525,
    4.6598807444,    1.1242003111,    0.3190566559,    0.8664836092,    4.0891575368,    0.3218540106,    11.0286679415,    0.8368087233,    3.8484493127,    6.0893718366,
    0.8635519525,    0.8399217519,    0.0236302005,    -2.6972988289,    0.1673557269,    -2.6707892423,    1.3233131108,    2.9927078803,    33.8773800537,    0.3034340107,
    0.4741489153,    0.7397497804,    3.2337941541,    1.5643993846,    1.1287573429,    14.6808368044,    27.4893770794,    34.4086633400,    29.2236167244,    24.7113523851,
    23.8073728158,    10.8009485140,    4.8966481153,    145.7717227049,    0.4230380806,    2.1790474603,    1.5274162263,    0.3454377270,    0.1382403438,    4.8000502588,
    0.4100264156,    1.4907020517,    0.6595904487,    0.0580376582,    2.4636396017,    2.0509676007,    17.2593174785,    0.0399194056,    0.0210300970,    27.7105893464,
    0.0353105517,    0.0201575245,    0.0029912593,    0.8209399249,    5.3773856497,    114.4692371238,    10.6869962772,    0.1327288755,    1.3776602443,    0.6870962159,
    1.4913446950,    0.5013495452,    0.1543489626,    0.9755218669,    0.4606179953,    0.0896110193,    2.3623021979,    0.4164692565,    0.0622379666,    1.5673583126,
    0.0048427741,    0.2590195091,    0.0077849684,    0.0149736692,    0.0644559240,    0.0614654019,    2.9790948062,    0.0053039790,    7.8659253166,    0.0313562524,
    0.0279561768,    0.0287895187,    0.5758254227,    0.0434574147,    0.1402744956,    0.0166992448,    0.4533418807,    0.0535870935,    0.0154012213,    3.8461726807,
    0.1434263947,    0.5089701549,    0.8522364941,    0.6249842589,    5.8214570703,    1.4221917565,    34.9636527317,    2.6488570550,    0.6181300760,    5.0931429265,
    8.5703821235,    1.2172738114,    2.1980610016,    3.7344152879,    400.8051691511,    2.3192714998,    0.0594383579,    0.0112076565,    0.0370230450,    0.1696259917,
    7.9750661126,    0.0396675482,    0.0720312303,    1.4580408668,    131.3191661671,    5.7597828346,    0.6182368213,    0.5455426893,    1.0775670350,    1.4801189262,
    0.8561887095,    0.1555690020,    0.4014455057,    1.4580408668,    0.6182368213,    5.7597828346,    0.5455426893,    0.8561887095,    0.1555690020,    1.0775670350,
    1.4801189262,    131.3191661671,    2.6293858522,    0.8203569832,    43.3709486187,    0.4874863056,    1.1083354017,    0.1072077855,    1.2513471193,    2.1989764171,
    21454.4487942777,    1.0504718269,    10.4611563171,    0.9269530264,    1.3886626250,    0.2346478188,    1.5491266592,    2.1730442473,    236.8348340084,    4.9406832043,
    0.4662380393,    0.8525109915,    0.1523092843,    0.7260602096,    0.9667828961,    100.5323802153,    3.9475903013,    6.1836839500,    1.0875103785,    6.2469589522,
    8.6802228948,    952.6435103445,    0.6531656517,    0.1454327018,    0.5889671869,    0.8194354870,    83.5615013436,    0.2066917391,    0.9757861957,    1.3047506470,
    128.2315950044,    0.1827993075,    0.2371976453,    21.1388737287,    1.6025083769,    140.5309218015,    196.4810404530,    4.2262865559,    49.4834324644,    175.0342300678,
    0.2826177433,    173.8976845266,    49.8610390045,    32.8297915418,    1.3429454438,    1.7971061070,    1.3920324048,    2.6421122759
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.2303854224,    0.0976862808,    0.6107458745,    0.2388059550,    0.0775667788,    0.0806954567,    0.4818756387,    0.1931203929,    0.2184832520,    0.0815162614,
    1.5230070028,    4.3575783352,    1.1597030226,    0.7094538000,    0.6830975301,    0.3555395877,    0.7500672979,    0.3196198042,    1.0310110669,    0.0902447800,
    2.0791215358,    0.3863003965,    0.1517927522,    0.4744262700,    2.6334732346,    0.5189449238,    0.1433389755,    0.1335890702,    0.1176965456,    0.0448617435,
    1.7034181320,    0.2303854224,    0.0963743972,    0.3638249314,    0.1575627526,    0.3413169784,    0.7577368150,    0.6982597307,    3.4646774856,    0.6882235414,
    1.7261185944,    0.1327989451,    9.8957151661,    91.8738121496,    91.6400275961,    0.1475065761,    0.1459739169,    0.1464755629,    0.1219943979,    0.3791149975,
    0.4764563002,    18.1671208117,    0.9495206283,    0.2698469257,    0.2001474999,    0.2663310803,    0.7017342247,    3.8516508111,    3.8656810333,    2.9273991705,
    2.5373720866,    2.1461575947,    111.8773340869,    3.3571144666,    6.2406029382,    6.8674776425,    13.6400852446,    2.7980067448,    6.2549699991,    30.5145837048,
    7.2012912984,    3.8563305247,    12.7280173815,    5.7634485273,    30.2602326356,    3.7932956591,    27.0205210733,    7.2383287940,    7.6276555291,    24.3936004257,
    8.4305888751,    15.4143455709,    7.0984213737,    2.0377185350,    7.0773968856,    3.6029235911,    1.0197629368,    1.5526759954,    0.8459174301,    0.9426275195,
    4.2326721586,    1.9621666237,    24.9159139049,    0.5150927866,    0.3057156782,    0.6503596985,    0.2900007013,    0.1012149344,    10.2052555213,    96.2504495717,
    195.7653137048,    134.6061569779,    315.3759497767,    806.8194537799,    6701.5882402800,    26.1014719233,    53.4652644901,    7187.6404526242,    6.6463004565,    5.6085323253,
    0.7729893572,    0.6683553762,    7.5295137423,    1.2749591514,    5.4625264723,    6.2848611090,    19.6350768012,    22.7181994653,    57.9136338247,    1.1985271648,
    0.5838759900,    1.0223358202,    2.2745838369,    1.3783825033,    0.6481254818,    2.0533796703,    1.1912036909,    20.8372034759,    31.1309290999,    46.4756693453,
    0.3652348509,    0.2064179159,    0.1800348374,    0.1378929532,    0.1131594245,    20.0476510281,    31.5810240226,    33.2156255613,    8.8599447098,    4.6243879018,
    5.4478222759,    23.4379756073,    23.4621093200,    18.5162370127,    16.5932334920,    411.7082948526,    35.7733955478,    125.3904014621,    119.0287243468,    122.8192970915,
    761.5909158363,    649.2256988042,    783.1698258776,    458.8872403353,    502.1666806702,    463.2978082082,    461.7646462854,    0.3159386563,    0.9444045531,    0.3939199203,
    1.3747474602,    1.0443374927,    1.5896647488,    0.8369275028,    2.3299570834,    2.4512901738,    2.6150977321,    29.5584575539,    6.4172425518,    12.3495071408,
    0.0165306606,    0.0054529220,    0.0066247806,    0.0085945423,    0.0094228747,    1.6599653902,    0.6859746152,    0.9548255258,    1.6497743068,    0.1138303058,
    0.1332145336,    0.1476409063,    0.4507389213,    1.2100848465,    1.1409797500,    31.2822340984,    5.8811549946,    7.9730479237,    43.8256676040,    46.1443842938,
    9.7240727391,    3.9206952340,    9.2365596308,    10.4047214585,    16.2647165818,    18.6126519118,    0.0458781768,    0.0535800165,    0.1226812548,    0.0687887989,
    0.0895402090,    0.0293767243,    0.0589595544,    0.0785827355,    0.2132741400,    0.0744653337,    0.0847945967,    1.5092321832,    0.4492161540,    0.6739782794,
    0.2284406284,    0.1719733494,    0.1909830285,    0.1955821706,    0.3042649440,    0.3251816996,    0.2318935008,    0.2074486264,    0.1558411366,    0.2224322821,
    0.3361934311,    0.2307911191,    0.0880280062,    0.4238547740,    0.1662018237,    0.1851003736,    0.2075067383,    0.3720151882,    0.1221973242,    0.3543892595,
    0.2464003371,    0.1466067167,    0.2046729616,    0.2602700005,    0.1750993989,    0.1914254194,    0.2854725954,    0.2888452926,    0.3135922486,    0.5005471690,
    0.6044882615,    0.3457092111,    0.3311483679,    0.4167899131,    0.7000758750,    0.3533114598,    0.4399009284,    0.3694492947,    0.4045673615,    0.4469535609,
    0.3549219740,    0.7135070659,    0.2474614093,    0.3629933394,    0.5249940139,    0.7944751242,    0.2461005610,    0.3604494363,    0.2903890310,    0.2164248797,
    0.2940904938,    0.4073521394,    0.5018156590,    0.5163594680,    0.3105728227,    0.3331839106,    0.4645085424,    0.3030328790,    0.6164097729,    0.3120100854,
    0.3175150250,    0.4468857161,    0.7690743754,    0.3713010637,    0.3038939768,    0.3142236859,    0.2164286593,    0.2754546445,    0.5217603319,    0.0997997515,
    0.1222809291,    0.3910902306,    0.8737403041,    1.9561791454,    2.4100644719,    0.2930208937,    0.0644101791,    0.3864776699,    0.0660754372,    0.2982492039,
    1.5303132132,    0.7481745993,    2.9436796525,    111.8110665497,    55.9688569958,    0.0699100156,    0.1612601704,    0.8144657711,    0.9413932319,    0.1578590876,
    0.2914830530,    1.0221281390,    0.0486451325,    0.0622130870,    0.0605669867,    0.0391392675,    0.0283232751,    0.1503254014,    0.0989400575,    0.3367064458,
    0.0923706904,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.0158680187,    0.0836796136,    1.0000000000,    0.1400122426,    0.0902447800,
    0.3196198042,    0.1126606818,    0.0501221635,    1.0000000000,    1.0000000000,    0.1506100173,    0.1909202395,    0.1161622690,    0.1905711469,    0.1748189159,
    0.2372068676,    0.1378520987,    0.1203533437,    0.1590063461,    0.2248527812,    0.5472701832,    0.3183679392,    0.2693786433,    1.0000000000,    0.4850407973,
    0.8421440107,    0.3297401747,    0.2693786433,    0.4736788837,    0.2809373035,    0.4682798757,    0.2532594149,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    3.2291411138,    1.2112985443,    5.8085103643,    0.4036617195,    1.7936874191,    4.9525028790,    1.2726663680,
    0.1672494192,    0.5205526407,    0.9645138753,    1.3504793159,    0.6586237296,    6.5619451520,    1.0000000000,    1.4586820392,    1.0000000000,    0.1544125851,
    0.8098374109,    0.2861844086,    1.3612230532,    0.5871097078,    0.4945290618,    6.5880103207,    8.4482126385,    0.7944469261,    3.0254198575,    3.7601076225,
    5.3303055900,    3.4133426718,    1.0471130836,    0.7043947805,    0.5934567533,    0.3473598695,    0.3879946547,    3.0583220463,    1.9384756779,    1.4772167391,
    5.3689083051,    3.4257682863,    0.1769749777,    0.3353399703,    4.5950534946,    0.3072870284,    9.5925510333,    0.3035080713,    2.4062861742,    6.7826773613,
    0.1676618792,    0.1669057267,    0.0457565546,    4.2629602617,    0.1849556412,    1.9672845581,    0.2765232792,    0.5826726236,    17.4336928699,    0.1045005802,
    0.1370477984,    0.1201839646,    0.8804396971,    0.7949290377,    0.6989352931,    8.5884450663,    10.0060562758,    18.1855809540,    16.2759091048,    12.8292650783,
    12.1149063964,    5.4777812807,    4.4432084722,    71.5007985492,    0.8080453317,    2.1429713300,    2.3126835490,    1.0999187724,    0.4637051620,    4.7636938309,
    0.3208473700,    0.3633763206,    1.6111379680,    0.1341711389,    2.7028395681,    2.2494572225,    10.2000225154,    0.2064156566,    0.1443595838,    28.3717446033,
    0.0270362512,    0.0193563652,    0.0054670127,    0.2110265068,    2.4906989830,    75.1933619978,    165.4051481472,    0.5152386029,    1.8149637891,    1.6268476189,
    1.5100137682,    0.9336278680,    0.1554071862,    0.7553232938,    0.4175779604,    0.3848367420,    5.4536130142,    1.7340185951,    0.7081832566,    2.8032798303,
    0.1194340910,    1.5143605623,    0.1289848125,    0.2110281228,    0.7271794493,    0.5342265840,    13.9504952604,    0.1581354283,    9.2098346466,    0.1841169250,
    0.2198423405,    0.2577217589,    0.8935871275,    0.2264051284,    0.6351523559,    0.1854779239,    1.6542952395,    0.4009468139,    0.1700289565,    3.1221882220,
    0.2843420099,    0.4628758569,    0.6376864763,    0.6561939537,    3.8458446321,    0.2691482801,    48.1660406439,    0.4261527327,    0.3572347515,    0.7154897054,
    1.0654036224,    0.9527121164,    26.3525943098,    0.5930109995,    1506.5296324911,    0.1982709944,    0.3828499981,    0.1208637629,    0.2677087116,    0.6885204567,
    5.5714279006,    0.2708395773,    0.3070752255,    0.7095792294,    64.8823966222,    3.1930941603,    0.6619216086,    0.4357401516,    0.3003271624,    0.0906883744,
    0.6125979884,    0.2881077422,    0.1205247267,    0.7095792294,    0.6619216086,    3.1930941603,    0.4357401516,    0.6125979884,    0.2881077422,    0.3003271624,
    0.0906883744,    64.8823966222,    3.7534257888,    1.6421595518,    69.3843240265,    1.3252732185,    2.1450529407,    0.3707125954,    0.8538511427,    0.2711466381,
    28615.3347581489,    1.7671265205,    15.6261642094,    1.7137173037,    2.1572070150,    0.6041785067,    0.8203287070,    1.0900436187,    325.2428535999,    8.9091615896,
    1.1642880521,    1.5881546229,    0.5093391952,    0.9733783104,    1.0617295166,    166.9185857932,    8.3866359197,    10.7635468897,    3.0817796159,    4.1371758972,
    5.0723381708,    1362.6954004434,    1.5421330814,    0.4933004784,    0.5313742248,    0.6778881895,    148.0448276984,    0.5981559077,    0.8550561687,    0.9795779587,
    187.1187509120,    0.3688961179,    0.4481591733,    54.5745276665,    0.4933212525,    79.5775968076,    101.3788004257,    3.0797308534,    24.9159139049,    81.9619871541,
    0.0455524054,    81.2750907314,    25.3161612336,    16.2205991556,    0.2696486044,    0.3527524620,    0.2732408821,    0.5117567895
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 503;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    0,    14,    15,    17,    19,    24,    26,    27,    41,    50,    66,    67,    78,    82,    83,    84,    86,    87,    89,    90,
    95,    98,    99,    101,    111,    117,    118,    119,    120,    121,    122,    123,    124,    150,    171,    180,    217,    226,    291,    293,
    294,    295,    296,    297,    299,    302,    303,    304,    305,    306,    307,    309,    310,    311,    312,    314,    318,    321,    322,    323,
    325,    327,    336,    340,    343,    350,    353,    355,    356,    357,    358,    361,    366,    367,    369,    372,    374,    378,    379,    381,
    382,    384,    389,    390,    393,    394,    395,    409,    410,    418,    419,    421,    422,    425,    489,    510,    511,    516,    531,    544,
    545,    561,    571,    574,    591,    625,    627,    636,    642,    644,    653,    654,    660,    661,    663,    666,    670,    673,    692,    696,
    697,    698,    701,    705,    706,    710,    716,    735,    736,    737,    741,    742,    745,    747,    748,    751,    753,    754,    759,    760,
    763,    771,    773,    775,    776,    777,    778,    779,    782,    783,    790,    793,    795,    797,    799,    800,    801,    805,    807,    814,
    819,    821,    825,    832,    833,    834,    835,    840,    841,    847,    849,    851,    854,    855,    856,    858,    859,    861,    865,    870,
    872,    873,    877,    880,    884,    885,    886,    889,    896,    897,    903,    904,    906,    907,    909,    910,    916,    917,    921,    925,
    927,    931,    933,    934,    939,    941,    942,    948,    950,    953,    957,    960,    966,    967,    969,    972,    973,    977,    981,    984,
    986,    992,    997,    1003,    1006,    1007,    1008,    1011,    1013,    1019,    1024,    1037,    1040,    1041,    1046,    1047,    1051,    1053,    1054,    1057,
    1058,    1061,    1063,    1064,    1067,    1069,    1070,    1071,    1072,    1077,    1079,    1081,    1086,    1088,    1089,    1091,    1094,    1096,    1101,    1102,
    1104,    1105,    1106,    1108,    1109,    1110,    1112,    1117,    1121,    1125,    1126,    1128,    1132,    1133,    1135,    1141,    1142,    1143,    1147,    1150,
    1154,    1158,    1160,    1161,    1162,    1163,    1164,    1167,    1168,    1170,    1171,    1173,    1178,    1213,    1214,    1234,    1288,    1292,    1297,    1309,
    1310,    1311,    1333,    1336,    1337,    1339,    1340,    1351,    1353,    1365,    1367,    1439,    1440,    1441,    1442,    1443,    1444,    1445,    1446,    1447,
    1448,    1449,    1450,    1476,    1477,    1478,    1479,    1480,    1481,    1482,    1483,    1484,    1485,    1486,    1487,    1488,    1489,    1490,    1491,    1492,
    1493,    1494,    1495,    1496,    1497,    1498,    1499,    1500,    1501,    1502,    1503,    1504,    1505,    1506,    1507,    1508,    1509,    1510,    1511,    1512,
    1513,    1514,    1515,    1516,    1517,    1518,    1519,    1520,    1521,    1522,    1523,    1524,    1525,    1527,    1529,    1533,    1534,    1536,    1590,    1595,
    1597,    1598,    1608,    1613,    1616,    1649,    1684,    1690,    1694,    1720,    1736,    1739,    1806,    1810,    1813,    1814,    1817,    1818,    1819,    1825,
    1836,    1839,    1843,    1844,    1850,    1853,    1854,    1856,    1860,    1866,    1867,    1875,    1878,    1880,    1881,    1884,    1886,    1891,    1892,    1894,
    1895,    1896,    1898,    1901,    1956,    1957,    1958,    1964,    1966,    1977,    1978,    1980,    1981,    1982,    1983,    2004,    2009,    2049,    2111,    2153,
    2167,    2168,    2171,    2177,    2208,    2210,    2216,    2230,    2232,    2237,    2251,    2257,    2272,    2274,    2275,    2298,    2342,    2359,    2360,    2406,
    2422,    2427,    2447,    2480,    2495,    2513,    2542,    2600,    2669,    2744,    2867,    3096,    3135,    3144,    3157,    3200,    3272,    3277,    3382,    3764,
    3765,    3766,    3768,    3769,    3774,    3780,    3784,    3798,    3800,    3803,    3829,    3835,    3847,    3848,    3849,    3868,    3994,    4004,    4012,    4018,
    4041,    4058,    4086
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 10;
constexpr int N_PHYSICS_FEATURES = 65;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/hansentotal_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/hansentotal_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadeHansenTotal
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadeHansenTotal {
struct Model {
    using Namespace = CascadeHansenTotal;
};
} // namespace CascadeHansenTotal
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
