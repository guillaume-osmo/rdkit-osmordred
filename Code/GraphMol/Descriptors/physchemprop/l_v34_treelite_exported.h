#pragma once
// Auto-generated Treelite model for L (v3.4 XGBoost)
// Trees: 300, Features: 503
// Target normalization: mean=7.2198811829, scale=4.1122846799
// Library: l_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadeL {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 503;
constexpr double TARGET_MEAN = 7.2198811829;
constexpr double TARGET_SCALE = 4.1122846799;

// Normalization stats
constexpr int N_NORM_FEATURES = 503;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0297418631,    0.0157126824,    0.0116442200,    0.2529461279,    0.0690235690,    0.0217452301,    0.0058922559,    0.0053310887,    0.0617283951,    0.0182379349,
    0.1272446689,    1.5493827160,    3.0729517396,    0.0768799102,    0.0420875421,    0.0332491582,    0.0096801347,    0.6447811448,    0.0479797980,    0.3585858586,
    0.6729797980,    0.2854938272,    0.0572390572,    0.0168350168,    0.0234287318,    0.0084175084,    2.9687149270,    0.0203423120,    2.0693041526,    0.0029461279,
    3.3981481481,    0.0113636364,    0.0223063973,    0.5537317621,    0.7160493827,    0.1764870932,    8.2155808801,    0.5349493902,    -0.2303244448,    0.5338358333,
    214.0598689675,    198.6634043210,    213.6818671091,    78.8267396184,    0.1698396032,    -0.3195422347,    0.3279658648,    1.1206669108,    1.6818383515,    2.1217268937,
    24.0163831643,    10.1777510621,    2.0846650889,    -2.0429194053,    6.0568787936,    2.1410336036,    2.7452739218,    330.0608947040,    2.4353179817,    10985020825669.0214843750,
    11.1730235403,    10.6461373500,    1.5910444013,    2.5507375415,    29.4253577170,    7.9685577544,    5.7755220817,    2.0682758088,    2.9806102056,    2.2667445853,
    6.4815547821,    33.3893644781,    7.0212165664,    9.3490788588,    6.6466587646,    14.9847124226,    6.7653553436,    5.2133525156,    1.3119473410,    -0.1540150106,
    3.1682451011,    14.3233726150,    0.7362514029,    0.4068462402,    0.0697250281,    3.5126262626,    0.3787878788,    2.8577769515,    58.1722659652,    0.0075757576,
    0.4426206510,    10.5540431791,    0.1174242424,    17.5735490781,    3.2667697428,    1.3994754453,    130.9552689555,    85.6477587978,    826.8121492705,    723.8090628507,
    513.8511503928,    2736.6374966738,    10635.0907616912,    10952.4618246643,    5.6915998223,    3.4701901323,    2.6788096162,    1.1742983652,    2.8489735268,    3.4073722443,
    2.4992449575,    2.1014785275,    5.1924382297,    3.1106571062,    26.5441801275,    20.8336164191,    10.1688067295,    35.6983927121,    209.2521591506,    111.9114290525,
    7.7496961403,    7.3440809042,    4.8914000987,    6.0475516166,    5.9528464172,    1.5793076991,    1.8366193215,    1.1775798532,    0.7784864112,    164.4627507463,
    159.4267010139,    159.9681584373,    152.4367425537,    134.7752829640,    112.6221928439,    0.4507333826,    0.0180820585,    -0.0060437262,    0.0191284119,    -0.0097237862,
    0.0013353218,    8.0675443851,    -14.8880970887,    -8.3927004068,    -2.1905688406,    -4.3723763756,    -4.0536834229,    0.1398458254,    -4.4246203200,    8.0238740037,
    -2.4131058408,    -2.0311972002,    -3.3263336685,    1.1682865247,    -48.6938216195,    -36.3628983503,    -20.5508689059,    -3.1038216220,    32.0199672946,    0.4289061874,
    -76.3029528962,    1477.7266430088,    -6.5902582261,    -60.7435344612,    -258.9035300654,    -268.9347541231,    -80.0606699926,    2.0788302574,    -0.1136901010,    -0.0736369027,
    -0.0786518221,    -0.2822889510,    -0.0993445223,    3.2191787760,    -0.2524726731,    -0.3006550480,    -0.2009199058,    -2.7015550266,    -2.5134088727,    -7.4745940827,
    -2.4339969648,    -0.3624939019,    -1.3073099201,    0.0003826596,    0.0006715085,    0.7493855393,    -0.4363673701,    -0.0751310109,    -0.0592012963,    -0.0104691065,
    0.0503435751,    0.0499191289,    0.1815549675,    -0.1145651565,    -0.1678358273,    -0.0808889684,    -0.5468458861,    -0.1349183186,    -1.2632537208,    -0.0048435749,
    0.0062645692,    -0.0055939669,    -0.0042840108,    -0.0125453630,    -0.0050715741,    0.2835252373,    0.0087130220,    1.5647089425,    -0.0650619540,    -0.3998041476,
    0.2245221369,    -0.0754021377,    0.0628839754,    -0.0699928316,    -0.0239821296,    0.0085960795,    -0.0927894739,    -0.0218197619,    -0.0203906729,    -0.0867955963,
    0.0177646112,    -0.0786828060,    -0.0280690688,    -0.0372901993,    -0.0320816402,    -0.0282307321,    0.0469924198,    0.0715704431,    -0.0681003825,    -0.0449090841,
    0.0429729918,    1.4109506418,    0.9903282068,    1.0362858695,    1.0016165091,    0.9546199628,    0.7379973011,    0.7169559544,    1.0462459032,    1.0650773773,
    1.1802105267,    0.7956558522,    0.9621991007,    0.7194820517,    0.9765983025,    1.0741592475,    0.9814761410,    1.0628903339,    1.0186324678,    0.9265283537,
    1.0609590151,    1.0975142839,    1.0174071332,    1.0146830658,    0.9352979836,    0.8654179512,    0.8460088044,    1.0486308838,    0.8792853521,    1.1661492813,
    1.0918554835,    1.2908050484,    1.0889696889,    0.9852149288,    0.4817720565,    -0.3742700435,    5.3642114156,    1.1145278315,    3.2408821223,    1.2114774104,
    5.7462411096,    16.0475614992,    2.4762068744,    3.3727624600,    13.8020593684,    10.9010415469,    2.3762631641,    66.8941296093,    76.3621562623,    67.2478020598,
    4.0629289572,    3.2922278339,    0.2383606149,    0.0658352395,    1.0666434929,    0.3197471659,    0.1286198602,    5.9688707460,    2.4764892423,    0.3318781280,
    0.0883305106,    0.0359952920,    0.6524339763,    0.2384306575,    0.0171450015,    1.1329017469,    11.3759132384,    0.6227553311,    0.0000000000,    0.0000000000,
    0.0032267116,    0.1402918070,    0.0332491582,    0.0238496072,    0.0000000000,    0.0416666667,    0.1477272727,    0.1200897868,    0.0559764310,    0.0461560045,
    0.0000000000,    0.3772446689,    0.6729797980,    0.4433221100,    0.0235690236,    0.2845117845,    0.0000000000,    0.0000000000,    0.0022446689,    0.0202020202,
    0.0000000000,    0.0000000000,    0.0009820426,    0.0182379349,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0555555556,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0141694725,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0185185185,
    0.0381593715,    0.0244107744,    0.0589225589,    0.0425084175,    0.0990460157,    0.0440516274,    0.0298821549,    0.0481200898,    0.0541526375,    0.1756453423,
    0.1133557800,    0.0751964085,    0.0001402918,    0.1593714927,    0.7316217733,    0.1078843996,    0.0751964085,    0.1443602694,    0.1283670034,    0.1119528620,
    0.0519079686,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    -0.0001357908,    0.0000000000,    3.1061872862,    0.2086830470,    3.2351171244,
    0.0310450146,    0.5019022103,    4.9111402824,    -0.0301874679,    0.0083209471,    0.0919375967,    -0.0422877385,    0.9523370899,    0.2966353406,    -0.7012913683,
    0.0000000000,    0.1536181662,    0.6012038869,    0.2160030405,    0.0633909706,    -0.0588381920,    -0.0990155712,    8.1667624648,    0.5957482621,    0.2921233383,
    0.4480018948,    -0.2201742855,    0.0835290415,    0.0516080857,    0.0618753966,    1.3966436468,    0.2764323757,    0.4040837153,    0.7962847377,    0.1985162113,
    5.0362857662,    231.9677328844,    14.7734287318,    8.2984708193,    0.5648383774,    6.4749579125,    0.4474142671,    0.3820145903,    0.0261017512,    0.1857120573,
    0.8201089983,    0.0446823935,    -0.1150267652,    39.4255852673,    66.3127223233,    120.9641038213,    0.4942575786,    0.7452532842,    1.5447455991,    1.0764511953,
    0.9182421556,    0.8801291856,    24.8527330094,    32.2103516933,    27.5401998031,    25.9528967325,    25.0252015744,    6.1403198951,    1.5376895673,    0.4671020994,
    0.2188923839,    0.0796283272,    0.0633616192,    0.0220956054,    1.5233852399,    0.0967670377,    0.1957012850,    2.8078357260,    3.1998223114,    3.6467948678,
    3.7855558218,    0.0001402918,    0.0751964085,    0.0046296296,    0.0304433221,    0.0844444550,    0.0490597204,    0.0121947184,    0.0042262497,    4.4593153760,
    0.8219691321,    5.7228866598,    0.0427160738,    1.5021064510,    0.4498274694,    5.0773858649,    0.1284285858,    0.4713997862,    0.0121641004,    0.2295173962,
    0.0111478778,    0.0207712628,    0.0645562998,    0.0388757419,    0.0088218268,    0.0009150041,    0.4126584865,    10.3845362872,    0.0235690236,    0.0963602609,
    0.0546027475,    0.0526702046,    0.0074581208,    0.0505187646,    0.1310865728,    0.9640363149,    0.8043894752,    0.1951098407,    0.2063383838,    1.1611513749,
    0.9787553311,    7.1620906285,    1.6694342943,    5.8669792540,    8.8849268051,    0.8613466312,    308.9228233177,    2.8047831000,    1.4038485829,    7.5510816052,
    61.8305565092,    8.8772727146,    0.0633402643,    2.1843374290,    1624.3151853514,    1.1061691274,    0.1777800787,    7946.5824811184,    0.0575490531,    0.0375982043,
    0.0050505051,    1.6580607323,    153.7155011246
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.3133072570,    0.1402659909,    0.1421503575,    0.7951644448,    0.4054968139,    0.1468092595,    0.0818491787,    0.0852452547,    0.4045961230,    0.1389540597,
    0.8920075566,    1.5893081175,    4.8973478400,    0.3060991054,    0.2614852621,    0.1928578668,    0.1138131497,    1.5357955755,    0.2539228999,    0.7413412014,
    0.9062939226,    0.9076322520,    0.2671309260,    0.1350374049,    0.1521854458,    0.0943812545,    3.0852101720,    0.1850358524,    2.0024453257,    0.0541982313,
    13.6887706994,    0.1098920151,    0.1738572126,    1.7635725373,    1.9827144421,    0.4994356013,    3.6993686562,    0.6121133606,    1.5061251510,    0.1557278932,
    112.0525877862,    105.3326523966,    111.8241092478,    42.4406250321,    0.1443289968,    0.1552889785,    0.1561145643,    0.3692428519,    0.4690894102,    0.5613879144,
    17.8207243053,    0.8972607803,    0.2542184351,    0.2760637980,    1.4130284874,    0.4620379893,    0.6674629117,    288.0084235341,    2.0632258697,    912513464268463.8750000000,
    6.2921764878,    275.6899962546,    4.1199696749,    5.6308701007,    33.8087478985,    9.4404393835,    8.4915573823,    4.6029379973,    6.8200631580,    4.2906658144,
    14.6568698490,    36.8467106199,    9.4552561902,    11.6634843753,    10.1951852638,    18.0918062606,    20.9985912437,    9.6102321663,    2.5746349182,    4.3518884030,
    3.6708930062,    7.6928226979,    1.3198047162,    0.9657537997,    0.5318617457,    4.8939778329,    1.3115472186,    2.3920586942,    30.6201903464,    0.0959263632,
    1.2068902823,    6.0971931643,    0.5147536962,    9.9741778302,    0.6539943605,    0.6915978741,    123.2133222260,    46.7429359727,    683.1306876442,    411.1747154481,
    857.2279511607,    1576.6734914416,    9783.6826129073,    8898.6174821530,    3.5280489539,    4.0593055454,    3.9189651860,    2.9103566036,    0.7623184763,    0.9142719094,
    0.7474032012,    0.6708280338,    5.4883179261,    1.4068826682,    18.8353090541,    23.4092776622,    20.0454166402,    87.1040195331,    58.5430208773,    66.8425341623,
    0.8026413352,    1.8035571725,    3.6032563253,    1.2567634283,    1.2722375735,    0.6115336178,    0.3563725123,    0.4617520262,    0.5595765456,    11.6054636388,
    17.9861496245,    36.5159498489,    51.3963753730,    69.7234213531,    81.9288236970,    0.4450007684,    0.2166769710,    0.2293682525,    0.1846464582,    0.1546716186,
    0.1272273774,    33.5276390929,    38.6181598309,    40.2324565822,    4.2564463029,    6.2707054499,    6.5095857719,    4.2999510229,    7.5127018015,    21.4008900192,
    21.7789871039,    23.5514006306,    18.2432599363,    106.1791551804,    168.1394442392,    141.4174773637,    117.5851114841,    111.5772660148,    193.4896687386,    539.3954778077,
    704.6291468178,    967.2485922407,    124.0115865374,    501.4833559600,    440.0840602568,    607.1702146055,    505.6494031095,    1.9606139727,    0.4940734081,    1.0175069937,
    0.7844724737,    1.6739727797,    1.2388447418,    3.0663119766,    1.4705524133,    3.0043580159,    3.7091136921,    7.6848485163,    16.5291694229,    15.5772172161,
    14.5776146525,    14.3243157845,    12.6989888414,    0.0051480912,    0.0088420273,    0.6597236942,    0.9438904321,    0.0945743668,    0.0981591136,    0.1234173858,
    0.1638926548,    0.1388030595,    0.6518559433,    0.7244161754,    0.9678001108,    1.4118215163,    12.6120630096,    20.2421923571,    7.9979191030,    0.0193822155,
    0.0251753265,    0.0260244652,    0.0480444902,    0.0523156603,    0.0778764276,    0.2185749477,    0.1414175073,    1.0383701404,    0.3804657337,    0.2452624917,
    0.1873541866,    0.2752802183,    0.1875776812,    0.2661284902,    0.3644245273,    0.0953330062,    0.2073201275,    0.3759360936,    0.0969054698,    0.1869832571,
    0.3498931772,    0.2669539411,    0.1344940132,    0.1439297981,    0.1694763993,    0.2502155452,    0.3932057603,    0.3342201044,    0.1974798310,    0.1804162972,
    0.2731976505,    0.3038366562,    0.3230433336,    0.3387444197,    0.3430290583,    0.4507882995,    0.7044358730,    0.3207239579,    0.3483702879,    0.3463289759,
    0.3341210526,    0.4183734186,    0.4206913071,    0.2887829851,    0.3351020555,    0.4462937917,    0.8372731126,    0.3217153020,    0.4618390484,    0.6567365614,
    0.3185755101,    0.3037617306,    0.2320035827,    0.2667304438,    0.3702790421,    0.3253952680,    0.3369895684,    0.3434336181,    0.3280948845,    0.3763452306,
    0.2828916961,    0.3435365797,    0.2534249235,    0.2768456844,    0.4926550513,    0.0935041896,    1.1878329749,    0.6363185503,    0.5006434483,    0.3253712437,
    0.3603252026,    2.4648719098,    0.0768124371,    0.3766377812,    1.4702063418,    0.3436225557,    0.6922535360,    61.2148968982,    105.4463939371,    61.5686644614,
    1.2464099046,    2.7087972776,    0.4094040470,    0.1601936075,    1.0337013346,    0.7386764137,    0.3822232228,    3.5107350165,    2.3201242486,    0.0581670939,
    0.0425922856,    0.0245854714,    0.1113116041,    0.1412693036,    0.0289811236,    0.0357167817,    6.7672453331,    1.0153555246,    1.0000000000,    1.0000000000,
    0.0658683107,    0.4393183222,    0.1950279662,    0.1674835062,    1.0000000000,    0.2286399671,    0.5038353437,    0.4050057056,    0.2824519377,    0.2539847073,
    1.0000000000,    0.9090662170,    0.9062939226,    0.9095686417,    0.1562576167,    1.6019860929,    1.0000000000,    1.0000000000,    0.0976463227,    0.3054616268,
    1.0000000000,    1.0000000000,    0.0313221685,    0.1496484228,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.3395877874,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.1379101287,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.1900866494,
    0.2097579744,    0.1763804481,    0.2875192194,    0.2165047146,    0.3816191935,    0.2210092492,    0.1790967098,    0.2474603918,    0.2745001278,    0.7357028629,
    0.4083184787,    0.2915030145,    0.0118436534,    0.4255705196,    1.0122421560,    0.3801391028,    0.2915030145,    0.4076384321,    0.4431078690,    0.5649038753,
    0.3368488963,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.0081209604,    1.0000000000,    3.3517496156,    0.9833145174,    6.7429683994,
    0.4277401064,    1.4115216630,    6.0978590693,    1.7106835658,    0.1377456158,    0.5871515151,    0.8444313746,    1.6113197719,    1.1474100713,    5.5239254251,
    1.0000000000,    0.8647666609,    2.0534132254,    0.7825959318,    0.3644518301,    0.5000639922,    0.6582146515,    11.5504427571,    3.8739501250,    0.6973487882,
    0.5522054364,    0.9805830660,    0.4854032993,    0.3130400727,    0.3035276327,    3.7185720083,    0.5190441458,    1.2196370833,    1.9696629297,    0.6851216819,
    5.4985880265,    305.3122715089,    9.1809229698,    4.9287342394,    0.0683743184,    5.5999899790,    0.3234174428,    0.6607241749,    0.0447491659,    0.1032948240,
    0.1307733777,    0.0473822116,    0.1463437776,    22.6551324006,    43.3677075237,    94.1985774840,    0.1435301491,    0.1232873110,    0.8380932451,    0.7553885296,
    0.6923636426,    0.6610341024,    9.5733415355,    11.9777350760,    14.8424912061,    13.1343215619,    12.0062901173,    4.6719489625,    2.6347020555,    1.6291417759,
    0.6199739898,    0.3891808242,    0.2741675621,    0.1902746971,    0.3454645313,    0.1602095528,    0.1982967321,    0.5459824112,    0.7302647768,    1.4435802803,
    1.8389954631,    0.0118436534,    0.2871389122,    0.0757002683,    0.1734292175,    0.0367579485,    0.0264337210,    0.0122363592,    0.0062866303,    2.4404294811,
    0.2061129171,    2.8933663759,    0.2507292877,    2.1927899160,    0.5916680409,    4.0431236792,    0.2905189470,    0.4276432894,    0.0517582639,    0.5827329209,
    0.1669492259,    0.2315550342,    0.3465004965,    0.2297352025,    0.1678590404,    0.2071924144,    1.5756726817,    12.1688405593,    0.1819739948,    0.2828253765,
    0.4220654527,    0.2633354022,    0.0859177069,    0.1756132693,    0.4336487517,    1.0096449488,    0.7994643309,    0.7373452233,    0.3529110016,    0.8399508029,
    0.8299226481,    4.0219939909,    0.2444459964,    27.5403613198,    2.4556557350,    0.0473369144,    396.3355563941,    0.4660976958,    0.3778104663,    2.5984743436,
    33.2538818414,    1.1655616829,    0.1274903023,    0.3208263959,    4269.6748220129,    0.8307864640,    0.0812642178,    21739.1540260172,    0.0289969655,    0.2247094649,
    0.0708872164,    0.8761657848,    79.4939203273
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 501;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    0,    12,    14,    15,    17,    18,    24,    25,    26,    34,    35,    66,    67,    70,    72,    73,    74,    78,    80,    83,
    86,    89,    100,    108,    109,    110,    111,    112,    122,    153,    158,    170,    171,    211,    220,    223,    291,    293,    294,    295,
    297,    298,    299,    300,    302,    303,    304,    306,    307,    308,    309,    310,    311,    314,    315,    317,    318,    319,    328,    333,
    334,    336,    340,    343,    348,    350,    351,    355,    356,    362,    365,    374,    379,    380,    382,    384,    386,    389,    390,    391,
    394,    397,    398,    402,    408,    413,    418,    421,    422,    445,    459,    508,    511,    512,    518,    520,    561,    562,    570,    571,
    577,    580,    592,    636,    643,    645,    646,    649,    651,    652,    654,    655,    660,    661,    670,    672,    676,    685,    689,    693,
    698,    701,    704,    709,    718,    723,    724,    727,    730,    732,    735,    737,    738,    739,    740,    741,    743,    744,    747,    748,
    749,    752,    753,    757,    761,    762,    763,    767,    769,    770,    771,    774,    775,    779,    781,    782,    784,    785,    787,    788,
    792,    795,    796,    797,    798,    799,    802,    804,    805,    810,    812,    816,    821,    822,    829,    833,    837,    841,    842,    843,
    845,    846,    847,    851,    855,    859,    862,    870,    871,    872,    874,    875,    878,    879,    881,    882,    892,    895,    905,    913,
    914,    915,    919,    934,    936,    939,    946,    948,    950,    957,    965,    969,    982,    985,    986,    989,    992,    994,    1005,    1008,
    1010,    1017,    1021,    1037,    1038,    1041,    1043,    1044,    1045,    1046,    1050,    1053,    1054,    1055,    1056,    1057,    1059,    1061,    1062,    1069,
    1071,    1073,    1077,    1078,    1079,    1080,    1082,    1088,    1089,    1090,    1096,    1101,    1102,    1104,    1105,    1109,    1110,    1111,    1125,    1133,
    1135,    1141,    1143,    1144,    1148,    1150,    1151,    1152,    1153,    1156,    1158,    1162,    1164,    1167,    1171,    1172,    1173,    1210,    1241,    1262,
    1263,    1287,    1305,    1309,    1311,    1313,    1317,    1327,    1330,    1335,    1338,    1340,    1349,    1351,    1356,    1372,    1377,    1414,    1418,    1420,
    1421,    1422,    1423,    1424,    1425,    1426,    1427,    1428,    1429,    1430,    1431,    1432,    1433,    1434,    1435,    1436,    1437,    1438,    1439,    1440,
    1441,    1442,    1443,    1444,    1457,    1464,    1465,    1466,    1467,    1468,    1469,    1470,    1471,    1472,    1473,    1474,    1475,    1476,    1477,    1478,
    1479,    1480,    1481,    1482,    1483,    1484,    1485,    1486,    1487,    1488,    1489,    1490,    1491,    1492,    1493,    1494,    1495,    1496,    1497,    1498,
    1499,    1500,    1501,    1502,    1503,    1504,    1505,    1506,    1507,    1508,    1509,    1510,    1511,    1512,    1513,    1514,    1515,    1516,    1517,    1518,
    1519,    1527,    1528,    1529,    1531,    1545,    1552,    1594,    1600,    1611,    1617,    1619,    1625,    1687,    1688,    1698,    1718,    1730,    1755,    1786,
    1796,    1803,    1809,    1811,    1812,    1813,    1814,    1815,    1816,    1828,    1839,    1841,    1842,    1860,    1861,    1865,    1867,    1875,    1880,    1881,
    1882,    1883,    1885,    1888,    1893,    1894,    1895,    1897,    1958,    1962,    1966,    1968,    1973,    1974,    1980,    1982,    1984,    1997,    1998,    2000,
    2001,    2036,    2049,    2069,    2100,    2165,    2166,    2169,    2171,    2176,    2177,    2208,    2242,    2251,    2252,    2254,    2268,    2269,    2270,    2297,
    2355,    2373,    2378,    2415,    2486,    2502,    2512,    2669,    2836,    3076,    3095,    3108,    3201,    3202,    3407,    3500,    3501,    3504,    3765,    3768,
    3769,    3770,    3776,    3782,    3783,    3786,    3789,    3798,    3812,    3813,    3819,    3829,    3832,    3833,    3834,    3835,    3840,    3859,    3862,    4017,
    4030
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 2;
constexpr int N_PHYSICS_FEATURES = 0;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/l_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/l_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadeL
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadeL {
struct Model {
    using Namespace = CascadeL;
};
} // namespace CascadeL
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
