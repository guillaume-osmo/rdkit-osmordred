#pragma once
// Auto-generated Treelite model for logHenrycc (v3.4 XGBoost)
// Trees: 300, Features: 599
// Target normalization: mean=4.1257868592, scale=4.2877399138
// Library: loghenrycc_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadelogHenrycc {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 599;
constexpr double TARGET_MEAN = 4.1257868592;
constexpr double TARGET_SCALE = 4.2877399138;

// Normalization stats
constexpr int N_NORM_FEATURES = 599;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0134811264,    0.0077890953,    0.0047932894,    0.2849011384,    0.0769922109,    0.0116836429,    0.0005991612,    0.0838825644,    0.0149790294,    0.0281605752,
    0.0095865788,    0.0053924506,    0.0041941282,    0.0053924506,    1.4583582984,    2.1120431396,    0.0266626723,    0.0473337328,    0.1165368484,    0.5149790294,
    0.0218693829,    0.3744757340,    0.4248052726,    0.0440383463,    0.0218693829,    0.1336129419,    0.0467345716,    0.8705811863,    0.0461354104,    2.5859796285,
    2.2261833433,    0.5287597364,    0.0044937088,    0.0053924506,    0.0029958059,    0.6617735171,    14.4008388256,    0.0440383463,    0.1899340923,    0.1503894548,
    0.6854403835,    0.2522468544,    8.1243090153,    0.5398768786,    0.5046162732,    13.4929705280,    224.8870488316,    224.1894957701,    76.3205512283,    0.1737349497,
    -0.3213939578,    0.3346137962,    1.0868877676,    1.5768186699,    1.9407101981,    27.3245574907,    10.3500631806,    2.0853902400,    -2.0469649370,    2.1815262813,
    -2.0084432440,    6.1489585981,    0.4207290811,    2.0657104448,    2.8803091697,    4.1137955949,    -0.7171959257,    88.1322276095,    5.0509993699,    1.6797212279,
    0.8978882009,    2.4380437671,    1.7055452038,    1.6391285127,    7.8201879461,    7.5775943415,    1.3926371752,    2.6481001370,    22.1170474041,    5.5774195286,
    14.2464090460,    17.6613540570,    31.2920910725,    5.8004898541,    10.4049071665,    6.7035227382,    13.2365174266,    14.0647709216,    10.4776629333,    5.7172681464,
    5.2674909285,    0.8923546528,    -0.9308772593,    4.1952481526,    1.7424394727,    2.7901518056,    0.0779032501,    0.5988615938,    0.5485320551,    0.2531455962,
    0.0560215698,    3.0951341102,    55.9786053625,    0.4661473936,    0.0071899341,    0.0164769323,    0.0940683044,    0.1018573996,    4.4340139155,    1.1785145231,
    0.2782144168,    4.0836374560,    12.4128220491,    180.4344181849,    233.0534017807,    201.5467789427,    1370.4823247454,    451.5769922109,    358.6369165596,    314.0657209407,
    7.3709069600,    5.4219275132,    2.5780964539,    1.1196823866,    3.0896781958,    1.8558020598,    5.7889009977,    3.7669385026,    33.1441882811,    30.8443151061,
    27.9984197463,    24.5545281355,    7.9464286103,    7.1734280265,    6.4217002766,    1.9188941914,    121.4947913213,    0.0200800457,    20.1778680078,    11.6683814242,
    -6.1176405416,    -8.0460534437,    -6.7856083591,    15.2105896263,    -2.5883354942,    -3.7226398015,    -0.2014975193,    0.0641869661,    44.5772515903,    -5.0576339432,
    9.2583013577,    -4.4668868673,    0.5121060212,    -41.2113894622,    -22.9848585761,    -9.5994598533,    2108.1222851099,    -93.9901215974,    1249.1548481478,    -105.0883086064,
    0.3756179818,    -0.0141196442,    -0.0288611841,    -0.1583407493,    3.3215241545,    0.5885053761,    0.0470959366,    -0.1415607836,    -0.0233507129,    -0.2675667572,
    -1.4312513358,    -0.7234020201,    -2.3162236318,    -6.1668596756,    -0.3523748172,    -0.0001735965,    -0.0003491050,    0.0006237835,    0.6439930092,    -0.3522149581,
    -0.3063971018,    -0.0747235217,    -0.0689028088,    0.0757073027,    1.8722747705,    -0.0900918242,    -0.1450008609,    -0.3541639402,    -1.1519992469,    -1.5608870321,
    -3.0009181939,    0.0968145321,    -0.0063116532,    -0.0048965832,    -0.0044702029,    -0.0014275622,    0.1329429636,    -0.0070154465,    -0.0067263807,    0.1327858458,
    0.2913406452,    -0.0144636370,    -0.0342369666,    -0.1516726562,    -0.0560128635,    -0.4210332107,    -0.0119871625,    -0.0191092145,    0.0275996014,    0.0056718046,
    -0.1130406069,    0.1072666487,    -0.1231704293,    -0.0809070162,    0.0794380821,    0.1161582918,    -0.1512730788,    -0.0740482891,    -0.0663084871,    -0.0208366647,
    -0.0090909477,    -0.0051110003,    -0.0407048851,    -0.0547312871,    -0.0330903885,    -0.0909233242,    0.0427510938,    1.4203764738,    1.0061459898,    0.9004260747,
    0.7476691388,    0.6311169215,    1.0381495094,    0.9351940192,    0.4511051296,    1.1246360461,    0.6041715902,    1.0060864288,    0.7502553304,    0.9821832859,
    1.0458987347,    0.8791605473,    0.7407027798,    0.5031760070,    0.8699738214,    1.0371308901,    1.0106234491,    0.8897672796,    0.6547134409,    1.0668921582,
    0.8649558921,    0.8352880796,    1.0344619553,    0.9943257323,    0.8546784140,    0.8313900404,    1.0672636997,    0.9966787236,    1.0471106310,    -0.3632347031,
    5.3544053454,    1.0703614640,    5.2159760282,    11.8870072178,    2.2419429626,    10.9351145857,    6.8782227641,    0.6948173466,    0.8184541642,    3.1899340923,
    0.3423232517,    0.2148577731,    3.9592570401,    0.3544038346,    0.1129418814,    0.4988832844,    0.4941392223,    0.0048150904,    0.0069870019,    0.0260123024,
    0.1182593833,    0.2293475502,    0.0040712859,    0.0057941546,    0.0158959212,    0.0550766785,    0.1052407616,    1.2492017818,    0.0995300753,    0.4656766951,
    0.1340104745,    0.7600288597,    0.0593414007,    0.1789066226,    0.0334770202,    2.5569672897,    3.5294169725,    5.2170510605,    1.3202510320,    1.6802170774,
    2.1701516581,    10.4426676752,    6.4917797508,    5.8908821176,    4.4354129408,    3.1987176426,    2.2999475625,    1.4490146437,    0.8968734262,    0.7716804531,
    0.4901118957,    0.3381839879,    0.2180931963,    0.1338665394,    0.0800695056,    0.0506522088,    0.0289494237,    9.0479122558,    5.1468261013,    4.1176652976,
    2.7694096373,    1.7757328197,    1.1118629986,    0.6424913258,    0.3545840911,    0.6772057239,    0.3995062139,    0.2493591892,    0.1447633805,    0.0831274693,
    0.0450587199,    0.0267325282,    0.0137596206,    19.4601557819,    18.7234242637,    16.5671307254,    26.6393593034,    25.6961547951,    25.9405811863,    29.7141601594,
    1.0258797564,    1.1336484439,    3.8109389478,    1.4583582984,    0.0461354104,    2.1048532055,    0.0077890953,    0.1824445776,    2.4038346315,    0.5149790294,
    0.0179748352,    2.8503249371,    0.2983199972,    0.0373140067,    5.9925402799,    0.1140623509,    0.0659352620,    -0.1696181589,    1.5838110602,    6.8843661848,
    0.4586732389,    0.4554215369,    1.1633640264,    0.4265158920,    0.0337736766,    0.3156483548,    0.9673028561,    -0.1276799989,    1.1039256467,    0.2748006667,
    0.2850353671,    0.2789017191,    0.3114914237,    1.4535897934,    0.0000000000,    0.0000000000,    0.0000000000,    0.0197021587,    0.0000000000,    0.0000000000,
    0.6156762565,    203.1956261234,    0.2213880060,    0.0363112487,    0.2868115229,    2.7125908776,    0.8575279780,    0.0289463334,    -1.4980527262,    -0.1291000485,
    0.2382093898,    2.2354982294,    2.9927416426,    59.7745446352,    82.6115101219,    0.3313092382,    0.3198256667,    0.6483084579,    0.7342582672,    0.7580322218,
    2.2627326118,    17.9997663920,    26.9044894586,    34.5837897393,    35.4639331071,    35.7376376948,    30.8214047839,    0.3151587777,    9.0982456758,    0.2537588920,
    22.1170474041,    3.3789335047,    1.6071892843,    5.8004898541,    6.4448500423,    8.3369864034,    8.4055822992,    10.4049071665,    6.7035227382,    8.3492473774,
    13.2365174266,    14.0647709216,    5.9027445587,    10.4776629333,    5.7172681464,    5.2674909285,    0.8923546528,    -0.9308772593,    4.1952481526,    1.7424394727,
    2.7901518056,    0.0779032501,    5.8079334228,    0.4079973411,    1.6410798209,    1.3286890469,    0.3818903682,    4.8669096294,    6.2225152179,    0.1873649801,
    1.9115865037,    1.2441304720,    3.3352482993,    3.1481487008,    34.3481096465,    0.3643450003,    0.0907843736,    0.0111994402,    0.0013071324,    3.9714397610,
    4.7115587680,    0.2943734790,    4.2945267292,    0.6275280590,    0.0826074442,    0.4077319779,    0.1987915566,    0.1095051567,    1.1008205562,    -0.0006824664,
    0.0842106671,    0.0963089225,    0.0412383554,    0.0419837815,    0.0498501388,    0.3724252305,    0.0066416168,    0.0810455902,    0.6800619540,    0.0129267599,
    -0.0003781037,    0.0005446846,    0.0686204121,    0.2987573717,    2.1632714200,    0.0009758996,    0.0272645088,    0.1204775559,    0.1221587686,    -0.0198465760,
    2.0721953945,    0.1329785987,    0.1618882864,    0.1302542300,    0.0207392979,    0.0303190105,    0.2355035047,    0.1726348113,    0.6135940683,    0.6074101258,
    1.1638966447,    1.0200344518,    6.0300281339,    6.6623311480,    0.7165561957,    2.1426174381,    1358.4425391964,    1.2490238655,    3.9320755127,    0.0221689635,
    0.0074895147,    0.0020970641,    1.5791875743,    147.8203277131,    6.7943675906,    1.0038125253,    0.6029309648,    1.2122730784,    1.4799693643,    1.0065300490,
    0.1896420127,    0.4083252052,    17.2458817002,    7.1178855715,    7.0834798481,    20.7942428001,    203.1259088394,    66.6278327444,    0.6175429180,    3.0991259458,
    -2.9403265889,    -403.7558727996,    -5633.5972587760,    34.2315111646,    375.1516862278,    1.5791875743,    1.0038125253,    6.7943675906,    0.6029309648,    1.0065300490,
    0.1896420127,    1.2122730784,    1.4799693643,    147.8203277131,    3.1286667134,    1.8608031031,    61.2055345730,    0.6501285590,    1.3680508372,    0.1261248053,
    1.6092622025,    2.1991635448,    27817.0790180652,    1.9358686331,    13.5469612613,    1.1758707975,    1.8024412075,    0.3137824932,    1.9652527809,    2.3499938521,
    293.6822993540,    9.5666592081,    0.7598568828,    1.4280127064,    0.2109878323,    1.3890343479,    1.5353974846,    193.2360492919,    5.2805424111,    8.4095010713,
    1.4346159998,    8.6958967105,    10.1881126639,    1291.6954180746,    0.7501081642,    0.1844630832,    0.7228164008,    0.8915044711,    109.1926666343,    0.2167783495,
    1.3167117468,    1.5230425637,    173.6064217556,    0.2370573984,    0.2801837473,    28.6997972423,    1.8064973687,    186.7098477868,    220.8196522091,    5.0131486099,
    55.9786053625,    182.9404336991,    0.2824282559,    197.5559677190,    52.0237157324,    36.9550819283,    1.3325271511,    1.7890512235,    1.3857931188,    2.6285113265,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    3.8256343931,    0.6501285590,    1.3680508372
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.1930436029,    0.1064114294,    0.0772569487,    0.6448531115,    0.3325793858,    0.1102102380,    0.0244704348,    0.4665288370,    0.1286551264,    0.2655318470,
    0.1169991646,    0.0772174412,    0.0733134357,    0.0772174412,    1.6904475393,    3.6115326835,    0.2052538084,    0.2546871989,    0.4363869187,    1.1077037077,
    0.1891321790,    0.7261084443,    0.8753371555,    0.2109398376,    0.1599538720,    0.4352669848,    0.2274651303,    1.7458408225,    0.2489613817,    3.1908451958,
    2.5022597083,    1.4182051655,    0.0962642446,    0.0880909572,    0.0546519077,    1.7318036519,    85.0067626352,    0.3098765497,    0.4997248451,    0.7962811432,
    2.6801599133,    0.8492777301,    3.3437976244,    0.7547100663,    0.1464470466,    8.2015182830,    135.3710968435,    134.7139812961,    42.0033559181,    0.1490084286,
    0.1535263379,    0.1543452911,    0.4016086531,    0.4743011444,    0.5481857178,    18.3969083354,    2.7788075998,    0.2979502103,    0.2285719905,    0.2940061956,
    0.2995654133,    1.4907510761,    0.7249771573,    0.5066095123,    0.8274416790,    2.7168200837,    1.0378218355,    47.0493818082,    5.7493546736,    4.3112727780,
    2.9226230205,    4.6455593333,    3.9653544196,    5.9189410559,    9.0309859253,    9.7571317574,    3.6958475152,    5.7884495550,    27.9515897337,    8.7968393698,
    16.4592939947,    20.3112015438,    32.0640083629,    12.6876442460,    18.5833668286,    10.6829202575,    19.8017489053,    20.4177624104,    34.8056040878,    8.9000820723,
    7.8685770135,    2.1012062682,    8.3608310712,    6.0843897042,    5.1390703115,    3.7068892624,    1.4725640645,    0.9924634628,    0.8785844679,    0.5690994355,
    0.2888604740,    2.3439478574,    29.7310194455,    0.9572458144,    0.1221774701,    0.1341749847,    0.3624291226,    0.4471360446,    0.5407361617,    0.1112462625,
    0.0966124675,    1.8833918878,    9.6001100206,    174.4835157188,    266.0930017766,    346.2881484932,    1464.4526836022,    1046.7743120508,    227.2992369534,    318.2237498568,
    5.9357020603,    5.3465082363,    4.3832041723,    3.7784198575,    1.0585263382,    0.9629445357,    6.8528441767,    5.3008180596,    66.1791624996,    48.7240081308,
    34.6406694536,    36.4259275395,    1.0672512504,    2.4623177349,    1.2775294600,    0.7300479924,    77.6359102781,    0.1802591810,    25.3513745440,    47.2208255203,
    73.9448647096,    53.0119208253,    50.6656096843,    11.6321186578,    4.5224427131,    5.6811236087,    4.7819327531,    4.6970128428,    67.6742225248,    8.1180856529,
    27.8592199471,    40.1370273982,    37.9988558671,    238.2195872742,    349.6804982243,    243.0293262414,    3607.5968017698,    1907.4605425379,    801.7889649352,    489.2923443063,
    1.2981237645,    2.3091777385,    1.5558305873,    1.3294943157,    3.5586523265,    1.8195486384,    3.6722760890,    0.6196172070,    2.6244110875,    1.1900188759,
    3.0335002487,    3.5257779933,    18.3611414231,    25.2158755717,    16.7960203920,    0.0063078852,    0.0061856996,    0.0073471071,    0.7975525906,    1.1547543906,
    1.2871231344,    0.1068338981,    0.1095408216,    0.2150026975,    2.3735308739,    1.0336089103,    0.9521206406,    8.1434619755,    9.5658146025,    4.1814442256,
    10.0943451945,    0.0788789644,    0.0240177029,    0.0337635943,    0.0564695459,    0.0451517737,    0.1034699318,    0.0288122189,    0.0506100135,    0.1297956039,
    0.2236530636,    0.0753243306,    0.0786430006,    0.3943394841,    0.3949201673,    0.2414723232,    0.2230562830,    0.1910237346,    0.2946165913,    0.3059579824,
    0.2303538406,    0.3969267273,    0.1618754203,    0.1765041337,    0.2392034618,    0.2990578498,    0.1739133770,    0.2239295651,    0.2806566211,    0.3468747719,
    0.3911362582,    0.1291304960,    0.1206997214,    0.1657777348,    0.1964360697,    0.2199765687,    0.2765755068,    0.3246574905,    0.4317066340,    0.5126416006,
    0.6250307486,    0.6931741238,    0.4337952902,    0.5453597625,    0.6143375139,    0.4177657341,    0.5164954484,    0.4164877227,    0.3084072184,    0.3979204472,
    0.6874584507,    0.9189778883,    0.9574062828,    0.7755958027,    0.2681130161,    0.3181796835,    0.4011013801,    0.7408266438,    0.8708283902,    0.3646031759,
    0.3323828641,    0.3240807367,    0.3781147832,    0.6303111414,    0.3280994039,    0.3029218260,    0.4561404914,    0.5946797475,    0.3761214258,    0.1018333526,
    1.2011271453,    0.6921981984,    2.1818497166,    2.7075982745,    0.5698448169,    0.3278706635,    3.8613561588,    0.9941938898,    1.1160873871,    2.9449503748,
    0.1852577370,    0.1320927812,    4.4370457922,    0.8943166977,    0.4191423634,    0.4038819875,    0.4010082777,    0.0392725287,    0.0540965121,    0.1022842042,
    0.2157508030,    0.4660574886,    0.0335237518,    0.0469584478,    0.0789407722,    0.1653283084,    0.4211241892,    1.2726708097,    0.2487546487,    1.2261984281,
    0.6316459058,    0.9030369298,    0.2070785819,    0.4297184669,    0.2097122453,    3.3324765000,    4.7155280660,    8.1985710191,    1.7816749089,    3.0733991433,
    5.4387930784,    5.6699865329,    3.6622745780,    3.7280100000,    3.3401144027,    2.7231087216,    2.2666511601,    1.6693106983,    1.2428703626,    0.0571138728,
    0.0713809790,    0.0789434001,    0.0753661585,    0.0626811893,    0.0478757608,    0.0365582567,    0.0253002202,    4.8079157938,    2.9740547666,    2.7159569041,
    2.3509264438,    1.8852390324,    1.4470751164,    1.1673804543,    0.9286667257,    0.1448760510,    0.2013333058,    0.1737760485,    0.1071980947,    0.0818944637,
    0.0518391789,    0.0400221976,    0.0278740812,    11.0890962183,    11.2705933597,    8.9191048411,    14.9789417903,    14.3972667609,    14.6506784366,    17.2017573744,
    0.0639218646,    0.0452623062,    1.2807376321,    1.6904475393,    0.2489613817,    3.6090103180,    0.0944814670,    0.6892766009,    3.1808684634,    1.1077037077,
    0.1457625040,    3.5236656742,    1.2953510270,    0.8469416670,    9.5666006537,    0.8416943297,    0.3925012130,    0.9521756170,    4.7633349264,    11.4984072086,
    2.3508319216,    3.0648558641,    0.9896638043,    0.6130441533,    0.4310504665,    1.0861429004,    3.3463670249,    0.6265846553,    0.9477233694,    0.5628631547,
    1.2012043008,    0.9832348702,    1.0722115054,    2.2840664366,    1.0000000000,    1.0000000000,    1.0000000000,    0.2022495912,    1.0000000000,    1.0000000000,
    2.5891464705,    258.9464408212,    0.1395385937,    0.0767181617,    0.1106276047,    2.1724657601,    0.1555367852,    0.0535580731,    4.9340197943,    0.3173556430,
    0.2251370857,    0.5854493455,    0.7085721404,    39.7950565335,    58.1735328699,    0.1154647699,    0.1186674215,    0.1374692076,    0.1332421247,    0.1394277564,
    0.8982329464,    10.1954252981,    11.4163871646,    15.7868766718,    17.0511151007,    23.1580439517,    18.5832589446,    0.4645790810,    13.6756656121,    1.2755139303,
    27.9515897337,    11.7774915694,    4.2662084712,    12.6876442460,    9.9019850749,    10.6810218037,    10.7717067731,    18.5833668286,    10.6829202575,    14.5383780822,
    19.8017489053,    20.4177624104,    12.8201133462,    34.8056040878,    8.9000820723,    7.8685770135,    2.1012062682,    8.3608310712,    6.0843897042,    5.1390703115,
    3.7068892624,    1.4725640645,    10.5735856707,    0.9375282639,    2.1297229503,    2.2845712932,    1.1760500581,    6.9020568081,    7.1707508395,    0.5185805677,
    0.1106346933,    2.3143554139,    2.3609706010,    2.6116064041,    35.3351868150,    0.5122660621,    0.0420116443,    0.0121772437,    0.0032678928,    0.7413135195,
    0.8767998754,    0.5460880956,    3.4518787346,    1.0055332610,    0.2413133227,    0.4221835135,    0.1615813717,    0.1494981018,    0.7850507056,    0.0164656326,
    0.3742521118,    0.4061756291,    0.3253058925,    0.3555212913,    0.4705638177,    1.8126004805,    0.1430178771,    0.5563638332,    2.2848290202,    0.1538451630,
    0.0222660455,    0.0314646701,    0.6889171842,    2.2724563731,    2.7226507607,    0.2145986427,    0.1273127424,    0.5173804546,    1.0037522808,    0.1600032685,
    2.3859744383,    0.4538889108,    0.4654188941,    0.4445838349,    0.1285347099,    0.1331110752,    0.3977245388,    0.2915269124,    0.6520776577,    0.6560926364,
    0.8258584769,    0.9529388325,    3.0520627141,    2.3231782002,    0.1973126579,    0.3763887832,    4074.4483885699,    0.9524063239,    0.7038575355,    0.1930173335,
    0.1257842530,    0.0457456712,    0.7967642804,    77.2413731938,    3.8784150908,    0.9236685104,    0.5353529776,    0.3737060155,    0.0940968948,    0.5957752074,
    0.3002677344,    0.1444445060,    1.9660444170,    4.7969132069,    4.0745860100,    3.6660949756,    135.8111218113,    27.9326242915,    2.9500655157,    2.2448161109,
    2.5524227117,    646.3706025047,    3445.7428433571,    94.8004136058,    72.9663531564,    0.7967642804,    0.9236685104,    3.8784150908,    0.5353529776,    0.5957752074,
    0.3002677344,    0.3737060155,    0.0940968948,    77.2413731938,    3.8561442403,    2.7345763721,    80.2760132836,    1.4400990411,    1.4834002978,    0.3525490132,
    1.1306934915,    0.2822964712,    32989.1892836892,    2.6792645739,    16.9009862900,    1.9437845312,    1.8120433138,    0.7118100998,    1.2534641912,    1.1928615909,
    353.0569033922,    13.5743724007,    1.4816805794,    1.6865051042,    0.5849709585,    1.5450859815,    1.4193927819,    266.1318100437,    9.6023030802,    8.8762546325,
    3.5312683666,    6.3853242701,    5.9175673729,    1595.1210883654,    1.0778308915,    0.5217945071,    0.7016829694,    0.7926121201,    181.3816257977,    0.4704929359,
    0.9533012697,    0.9463440955,    175.4520356677,    0.4098957558,    0.4467403106,    66.4256343729,    0.6124154966,    128.3191672354,    117.4459251412,    3.6758963068,
    29.7310194455,    88.9310857427,    0.0470682231,    105.0627297630,    26.0327656042,    19.3103432984,    0.3037095739,    0.4272812493,    0.3309706325,    0.6099458947,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    3.1686356183,    1.4400990411,    1.4834002978
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 502;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    0,    12,    13,    15,    16,    19,    23,    26,    27,    34,    36,    40,    45,    60,    66,    67,    69,    70,    75,    78,
    79,    82,    83,    85,    90,    93,    94,    97,    100,    111,    122,    131,    132,    146,    153,    155,    159,    180,    181,    183,
    221,    226,    291,    293,    295,    296,    297,    299,    300,    302,    303,    304,    306,    307,    308,    309,    310,    311,    312,    313,
    314,    315,    316,    317,    318,    327,    332,    337,    338,    340,    341,    344,    345,    347,    350,    351,    355,    356,    357,    358,
    366,    370,    374,    375,    381,    382,    384,    385,    386,    388,    389,    390,    391,    392,    393,    394,    395,    398,    410,    412,
    415,    421,    422,    438,    441,    446,    452,    511,    514,    516,    519,    523,    531,    543,    545,    564,    573,    578,    599,    620,
    642,    644,    647,    650,    653,    656,    660,    663,    670,    671,    672,    673,    698,    701,    714,    724,    739,    747,    751,    752,
    753,    756,    757,    759,    761,    762,    766,    767,    768,    769,    770,    773,    774,    780,    781,    785,    786,    790,    795,    800,
    806,    807,    810,    811,    813,    815,    816,    823,    828,    832,    834,    835,    842,    843,    846,    852,    853,    857,    859,    861,
    863,    869,    870,    875,    876,    879,    880,    886,    889,    904,    907,    912,    913,    915,    918,    920,    921,    922,    924,    930,
    939,    940,    942,    949,    952,    957,    958,    960,    962,    963,    967,    972,    975,    976,    979,    980,    981,    984,    985,    986,
    987,    997,    1005,    1037,    1038,    1045,    1050,    1053,    1056,    1057,    1058,    1059,    1064,    1065,    1068,    1071,    1074,    1077,    1078,    1079,
    1081,    1082,    1083,    1084,    1086,    1087,    1088,    1090,    1092,    1101,    1109,    1110,    1111,    1113,    1117,    1118,    1120,    1121,    1127,    1150,
    1151,    1152,    1155,    1160,    1169,    1172,    1256,    1271,    1282,    1287,    1288,    1289,    1293,    1297,    1298,    1299,    1300,    1301,    1302,    1303,
    1304,    1305,    1306,    1307,    1308,    1309,    1310,    1311,    1312,    1313,    1314,    1315,    1316,    1317,    1318,    1319,    1320,    1321,    1322,    1323,
    1324,    1325,    1326,    1327,    1328,    1329,    1330,    1331,    1332,    1333,    1334,    1335,    1336,    1337,    1338,    1339,    1340,    1341,    1342,    1343,
    1344,    1345,    1346,    1347,    1348,    1349,    1350,    1351,    1352,    1353,    1354,    1355,    1356,    1357,    1358,    1359,    1360,    1361,    1362,    1364,
    1368,    1372,    1384,    1405,    1406,    1407,    1408,    1409,    1410,    1411,    1483,    1506,    1510,    1512,    1534,    1548,    1549,    1552,    1589,    1594,
    1596,    1598,    1607,    1609,    1613,    1629,    1638,    1646,    1708,    1710,    1722,    1729,    1730,    1737,    1742,    1758,    1759,    1776,    1777,    1778,
    1797,    1803,    1807,    1808,    1820,    1827,    1839,    1843,    1844,    1845,    1850,    1855,    1856,    1861,    1862,    1866,    1872,    1874,    1875,    1876,
    1879,    1884,    1885,    1887,    1888,    1892,    1893,    1900,    1916,    1917,    1920,    1934,    1935,    1936,    1937,    1938,    1939,    1940,    1941,    1942,
    1943,    1944,    1945,    1946,    1947,    1948,    1949,    1950,    1951,    1952,    1953,    1954,    1955,    1956,    1957,    1958,    1959,    1960,    1961,    1966,
    1976,    1981,    2002,    2003,    2153,    2158,    2165,    2169,    2173,    2182,    2183,    2252,    2254,    2257,    2268,    2269,    2271,    2272,    2274,    2328,
    2346,    2347,    2362,    2378,    2477,    2484,    2488,    2507,    2512,    2517,    2518,    2537,    2541,    2547,    3034,    3146,    3202,    3210,    3244,    3249,
    3399,    3406,    3407,    3502,    3510,    3567,    3594,    3765,    3766,    3767,    3768,    3769,    3774,    3781,    3796,    3833,    3834,    3835,    3848,    4002,
    4026,    4073
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 23;
constexpr int N_PHYSICS_FEATURES = 74;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
    "dD",
    "dH",
    "dP",
    "HansenTotal",
    "BP",
    "deltaHvap",
    "logVP",
    "logPow",
    "logWS",
    "deltaHf",
    "deltaHc",
    "MP",
    "Flashpoint",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
    "loghenrycc_dh_s_est",
    "loghenrycc_dh_sq",
    "loghenrycc_s_sq",
    "loghenrycc_dh_flashpoint_est",
    "loghenrycc_dh_sq",
    "loghenrycc_flashpoint_sq",
    "loghenrycc_b_s_est",
    "loghenrycc_b_sq",
    "loghenrycc_s_sq",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/loghenrycc_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/loghenrycc_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadelogHenrycc
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadelogHenrycc {
struct Model {
    using Namespace = CascadelogHenrycc;
};
} // namespace CascadelogHenrycc
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
