#pragma once
// Auto-generated Treelite model for logODT (v3.4 XGBoost)
// Trees: 300, Features: 611
// Target normalization: mean=2.3022996722, scale=1.8237134512
// Library: logodt_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadelogODT {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 611;
constexpr double TARGET_MEAN = 2.3022996722;
constexpr double TARGET_SCALE = 1.8237134512;

// Normalization stats
constexpr int N_NORM_FEATURES = 611;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0064608758,    0.0165111271,    0.1952620244,    0.0419956927,    0.0010768126,    0.0222541278,    0.0183058148,    0.0028715004,    0.0229720029,    2.0635319454,
    3.1450107681,    0.1475233309,    0.0107681263,    0.8111988514,    0.0143575018,    0.5595836324,    0.0929648241,    0.3040201005,    0.1604450826,    1.6195262024,
    0.5380473798,    0.5312275664,    0.0229720029,    0.6313711414,    0.9404163676,    4.4874371859,    3.8133524767,    8.4897058813,    0.1808900812,    0.5325127570,
    17.9600698370,    162.2348435032,    162.0588255578,    0.3521185824,    0.1550373069,    1.3124030553,    1.9080081766,    19.6912458880,    -2.0565040284,    2.1390138906,
    -2.0269909516,    5.8463965399,    2.7444784214,    180.9093699742,    2.3237529067,    -0.5624325710,    9.1544685903,    4.6683341571,    19.8331870744,    0.1115703009,
    0.8308816012,    23.6189935156,    20.8714729584,    5.6249333920,    4.5095350465,    33.7554769704,    0.2245840565,    5.0924534830,    11.3350592580,    4.8189985066,
    6.0778845563,    11.3707404555,    4.0573600971,    0.7428581176,    0.8532189254,    0.4220182051,    1.6110398644,    4.5510677094,    4.5295028710,    1.6335247667,
    0.3356066045,    0.3894472362,    4.0406693891,    2.4301790057,    47.2337489591,    0.0434314429,    0.0204594401,    0.0071787509,    0.7304379038,    2.1793792138,
    1.1817059097,    98.5459058963,    17.6701762782,    33.4253409907,    90.0537855623,    68.4513312894,    139.9221415432,    468.7383345298,    659.9276422857,    3194.7416348751,
    459.4973013719,    317.7147218327,    228.4731281389,    36.6479555938,    45.8990317391,    10826.1911495684,    7407.6491144803,    4.5418982357,    3.9409005397,    1.6835095634,
    1.0570076495,    0.8026796585,    0.3901718314,    0.2301427048,    3.7510225938,    2.7482765862,    2.5838392732,    2.1156319140,    1.2233683280,    10.5711717529,
    6.5326592845,    74.1829172704,    35.2007732130,    26.6270135850,    180.2286365107,    147.1897736004,    120.1216472918,    71.8709448600,    7.5753383704,    6.9717136921,
    5.6303210586,    6.0755068255,    5.3395759837,    1.4166653896,    1.0198190468,    0.9044637487,    0.7873060207,    145.4722285307,    155.6369170465,    161.1219863170,
    134.1540838922,    114.8596298839,    0.2974842671,    -0.1358725929,    -0.0101655650,    0.0129960634,    -0.0158152368,    -0.0123383148,    0.0141033783,    -0.0072973521,
    0.0030576378,    23.5824734556,    2.8918532689,    -20.3379189560,    -22.6630037041,    -13.4378412246,    -5.4595292914,    -5.0692928812,    4.2100515965,    -2.6506381806,
    -1.3149183364,    -0.5405065494,    29.4098692508,    -1.7943389337,    -2.5823563317,    -4.2679212048,    -4.8849843189,    -2.9245535234,    231.1195171583,    6.0689234161,
    -54.7673514682,    -46.8953523482,    2.4246633870,    7.5667805295,    11.1476747985,    -261.3024287343,    -32.0318459999,    -278.5172252892,    -140.6175010056,    -72.6036946126,
    67.7095261360,    1.4020353079,    -0.0234389040,    -0.2355191058,    -0.0663202491,    -0.1220946536,    -0.0162323784,    0.0031111093,    -0.4047176963,    -0.4045127090,
    6.8789080529,    -0.4289809144,    -1.8430341863,    -1.3656477507,    -0.5584623083,    0.1808251018,    -2.3337735331,    -3.3346385546,    -8.4598512119,    -1.9882619234,
    -1.0988044023,    1.4699395301,    -0.0058375977,    -0.0003059529,    -0.0003818220,    -0.0002030888,    0.0003207027,    0.8427940879,    -0.4419662391,    -0.0818941761,
    -0.0762797919,    -0.0505854915,    0.0096305286,    -0.0966004963,    -0.1192470062,    -0.1355695585,    -0.1020485688,    -0.0154863169,    -0.1917835109,    -0.4295008443,
    -1.2547374794,    0.7151696875,    50.7530793370,    -1.8749681355,    2.4021167611,    5.7374169384,    0.0578995475,    -0.0058418818,    0.0004339548,    -0.0103683283,
    -0.0104233945,    0.2717960697,    0.0116420398,    1.3158381735,    -0.1184333070,    -0.3973454871,    -0.0461491341,    0.0009576002,    -0.0210261561,    0.0360123474,
    -0.1345357000,    -0.1326344439,    -0.0210748221,    0.0617757617,    0.2656270022,    -0.1495643854,    -0.0992462339,    0.0128236688,    -0.0883094669,    -0.0743026449,
    -0.0805921562,    -0.0158861886,    0.0055059255,    -0.0678243714,    0.0174145150,    0.0075888064,    0.0186489742,    -0.0208576097,    0.0452298647,    -0.0664310617,
    -0.0839334283,    -0.0238099409,    -0.0845926071,    -0.0998314883,    -0.0540078175,    -0.1221154192,    0.0419536788,    -0.0895826492,    1.3467740423,    1.0492998553,
    0.9970859815,    0.9371013205,    0.7817363255,    0.7672731734,    1.1556183991,    1.0733255818,    0.8208102518,    0.4738230414,    1.5956499340,    1.2029474938,
    0.7403203285,    0.4177015941,    0.8788561190,    0.7003042748,    1.0039713813,    1.0592466559,    1.0859961757,    0.9977215958,    1.0420634081,    0.9646762746,
    0.4797741930,    1.0004709288,    1.0400528502,    1.0940222538,    0.9840328301,    0.8101521896,    0.8304640931,    1.0869782882,    0.5605341278,    0.8481341790,
    1.0864604995,    0.8687101596,    1.1467873151,    0.9719220694,    0.7226176255,    1.0993450339,    0.9495496304,    0.8280466612,    0.6976076378,    0.3530061946,
    -0.3833580281,    1.0185954106,    0.9928231286,    5.6308903666,    9.6157105182,    21.6504706547,    3.4205697618,    2.4804388714,    60.2064593384,    0.5298833193,
    3.2374941587,    0.3108349385,    1.1996648716,    42.1927342257,    3.5019167538,    3.6072475237,    34.0743820166,    -0.5494212270,    0.3111222963,    1.2002859128,
    42.1668073852,    30.9923668341,    46.6373083128,    61.9321095713,    5.0509467291,    30.9954235319,    0.3832472058,    3.2388680699,    0.3111169748,    3.4981295597,
    46.5171152341,    6.0815219939,    0.4233768173,    0.6572146447,    1.8707824838,    0.6723422524,    0.0433899707,    0.1951120784,    0.6229352650,    0.1354574474,
    0.8788315259,    0.7688756007,    0.2287884753,    0.0628045320,    0.0378489672,    0.5221000466,    0.1022938651,    0.0361220930,    0.0194500710,    0.8111988514,
    0.0100502513,    0.0157932520,    0.3040201005,    0.0000000000,    0.0258435032,    0.0007178751,    0.0000000000,    0.0258435032,    0.0046661881,    0.0111270639,
    0.0000000000,    0.0287150036,    0.0136396267,    0.0003589375,    0.0003589375,    0.0674802584,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0053840632,    1.1723980732,    2.1338872788,    2.1412537675,
    1.8190502768,    0.3117124910,    0.8908775504,    0.5153288813,    0.2028363509,    0.2775447760,    0.0007410888,    5.6325202647,    1.7195202533,    0.1743506600,
    0.1177289161,    0.1678092064,    1.7920821463,    0.6265691757,    0.4875037943,    0.1347574179,    0.2207231319,    0.0840382350,    0.9544358346,    0.4911300579,
    0.2977907797,    0.1890046819,    0.5347538273,    10.3123645718,    0.8698449462,    0.4733320453,    4.1765790845,    1.4764491751,    0.0179199770,    0.0236255629,
    0.5275137409,    0.5079894580,    0.7933690562,    -0.0775502559,    1.2612762978,    3.0475923208,    3.7001168602,    3.7278300632,    98.3061666862,    0.4522192152,
    0.6662069464,    0.7713742659,    0.7564760415,    0.7845007716,    0.7885750699,    1.5672477658,    25.0306752552,    26.7800460618,    29.0813439020,    20.0664071941,
    19.5214204707,    4.3023378080,    2.5670998486,    1.9481428254,    0.4205173424,    18.2116691512,    0.0556060512,    2.3956981900,    1.2052801965,    0.0807609476,
    0.2768360684,    0.0505468634,    0.0359550412,    0.0103719194,    0.0062785306,    0.0016096210,    1.0902031521,    2.6677509572,    1.8592964824,    0.0482478980,
    0.0691298682,    1.6625686185,    1.5449493056,    0.0651618582,    0.2614012440,    0.2216219811,    0.2658716481,    0.0098032421,    0.9845909178,    0.8611020724,
    0.0559434663,    0.7793029279,    0.2058555367,    0.7107648252,    0.5073399166,    0.3377930441,    0.0317185160,    0.3376982012,    0.3432263157,    0.0854064651,
    0.0260352089,    0.0338280602,    0.0484920629,    0.0025282311,    7.2714178088,    0.3732950467,    0.7059784395,    0.1440887582,    0.3551383332,    0.2318186953,
    0.0550014966,    0.0971525166,    0.2270117359,    0.0749474840,    0.0862148219,    0.0322793197,    0.7153535809,    0.2469616864,    0.2365088071,    0.5204386217,
    0.8006206030,    0.5637699210,    5.3468804738,    1.4339851926,    5.7038148307,    5.4562122234,    0.1035152124,    0.6482556079,    411.5198747205,    1.1316172469,
    1.9396537962,    3.6397439457,    1.4016553313,    125.8438947682,    5.4600531759,    0.5674037914,    0.5744394436,    0.9713607723,    1.4491837575,    0.7198321397,
    0.0999583729,    0.3859906181,    16.5125242945,    5.9261373017,    5.7697046038,    18.8580380544,    136.7846345403,    52.3542699170,    2.1195843114,    2.6788320993,
    -1.6487689900,    -319.6375154127,    -5712.3544708429,    -10.1032275875,    335.2224328068,    2.7251500882,    1.8144932920,    0.3403886123,    1.4016553313,    0.5674037914,
    5.4600531759,    0.5744394436,    0.7198321397,    0.0999583729,    0.9713607723,    1.4491837575,    125.8438947682,    2.1744506668,    0.4536266956,    33.2471341539,
    0.3824615585,    0.6089994203,    0.0462331717,    0.9840633285,    2.1033143409,    17600.2369111367,    0.8262986450,    8.4283132933,    0.8446239291,    1.0176251895,
    0.1279129550,    1.3503572226,    2.0315272253,    195.3492251644,    3.4500478475,    0.3413654150,    0.4715181608,    0.0592565899,    0.5904775683,    0.8352343814,
    76.5185308029,    3.3169275617,    4.1317147776,    0.5183701780,    5.3475991979,    7.9385460095,    761.1067246906,    0.4359025102,    0.0647236470,    0.5561352182,
    0.8320722002,    75.7431562726,    0.0761214000,    0.7249664120,    1.0528582011,    92.2226083991,    0.1007347815,    0.1462866287,    11.3338194287,    1.4128207264,
    121.9483382677,    182.6378321297,    4.1108701275,    0.0416367552,    0.0427135678,    0.1170136396,    0.0272792534,    0.0035893754,    0.0599425700,    0.0132806892,
    0.0394831299,    0.8226848528,    0.4307250538,    0.4307250538,    0.0129217516,    0.0574300072,    0.0294328787,    0.0157932520,    0.0139985642,    0.3692416162,
    0.7562814070,    47.2337489591,    169.1121570978,    0.2677256145,    177.0842110196,    45.1878748525,    31.4609736920,    1.3103418352,    1.7939574238,    1.3895934453,
    2.6212324986
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.0844808143,    0.1274304114,    0.4235432611,    0.2289889322,    0.0327971509,    0.2503552710,    0.1539925734,    0.0846788367,    0.1635589817,    1.4547191376,
    2.8769584702,    0.5042418456,    0.1032093688,    1.0426460409,    0.1578590836,    0.5628512677,    0.3960148352,    0.6643131097,    0.4707072805,    1.9775024833,
    0.7135412073,    2.2001258857,    0.1568372253,    1.3691318247,    2.0979350184,    5.3913619826,    6.6725521090,    2.9568836130,    0.7061865402,    0.1161323618,
    11.8332157664,    52.8689735670,    52.7833305219,    0.1154101560,    0.1038914308,    0.3077769934,    0.3773259459,    10.3971492827,    0.2256431569,    0.2613797359,
    0.2607441987,    1.1423930233,    0.5622196683,    121.1822716515,    1.7781512654,    0.5540148517,    3.0883169733,    2.5426652723,    440.5582821736,    0.9206906843,
    3.1136054980,    16.9028937482,    14.3194421426,    5.5967452162,    5.8712617484,    21.8902484221,    1.3937952334,    7.1705346024,    12.5458498416,    5.7421673255,
    6.2285314542,    8.8953097778,    6.5566659465,    2.5935988709,    1.4448583362,    0.8525201983,    3.5403283628,    4.3503699427,    3.3707735218,    0.9523516793,
    0.6959032578,    0.7710784694,    2.5758316556,    1.2561603764,    15.7291821114,    0.2073183612,    0.1465489732,    0.0844228431,    1.8667528716,    0.2455080635,
    0.0906022031,    75.8690913227,    30.0138306209,    45.3332043348,    37.6102948713,    22.5467899983,    82.4916434765,    374.2357995767,    866.2061336643,    3654.4894365424,
    237.1220703841,    271.8621843495,    232.2214450627,    13.8104045735,    18.6359369986,    7023.6290302980,    6372.3814794508,    2.8575034908,    2.3697149453,    1.5769535170,
    1.0843084776,    1.0405347024,    1.2879052303,    0.8479649868,    2.9897930379,    1.4983365109,    2.5784333657,    1.0689393354,    1.4541785848,    13.2305145115,
    4.6606949755,    248.2680762129,    60.5119927779,    53.7862384449,    42.0024367998,    41.4417597283,    38.3369572865,    48.6961415643,    0.4040489855,    1.6135427618,
    0.9501010216,    0.4229649197,    1.2648567011,    0.5413198801,    0.3078603964,    0.3162056299,    0.3464780672,    5.5933959348,    8.6598619759,    25.2624930419,
    69.8847236326,    82.4720434427,    0.1966736691,    0.1232892387,    0.0936276141,    0.1079107830,    0.1020122829,    0.0798745417,    0.0711478993,    0.0475336377,
    0.0352827619,    17.7779372018,    20.2207218127,    26.8340238421,    30.0368841183,    31.1813435607,    24.2616348588,    24.4249406823,    4.4763134218,    2.7767944613,
    4.6976416427,    4.2976053631,    18.6944984836,    2.9723200964,    8.4441285097,    10.4341246946,    12.0241111675,    10.1479061182,    196.9478439507,    83.6463341643,
    87.9407155423,    108.7097178944,    95.2704021462,    64.5400438579,    189.6056130509,    425.6410186432,    105.8158518349,    580.7486701619,    567.6522094027,    489.1076273928,
    442.2001015828,    0.7893760907,    0.1622956716,    0.5258083102,    0.4018200795,    0.4123411248,    0.3114962509,    0.2246316201,    0.9582226399,    0.9382319318,
    4.0771141241,    2.2592876149,    3.1434298195,    3.0418583988,    2.6875320593,    2.7329166179,    4.8786397746,    10.3971516457,    12.3926930102,    12.8534915228,
    10.7108093127,    9.7987689765,    0.0065706379,    0.0031174750,    0.0031511571,    0.0055134984,    0.0029052491,    0.6310540970,    0.8155176814,    1.0082191213,
    0.0887648581,    0.0863096295,    0.1081225982,    0.3361274879,    0.4594819576,    0.5258373513,    0.7991501800,    0.5821042258,    5.9417778032,    7.0137450371,
    4.2548642522,    2.8572307449,    7.0059995325,    13.0038864788,    15.7071561987,    16.3833617705,    0.0377587904,    0.0197733363,    0.0200705806,    0.0274621804,
    0.0278263967,    0.1976409040,    0.0873804057,    0.3114646762,    0.2774460876,    0.1874743323,    0.1549281338,    0.1411523632,    0.1292295776,    0.1978669142,
    0.1779876604,    0.2107621360,    0.2850215376,    0.2909670811,    0.2221290816,    0.1461079552,    0.1732849096,    0.2105888367,    0.1477329877,    0.1707909687,
    0.2218637793,    0.2522951938,    0.2830664089,    0.2685561266,    0.3224698502,    0.1689967732,    0.3228957469,    0.1093470754,    0.1584377083,    0.1620530121,
    0.2262682184,    0.2531898287,    0.1785529912,    0.2077496091,    0.3631015241,    0.1753074261,    0.2741934934,    0.1680505686,    0.2591385085,    0.3403108627,
    0.3704467297,    0.4893777366,    0.5951172537,    0.8283051848,    0.3384022736,    0.4051428429,    0.5978662499,    0.6770579027,    0.4312158828,    0.3682959589,
    0.4251595528,    0.4553251659,    0.3963237219,    0.2668386875,    0.3662313517,    0.4840108439,    0.6831746357,    0.2208139555,    0.3351566498,    0.4346165711,
    0.5662206518,    0.2173542796,    0.3308020317,    0.2107772548,    0.2807071428,    0.2710280325,    0.3060102911,    0.3488595509,    0.8750111001,    0.2774715803,
    0.3705415466,    0.9794955911,    0.2582800234,    0.3182892650,    0.4859773053,    0.2847554247,    0.2877188381,    0.3538938799,    0.4232597761,    0.0720842034,
    0.0943411125,    0.4293148356,    0.1166628574,    1.8420619678,    4.7770826030,    2.4425233637,    0.2546326871,    0.5404664011,    39.8061784202,    0.4648873369,
    0.5854141980,    0.0675451872,    0.5848109838,    22.9386594185,    0.8437121277,    1.0499508161,    21.8177979786,    0.4296786182,    0.0683731358,    0.5835629152,
    22.9438973437,    20.0088155840,    30.7606673354,    40.0418972816,    1.8084891019,    20.0043806556,    0.2545612503,    0.5839205818,    0.0683644428,    0.8474828193,
    30.6895140266,    2.2754346366,    0.1352512531,    0.8041618203,    2.2302399999,    0.2851207933,    0.1260043107,    0.3449379703,    0.8257658206,    0.3790909354,
    0.8489563657,    0.0468061985,    0.0664308581,    0.0378396122,    0.0286398054,    0.7361171984,    0.1005369433,    0.0512892556,    0.0322069154,    1.0426460409,
    0.1132287246,    0.1408938455,    0.6643131097,    1.0000000000,    0.1758369054,    0.0378844933,    1.0000000000,    0.1838208847,    0.1053816425,    0.1048963886,
    1.0000000000,    0.2055430708,    0.1159895999,    0.0189422467,    0.0189422467,    0.4325726109,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.0731783782,    2.1205290006,    3.3952636085,    4.5944909180,
    0.7304460429,    1.0235285809,    0.5026041850,    0.8579258413,    0.5432877881,    0.4920653655,    0.2608499597,    5.3689289401,    2.4450632281,    0.8267470418,
    0.4391815497,    0.9286348499,    4.1067985982,    0.4225407037,    0.8139420456,    0.3257938362,    0.4292224168,    0.5713385042,    1.9493729161,    0.0550795695,
    0.1640962563,    0.1142554429,    0.0601433167,    6.0312595392,    0.2796816526,    0.0155927005,    3.1014974374,    1.0448670042,    0.0153942395,    0.0159123373,
    0.0995783700,    0.0935912721,    0.0875379983,    0.0956516382,    0.1956497858,    0.5261636679,    0.6978116738,    0.7527281940,    45.0560304568,    0.1101167665,
    0.1150650670,    0.1092745117,    0.1025093826,    0.1038027370,    0.1133428408,    0.6325119770,    6.7913585247,    7.3041712384,    9.7696641029,    6.1471715545,
    5.8799134892,    3.0579831061,    1.8553808650,    2.0615592610,    1.0622645890,    7.7579391634,    0.1303595582,    1.8291185866,    1.8099676928,    0.2865924684,
    0.2257241536,    0.0297597732,    0.0253499403,    0.0112546793,    0.0088208120,    0.0039656884,    2.0890199649,    0.8172928856,    1.7395822849,    0.2307316009,
    0.2356793887,    1.0562620484,    2.1222864050,    0.2135385218,    0.3648941220,    0.3673864360,    0.1134869251,    0.0896368383,    0.7253424462,    1.1281170675,
    0.3429354969,    1.3831340989,    0.7426949411,    1.6784058599,    1.1257150427,    0.7326861023,    0.2880871975,    1.3048599534,    0.9297403587,    0.3749740209,
    0.3119323422,    0.1790420886,    0.4964467732,    0.0599464150,    5.4356858092,    0.6814570849,    0.8422129896,    0.4647600569,    0.4487494327,    0.4216495448,
    0.3037856729,    0.3512448758,    0.6152246237,    0.3094669312,    0.2712566340,    0.1703020511,    0.8520974304,    0.4487922711,    0.8187370805,    0.2664675411,
    0.3493851342,    0.3528508902,    1.8315206035,    0.2484721171,    1.5643853309,    1.2523499402,    0.1515725015,    0.3662139639,    724.3689224147,    0.7441055736,
    0.3537230290,    0.5138147577,    0.4580534894,    41.9946551446,    1.8533627466,    0.3628768842,    0.2290870667,    0.2012997228,    0.0563983858,    0.3013985913,
    0.1903719921,    0.1081659361,    1.1783052983,    3.3055575389,    2.8065266302,    2.5079726320,    86.6631435189,    16.9024293622,    1.7843290786,    1.5191378291,
    1.6129454472,    234.4972328032,    2407.7628250625,    54.3680231822,    47.8847991843,    1.7826095810,    0.9016772246,    0.5449649903,    0.4580534894,    0.3628768842,
    1.8533627466,    0.2290870667,    0.3013985913,    0.1903719921,    0.2012997228,    0.0563983858,    41.9946551446,    1.3915249696,    0.5668649161,    21.7870263026,
    0.2838838973,    0.5394718512,    0.1320409521,    0.6290314659,    0.1670394728,    11399.6869921400,    0.6646141897,    5.3443475097,    0.4961925212,    0.5670087533,
    0.2590994134,    0.4703650077,    0.6627734303,    125.3746763050,    3.0852237997,    0.2865805662,    0.4659009968,    0.1577797335,    0.5037697814,    0.5553286367,
    64.7274919090,    2.0170151202,    2.6624252989,    1.1069618054,    2.2199045093,    2.7475332796,    489.7041236077,    0.2828465771,    0.1404663816,    0.2451599823,
    0.3326468657,    45.0954780293,    0.1876625812,    0.4042037193,    0.4704551295,    53.6617677736,    0.2055626381,    0.2815652441,    23.1853225422,    0.3346660949,
    45.9407012176,    61.3887766944,    2.0802722474,    0.1997576928,    0.2022105807,    0.3214365377,    0.1628959660,    0.0598037777,    0.2373804084,    0.1144740689,
    0.1947413987,    0.8862850505,    1.2876253952,    1.2876253952,    0.1129370619,    0.2326624195,    0.1690165209,    0.1246748778,    0.1174844860,    0.2630938382,
    1.1454700373,    15.7291821114,    53.7166663820,    0.0285706462,    59.8529457825,    14.4509203094,    10.4986637861,    0.2470680022,    0.3283668059,    0.2543518342,
    0.4784885658
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 502;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    4,    12,    15,    16,    24,    26,    27,    34,    35,    66,    67,    75,    76,    78,    80,    86,    87,    89,    93,    111,
    140,    158,    174,    183,    211,    215,    218,    291,    294,    295,    296,    297,    299,    304,    305,    306,    307,    309,    312,    313,
    314,    315,    318,    319,    329,    332,    334,    335,    336,    342,    346,    348,    349,    350,    351,    357,    363,    368,    370,    378,
    379,    380,    382,    387,    390,    391,    392,    393,    394,    409,    416,    418,    419,    421,    422,    445,    462,    496,    506,    513,
    516,    546,    550,    560,    561,    562,    565,    575,    586,    595,    600,    603,    604,    624,    625,    637,    639,    642,    643,    645,
    646,    647,    649,    650,    660,    661,    662,    665,    668,    673,    675,    680,    682,    683,    689,    690,    691,    694,    697,    701,
    709,    715,    719,    725,    727,    728,    729,    733,    734,    736,    739,    740,    741,    742,    743,    744,    745,    746,    747,    748,
    749,    751,    752,    753,    754,    755,    756,    757,    760,    761,    764,    765,    768,    769,    771,    772,    773,    775,    777,    779,
    780,    781,    783,    785,    787,    789,    796,    799,    800,    802,    803,    804,    805,    809,    810,    811,    812,    814,    818,    827,
    831,    833,    834,    835,    836,    837,    841,    842,    843,    845,    847,    848,    850,    851,    853,    856,    857,    859,    862,    864,
    870,    871,    873,    877,    880,    881,    883,    884,    886,    887,    888,    893,    903,    908,    909,    911,    912,    917,    920,    925,
    934,    939,    945,    948,    949,    957,    958,    959,    960,    962,    967,    968,    970,    972,    973,    975,    976,    978,    981,    984,
    985,    986,    988,    993,    994,    998,    1002,    1013,    1014,    1015,    1017,    1018,    1023,    1024,    1027,    1039,    1042,    1045,    1053,    1055,
    1056,    1057,    1058,    1059,    1063,    1064,    1066,    1068,    1070,    1071,    1073,    1075,    1077,    1078,    1079,    1080,    1081,    1086,    1088,    1089,
    1092,    1094,    1096,    1102,    1104,    1109,    1110,    1119,    1124,    1126,    1127,    1131,    1134,    1136,    1138,    1143,    1144,    1145,    1146,    1149,
    1150,    1152,    1154,    1155,    1157,    1161,    1167,    1173,    1174,    1180,    1181,    1182,    1183,    1184,    1185,    1186,    1201,    1206,    1221,    1222,
    1223,    1227,    1228,    1229,    1230,    1231,    1232,    1233,    1234,    1237,    1241,    1256,    1288,    1292,    1293,    1299,    1303,    1313,    1315,    1317,
    1331,    1333,    1336,    1339,    1340,    1347,    1353,    1355,    1356,    1411,    1412,    1413,    1417,    1418,    1419,    1420,    1421,    1422,    1423,    1424,
    1425,    1426,    1449,    1450,    1451,    1452,    1453,    1454,    1455,    1456,    1457,    1458,    1460,    1461,    1462,    1463,    1486,    1510,    1535,    1597,
    1607,    1608,    1609,    1612,    1616,    1617,    1619,    1635,    1636,    1648,    1650,    1654,    1696,    1710,    1713,    1714,    1718,    1729,    1795,    1805,
    1806,    1807,    1812,    1817,    1818,    1824,    1825,    1827,    1830,    1832,    1835,    1838,    1839,    1842,    1854,    1856,    1858,    1859,    1863,    1867,
    1868,    1869,    1875,    1876,    1877,    1880,    1886,    1889,    1891,    1894,    1895,    1898,    1957,    1958,    1964,    1979,    1982,    2003,    2006,    2073,
    2149,    2166,    2167,    2169,    2170,    2172,    2197,    2209,    2232,    2239,    2247,    2251,    2255,    2267,    2268,    2269,    2271,    2273,    2274,    2306,
    2307,    2308,    2311,    2312,    2343,    2346,    2354,    2359,    2372,    2378,    2440,    2471,    2480,    2544,    2669,    2711,    3036,    3041,    3074,    3076,
    3103,    3104,    3107,    3108,    3144,    3203,    3401,    3441,    3504,    3767,    3768,    3769,    3770,    3780,    3781,    3785,    3797,    3800,    3822,    3835,
    3845,    3848
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 26;
constexpr int N_PHYSICS_FEATURES = 83;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
    "dD",
    "dH",
    "dP",
    "HansenTotal",
    "BP",
    "deltaHvap",
    "logVP",
    "logPow",
    "logWS",
    "deltaHf",
    "deltaHc",
    "MP",
    "Flashpoint",
    "logHenrycc",
    "DipoleMoment",
    "logViscosity",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "is_lactone",
    "is_thiol",
    "is_aldehyde",
    "is_carboxylic_acid",
    "is_unsaturated_ester",
    "is_sulfide",
    "is_disulfide",
    "is_amine",
    "num_rings",
    "num_fused_rings",
    "fusion_atoms",
    "cis_fusion",
    "trans_fusion",
    "mixed_fusion",
    "all_R",
    "all_S",
    "stereo_ratio",
    "num_chiral_centers",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/logodt_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/logodt_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadelogODT
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadelogODT {
struct Model {
    using Namespace = CascadelogODT;
};
} // namespace CascadelogODT
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
