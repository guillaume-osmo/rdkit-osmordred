#pragma once
// Auto-generated Treelite model for logPow (v3.4 XGBoost)
// Trees: 300, Features: 593
// Target normalization: mean=2.0905167343, scale=1.8592933358
// Library: logpow_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadelogPow {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 593;
constexpr double TARGET_MEAN = 2.0905167343;
constexpr double TARGET_SCALE = 1.8592933358;

// Normalization stats
constexpr int N_NORM_FEATURES = 593;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0331669866,    0.0029942418,    0.0127447217,    0.3252207294,    0.1028023033,    0.1914779271,    0.0719385797,    0.0410748560,    0.0889059501,    0.0625719770,
    0.0139731286,    0.1847216891,    0.0012284069,    0.0461420345,    1.4090595010,    2.1470249520,    0.1273704415,    0.0794625720,    0.4142034549,    0.5114779271,
    0.3590786948,    0.0274856046,    0.1831861804,    0.0012284069,    3.9950863724,    3.0490595010,    0.0129750480,    0.1698272553,    0.4810748560,    0.0271785029,
    0.1473320537,    4.0936660269,    0.7719769674,    0.2922072937,    2.2630326296,    0.2439155470,    10.0317544702,    0.2877209160,    -0.6939188733,    0.5951719789,
    14.8379313603,    256.8956962329,    256.4946134385,    0.2461593962,    -0.3902469904,    0.3963872630,    0.2410230290,    1.2092784149,    1.8467666917,    2.3807554168,
    10.1548336283,    -2.1130001176,    -2.1733660845,    6.4301872746,    0.1737356823,    2.5055967577,    484.7031797444,    10.4698201910,    6.0566275173,    4.6703567102,
    1.8296529185,    2.1902771967,    12.6985846443,    5.4607292603,    6.2393464501,    5.2922047399,    1.6641978108,    20.7401051142,    12.3254125679,    9.2363949066,
    0.2522512294,    5.5948345321,    3.0191595426,    33.2296116148,    5.5846994939,    7.2990730554,    4.8124901053,    18.3853761824,    59.3538679463,    8.8991007837,
    9.6411464197,    12.1020293715,    1.8416123109,    -0.0334999350,    0.3150945987,    0.3581737923,    0.4133589251,    0.7169289827,    4.1025587806,    2.1427131271,
    67.1584836929,    0.0684069098,    0.0221113244,    0.5210748560,    0.4651055662,    0.0169673704,    0.0155854127,    0.0030710173,    0.0548176583,    0.0848368522,
    0.1992322457,    2.3433456724,    4.6468292546,    3956.6950376486,    5.0932133697,    200.5634983529,    894.4307869482,    3458.2297760428,    4.3931715557,    3.6373883989,
    2.7341991540,    3.7409288902,    3.3822304966,    2.8569152151,    2.4627936274,    2.2543781155,    2.0460924086,    5.5502697139,    3.3368003539,    3.4762601871,
    3.4284449490,    2.9828527263,    2.5785887415,    76.0426817389,    58.2189339873,    222.9959849377,    193.0876087643,    123.4284008300,    103.6977727580,    7.8897809003,
    7.7263989716,    7.4676995238,    6.2748131518,    6.4617169307,    6.4100313429,    6.4466629732,    6.1170451354,    4.8831723087,    1.5901702485,    1.0996313594,
    163.8406887286,    147.9059206558,    155.5550793218,    159.0869031850,    162.2543648222,    150.7912561895,    138.2215381472,    -0.3723198389,    0.0548816539,    -0.0213630270,
    -0.0216844254,    -0.0153941343,    33.3561561910,    18.9930243019,    -16.1753622922,    -24.7601656299,    -24.1241349390,    -20.5386165196,    -1.3872036807,    -4.6991025366,
    -2.8201293487,    -0.6560438556,    62.1390776349,    -6.1245255215,    -3.7941887359,    -7.7272324471,    -2.4265879512,    29.6620675118,    -44.4483173484,    -38.6670445454,
    -23.9270960661,    -178.2457591513,    74.3075356101,    -246.7554070992,    -68.7941700547,    -0.1021306703,    -0.1189746197,    -0.0816380744,    -0.6444163220,    -0.5985626374,
    -0.1440638492,    -0.3710757250,    -0.3877382902,    -0.2118914938,    0.3698943720,    -0.7619076441,    -0.5016628271,    -0.6092085329,    -0.3565941881,    -4.7987824816,
    2.4426793128,    -6.8477305066,    -3.3991753615,    -1.5664178247,    -2.4318457722,    0.0011880707,    -0.0002992635,    -0.0001547181,    0.0005316845,    0.9611840997,
    -0.3337123747,    -0.4398156496,    -0.4611809011,    -0.1910765737,    -0.0375246998,    -0.0685979281,    -0.0344586240,    2.0360945999,    -0.2091776097,    0.3012279060,
    -0.0841731758,    -0.1535289218,    -0.1460003327,    1.8393851154,    -4.8750712248,    -5.2283082025,    -3.9897315980,    0.7250715658,    -2.0716251964,    0.1540746174,
    0.0952935277,    -0.0088066135,    -0.0057990111,    -0.0032647332,    -0.0030615145,    -0.0076497129,    -0.0042469861,    0.2725368453,    -0.0059845444,    -0.0245322818,
    -0.1436061287,    0.0249568464,    -0.0415770916,    0.0548531885,    -0.4922898773,    0.0365616566,    -0.0187079669,    -0.0074510141,    0.0183253534,    -0.0047869915,
    0.0579592592,    -0.0867762608,    -0.1069033596,    -0.0799859623,    -0.0434038690,    -0.0593679986,    -0.0584249739,    0.0481196634,    -0.0774810367,    0.0005517063,
    0.0480340993,    -0.0709144392,    -0.0517956009,    -0.0237157313,    0.1011706956,    -0.0531011714,    -0.0258064722,    0.1056417466,    -0.0796294657,    -0.0499631260,
    -0.0294611042,    -0.0191021868,    -0.0892460379,    -0.0207968736,    1.4908967892,    0.9772414066,    1.0562799429,    1.0169905116,    0.8983701146,    1.0611708725,
    1.0395593604,    0.7974959963,    0.9307789409,    0.8425325715,    0.7121176355,    0.5912826353,    0.7827331112,    0.9435559978,    1.1109601076,    1.1157800626,
    0.7681874642,    1.0179308825,    1.0615148740,    1.0598163497,    0.8217971887,    1.0171571197,    0.9588845896,    0.8936568236,    0.7668278116,    1.1413416678,
    0.9825452598,    0.9710204829,    0.9272612473,    0.7586800855,    1.2888629039,    1.0978053400,    1.0087930436,    0.7732301717,    0.4306822589,    -0.4191915190,
    3.3630857801,    1.1467289613,    3.5240580671,    2.2058670379,    2.2864068737,    14.5125272885,    10.8468995884,    0.2530247579,    4.7219552463,    121.9231629228,
    61.4444905248,    91.5320466865,    122.7881555525,    6.0634786046,    61.4451344308,    1.0011100093,    4.0108490286,    0.2534182078,    1.8265845539,    121.2668694969,
    61.1385775936,    91.0702899880,    122.1720314199,    6.0342589426,    61.1392313231,    1.0499103119,    4.0108824555,    8.8724760077,    0.2839721407,    0.1846550537,
    1.1457965451,    5.1900959693,    0.0894433781,    0.3194563048,    0.3569412697,    0.1385477366,    2.7960937075,    2.2452627014,    12.7491402632,    0.3105767977,
    0.1995883235,    0.1287559213,    0.6093280023,    0.3406653936,    0.1953101494,    0.0343973109,    0.0200784068,    0.7029556928,    1.1310628982,    1573.3867946257,
    0.3501727447,    0.2331669866,    0.0000000000,    0.2019193858,    0.0000000000,    0.0066026871,    0.4301727447,    0.0842994242,    0.0411516315,    0.0000000000,
    0.1157773512,    0.4142034549,    0.2666410749,    0.0958925144,    1.1484836852,    0.1714395393,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0003838772,    0.0229558541,    0.0000000000,    0.0333973129,    0.1147024952,    1.4470284446,    1.1245408358,    1.1498559501,
    0.4661932949,    13.2355233980,    0.1868370104,    0.2851029670,    0.1089987307,    0.1965590759,    4.1270253898,    1.2041523523,    0.4087706415,    0.2009549473,
    0.8848667963,    0.0854280355,    1.0624292967,    0.0830594984,    0.8635905957,    7.4374932608,    2.0100721259,    0.6123242627,    7.5297435431,    3.0189669695,
    0.2323044678,    0.2798019226,    0.6132409748,    14.1776620189,    0.7410087634,    4.2605530638,    0.3542789243,    0.0418637557,    -1.1883109405,    0.3242760362,
    -3.0450174447,    2.7702306221,    4.0735144592,    0.7600779936,    0.8399447934,    0.8598403030,    0.3174774950,    0.7210395980,    0.7966767500,    0.8176635706,
    17.9036635309,    36.9948430906,    30.5600637286,    4.1172787527,    0.4879774241,    0.3499599259,    0.3157105970,    0.1073729104,    0.2803412429,    1.9731834506,
    25.0031542937,    3.6102893774,    0.2145007491,    4.3439845882,    4.7017248079,    4.6842205750,    4.2847685560,    3.9428962040,    0.0825335893,    0.2108253359,
    0.0581957774,    0.1843040770,    64.3288214971,    0.0860281360,    0.0443367314,    0.0046476834,    0.4730378813,    1.6241342094,    3.9295718703,    0.0034954475,
    0.2545178680,    0.5669043724,    4.9479632415,    0.2184905387,    0.1033420537,    0.6789976614,    0.1960540855,    0.3753784712,    0.4133385647,    0.4803680923,
    0.9196738729,    0.2123563047,    0.0841230495,    3.7005250248,    0.7735394562,    0.1486877005,    0.0251459625,    0.4271884659,    0.9004561296,    0.0401968834,
    0.0022180346,    0.0585099497,    0.0359941506,    17.8244987959,    0.5893282150,    0.2216506718,    4.8777735125,    0.0191524722,    0.4622774046,    0.0038333398,
    0.2214729953,    0.0525976661,    0.0047845545,    1.8534340911,    0.3259275754,    0.3527632326,    0.1310963271,    0.4692773690,    0.2234204439,    0.3049742035,
    1.1166201919,    1.1077933205,    1.8155677543,    1.4440386180,    6.1053457141,    0.2374248244,    6.2082421824,    5.5021682855,    1.3430380464,    3.9144923052,
    0.1768138196,    0.1396545106,    1.8659194148,    177.2981424029,    9.1585442962,    1.5071841013,    1.1359225011,    1.2298478579,    1.4725527521,    1.3280415613,
    0.3615566207,    0.4744517988,    16.9004119071,    9.3127239190,    10.2911076892,    22.6039029542,    172.1895951034,    67.1866370445,    0.6041051860,    1.8659194148,
    1.5071841013,    9.1585442962,    1.1359225011,    1.3280415613,    0.3615566207,    1.2298478579,    1.4725527521,    177.2981424029,    4.1225643651,    2.8167918357,
    100.4201654027,    1.8419198376,    1.9851898059,    0.2717138355,    1.5593931310,    2.1721430662,    37073.5181398551,    3.2173906414,    20.2170398441,    2.6039470093,
    2.6891269490,    0.7693397141,    2.2979020316,    2.7438835227,    390.3251732843,    16.2943565670,    2.0462874243,    2.2265786222,    0.6380933885,    1.9180560433,
    2.2272181823,    308.8235469825,    12.9543391241,    13.4283546941,    3.9200325700,    11.3879310078,    13.4842090999,    1919.6320682712,    1.7006473582,    0.5535422063,
    1.3919625237,    1.6663315084,    245.0074804967,    0.5345516508,    1.6626245317,    1.9649711533,    255.7585214769,    0.4548796912,    0.5328619121,    72.3312936365,
    1.8147418571,    219.3357013313,    260.9250104990,    5.3831379630,    67.1584836929,    209.6322963531,    0.2796119907,    242.5565205099,    58.3044134249,    44.3245356007,
    1.2237541428,    1.6374057519,    1.2683290416,    2.4063590289,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.2520810676,    0.0546376826,    0.1257253431,    0.7833372669,    0.3830725079,    0.6022640617,    0.2625131092,    0.2119328746,    0.3114016249,    0.2913999354,
    0.1303934370,    0.6101860650,    0.0350271027,    0.2297070883,    1.5354675925,    2.7949426114,    0.4486441453,    0.2875211735,    0.8064220335,    0.8821772947,
    1.0662359195,    0.1924007641,    0.4742034658,    0.0350271027,    2.9167816188,    2.0099111616,    0.1463063378,    0.5787233359,    1.0999767910,    0.1932406354,
    0.4449132236,    18.2992269378,    0.9827991515,    0.5591231853,    5.2967440128,    0.5276304403,    2.9597442007,    0.3495970758,    1.3621384191,    0.1738357348,
    8.9531351168,    112.5895777042,    112.3986433210,    0.1158902807,    0.1107564846,    0.1088573704,    0.1073304622,    0.2908451173,    0.3678495067,    0.4461195070,
    0.2619302889,    0.1785563177,    0.2520677415,    1.4160735362,    0.5031286714,    0.6082417318,    289.1512117454,    4.6093089898,    2.8906461428,    2.5716370070,
    1.5351563512,    1.7189062934,    5.9214664480,    2.9390312096,    7.5539335430,    5.9430317627,    6.2560514066,    19.0842847541,    10.7243253419,    9.5831182490,
    1.2683362208,    6.3962786959,    6.2345339488,    20.7827645183,    5.7927837912,    8.3229297533,    7.4821724398,    18.9564676015,    39.0891713526,    14.3172665147,
    10.1510450788,    14.0116551771,    2.9720715094,    1.6815515969,    1.7763834443,    0.2800203836,    0.6192358331,    0.8629422134,    2.5100996281,    1.6750744274,
    28.5689033853,    0.2634554734,    0.1581155676,    0.8007896751,    1.0601991802,    0.1479871891,    0.1250983985,    0.0567021780,    0.2658936609,    0.2954881810,
    1.0042517033,    0.1692765035,    0.3232904069,    199227.6638056875,    1.6803637983,    208.6793778645,    417.5955410678,    3667.6715175680,    2.3820986591,    2.3292635469,
    2.7655424592,    0.6594664936,    0.6309103206,    0.5776055233,    0.5595211408,    0.6369989416,    0.7196757778,    3.1753962734,    0.8225245297,    1.8185436043,
    2.0985280596,    2.8212563166,    3.0060369780,    139.9799467695,    66.3950288822,    43.6551588241,    44.0891108574,    64.7548787903,    69.3972258683,    0.4416715621,
    1.1667800012,    1.7356867328,    3.0531466535,    0.5825866082,    0.5697491892,    0.3451440222,    1.0043873956,    2.4214565444,    0.3295061689,    0.4358304871,
    6.7829760533,    5.7184409368,    8.0894858066,    9.8934766028,    23.0299267568,    51.4874480982,    66.2670516507,    0.2857423317,    0.2398348875,    0.3159165412,
    0.2589354891,    0.2239734320,    27.5379989221,    34.1376286247,    38.7827225403,    45.0875870812,    49.9831632201,    48.6877473272,    4.2949774341,    6.7066556146,
    6.3593393994,    5.3132501347,    47.1337692765,    7.5060135945,    17.9359512257,    25.4756591011,    22.4814874105,    95.0526065051,    135.1781070769,    206.5654043528,
    207.8574659913,    1602.8666651722,    390.9343134182,    440.2550425713,    510.1416562705,    0.3929284261,    0.9772144764,    0.4925730098,    1.7637905235,    1.7244446164,
    0.5962085222,    1.4319810987,    1.8864019964,    1.0449578368,    2.2237693119,    3.3267101442,    3.1436846543,    3.0204473031,    3.0128462351,    9.4738562904,
    16.6218970472,    16.5156063882,    15.1411590279,    15.6542440124,    14.1466463584,    0.0051670348,    0.0047464324,    0.0052358969,    0.0081027849,    0.6453971496,
    0.6958911830,    0.8303058073,    1.1434435279,    1.8275389421,    0.0794673636,    0.0926977481,    0.1209729126,    1.5178076134,    0.2933773576,    0.5598065728,
    0.4587004309,    0.5972420442,    1.3431197798,    8.8583261463,    56.3220802007,    51.4862983165,    49.3377269519,    7.1239196475,    10.9080117822,    17.9097392518,
    0.0493723709,    0.0321445786,    0.0482474398,    0.0479201127,    0.0194073849,    0.0278235766,    0.0720260339,    0.1442623516,    0.0346817689,    0.0519509703,
    0.3205159200,    0.3436720072,    0.3372684663,    0.4845429527,    0.2149885977,    0.2017285813,    0.1692438030,    0.1747528610,    0.2541229719,    0.2769893295,
    0.1554141968,    0.1581168400,    0.1842905022,    0.3389947469,    0.1365170184,    0.1737616929,    0.3147449043,    0.1264151904,    0.1843000395,    0.4517960512,
    0.1266447220,    0.1464767215,    0.3811824835,    0.3717778538,    0.1668199691,    0.4156310976,    0.1321167210,    0.1770392924,    0.1942748092,    0.3891362803,
    0.1236119558,    0.2922481947,    0.1585087781,    0.1809018214,    0.2848211138,    0.3028031973,    0.2768233593,    0.3603797297,    0.2459117347,    0.2150455301,
    0.5119144050,    0.6615836268,    0.2470707551,    0.4173173310,    0.4559405920,    0.4820288445,    0.2624495823,    0.2630078326,    0.3851305174,    0.7275391051,
    0.1983538719,    0.2017675295,    0.2580978757,    0.3897688887,    0.1865581577,    0.1986212681,    0.3903330876,    0.4703263628,    0.2918136588,    0.4622798892,
    0.2160154886,    0.3432001071,    0.4642917608,    0.6475093365,    0.3126714181,    0.2078689730,    0.2170951557,    0.4296677285,    0.0682504349,    0.0825025164,
    0.4134939149,    0.3626189856,    0.2566255382,    0.0603309723,    0.5888477545,    1.0634444361,    0.2702285878,    0.0589685227,    1.1287362442,    119.3381153184,
    59.8543383491,    89.3872703218,    119.7294382111,    2.5196485064,    59.8537037878,    0.6039838210,    0.8589996509,    0.0590508378,    0.6515262133,    118.5825835896,
    59.4872916392,    88.8299046942,    118.9957692974,    2.5059739342,    59.4866469178,    0.6403113868,    0.8589954822,    4.9488995861,    0.1255737614,    0.0801829699,
    1.1937177964,    3.6905369716,    0.3695511065,    0.3669525934,    0.4363228982,    0.2638279657,    2.0439630833,    3.8400663929,    5.4988379084,    0.0399317618,
    0.0380353378,    0.0317814843,    0.0796938221,    0.0757180046,    0.0804279604,    0.0298110061,    0.0223435790,    0.2321690771,    0.0222477605,    3070.5750120072,
    0.9563952680,    0.6642428540,    1.0000000000,    0.4720968064,    1.0000000000,    0.0941400798,    0.7170392372,    0.3067305434,    0.2213104793,    1.0000000000,
    0.3731288832,    0.8064220335,    0.5627568245,    0.3369993193,    1.1348546223,    0.7408132435,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    0.0195890224,    0.1517994939,    1.0000000000,    0.1847282943,    0.3983299563,    2.6148326458,    1.4718000817,    1.9261607473,
    1.0418511471,    13.5369248512,    1.0323436961,    1.3008368327,    0.4672501216,    0.6229519646,    8.4735231267,    0.9055158776,    0.4982049323,    0.5462374908,
    1.2937358269,    0.3487828522,    3.4128028013,    0.5397503143,    1.2649573247,    5.3360860333,    2.5191765201,    1.1008879841,    5.3019317227,    5.1148901795,
    0.1300246737,    0.0992680889,    0.0543830779,    12.2998838428,    0.2623791877,    2.4860916524,    0.3746182636,    0.0450532053,    4.7796377752,    0.1602700256,
    1.7374510869,    0.4986715451,    0.6977631443,    0.1039813475,    0.0987247650,    0.0988060611,    0.0720154859,    0.0941524036,    0.0870456488,    0.0931006796,
    7.1271949544,    9.6828086676,    11.5023661134,    2.4651082336,    1.6625359297,    0.6065580207,    0.7275811414,    0.3414366028,    0.6259409120,    0.0700797964,
    12.6074788793,    3.2446087243,    0.1903871311,    3.8289520962,    1.5083150455,    1.8288122444,    2.5787528110,    2.8392041044,    0.2790546685,    0.4225027004,
    0.2367222756,    0.1406323029,    41.7601406692,    0.0262046997,    0.0186700359,    0.0057097277,    0.1179679014,    2.2973329875,    1.6608399468,    0.0674186745,
    0.5949860714,    0.6840382510,    3.5464602922,    0.4777774905,    0.2698866543,    0.3497042272,    0.1729628116,    0.7417804568,    0.8899783943,    1.5637880994,
    2.0566933294,    0.5067622872,    0.3917720479,    3.2675391555,    2.0307017923,    0.5744724950,    0.4893476892,    0.8348348510,    2.2509360163,    0.2848316596,
    0.0403311715,    0.3187098259,    0.3836662628,    13.4919500249,    1.4458974094,    0.5342111346,    3.5849056068,    0.1838116868,    1.0740104969,    0.1285045964,
    0.7599306164,    0.2601326915,    0.1164958267,    1.8385827115,    0.6432039326,    1.0249427290,    0.2924721182,    1.0903665849,    0.7664512167,    0.3855838481,
    0.8230995120,    0.8255989899,    0.9023865624,    0.7316342023,    1.6312339567,    0.0623440100,    1.1564315165,    0.5627793100,    0.3212827351,    0.3688176439,
    0.5547074949,    0.4277305595,    0.8005679874,    75.0925218669,    4.0670913165,    0.7383684179,    0.7426977239,    0.2164887470,    0.0610856648,    0.4706329966,
    0.3754872109,    0.1106074635,    1.3303229395,    3.7235756701,    3.6778568587,    3.0439145637,    116.5239086389,    21.5394271502,    2.0983681403,    0.8005679874,
    0.7383684179,    4.0670913165,    0.7426977239,    0.4706329966,    0.3754872109,    0.2164887470,    0.0610856648,    75.0925218669,    4.3329273734,    2.7764756002,
    106.3905932950,    3.0860219116,    1.8506160379,    0.6574386411,    0.6083013195,    0.1863097200,    36990.3492551349,    3.0465094673,    21.2225595424,    3.5547448453,
    2.1705248421,    1.2317124983,    1.0265863444,    1.1652475246,    398.0133053224,    15.8524379259,    2.5109235512,    1.7069478982,    0.9531829420,    1.0820341313,
    1.0996411731,    288.4275760528,    17.6386122503,    11.0375087187,    6.2385183437,    5.4283084541,    5.9521517886,    1958.5412259816,    1.7793676268,    1.0623270782,
    0.9274042153,    1.0822416553,    328.1334521291,    0.6849791564,    0.6893253259,    0.7325105975,    194.6797757501,    0.4912081135,    0.5553902301,    114.8710550088,
    0.3524473068,    99.4958045907,    109.7411076462,    2.8849795113,    28.5689033853,    90.9190659674,    0.0299335785,    107.3606765755,    24.7934224538,    18.7731304667,
    0.2529274052,    0.3221496489,    0.2495360450,    0.4762220978,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 502;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    0,    7,    13,    15,    16,    17,    18,    19,    27,    34,    39,    41,    53,    62,    66,    67,    72,    73,    75,    83,
    97,    100,    101,    104,    111,    122,    125,    128,    133,    135,    141,    158,    179,    181,    215,    227,    291,    293,    294,    295,
    296,    297,    299,    302,    303,    304,    305,    306,    307,    308,    310,    312,    314,    315,    316,    318,    319,    322,    325,    327,
    330,    331,    334,    335,    339,    344,    347,    348,    350,    351,    354,    355,    356,    359,    362,    367,    368,    369,    374,    375,
    378,    384,    390,    391,    395,    396,    405,    412,    419,    421,    422,    423,    427,    439,    459,    466,    469,    473,    482,    496,
    506,    513,    514,    521,    523,    567,    571,    585,    645,    646,    648,    652,    653,    654,    655,    656,    657,    660,    661,    664,
    665,    667,    668,    682,    684,    689,    690,    694,    695,    698,    701,    702,    704,    705,    708,    715,    719,    722,    725,    729,
    732,    733,    734,    735,    737,    739,    740,    742,    743,    745,    746,    748,    751,    752,    753,    754,    755,    756,    761,    763,
    764,    767,    768,    769,    771,    772,    776,    779,    780,    783,    785,    790,    797,    798,    803,    805,    812,    814,    817,    818,
    823,    825,    828,    832,    833,    836,    837,    838,    839,    841,    842,    844,    845,    846,    847,    851,    852,    853,    855,    859,
    861,    862,    863,    865,    869,    871,    872,    876,    877,    878,    879,    880,    883,    895,    899,    900,    901,    905,    908,    910,
    912,    917,    919,    920,    922,    924,    929,    939,    940,    942,    949,    950,    953,    956,    957,    958,    959,    960,    962,    963,
    966,    967,    968,    970,    983,    984,    986,    990,    992,    996,    998,    999,    1019,    1020,    1022,    1027,    1029,    1030,    1032,    1035,
    1037,    1042,    1047,    1049,    1053,    1054,    1055,    1057,    1062,    1063,    1066,    1068,    1069,    1074,    1075,    1076,    1077,    1079,    1080,    1082,
    1085,    1087,    1088,    1089,    1094,    1095,    1106,    1107,    1110,    1129,    1134,    1137,    1138,    1140,    1141,    1143,    1144,    1147,    1149,    1150,
    1153,    1156,    1167,    1168,    1169,    1171,    1172,    1208,    1212,    1213,    1214,    1215,    1216,    1217,    1218,    1219,    1220,    1221,    1222,    1226,
    1227,    1228,    1229,    1230,    1231,    1232,    1233,    1285,    1288,    1289,    1292,    1293,    1298,    1305,    1313,    1317,    1319,    1324,    1325,    1335,
    1336,    1337,    1349,    1350,    1351,    1354,    1355,    1366,    1372,    1386,    1416,    1417,    1418,    1419,    1420,    1421,    1422,    1423,    1424,    1425,
    1426,    1427,    1428,    1429,    1433,    1436,    1437,    1438,    1439,    1440,    1441,    1442,    1443,    1444,    1445,    1478,    1494,    1508,    1516,    1523,
    1529,    1534,    1579,    1581,    1586,    1587,    1598,    1607,    1609,    1611,    1624,    1650,    1696,    1709,    1725,    1736,    1737,    1786,    1796,    1800,
    1806,    1807,    1812,    1817,    1818,    1819,    1829,    1843,    1844,    1850,    1853,    1855,    1857,    1868,    1869,    1870,    1872,    1874,    1875,    1877,
    1884,    1887,    1892,    1898,    1962,    1966,    1967,    1970,    1972,    1976,    1979,    1981,    1982,    1983,    2002,    2003,    2005,    2006,    2089,    2093,
    2100,    2149,    2153,    2165,    2167,    2172,    2174,    2197,    2209,    2239,    2240,    2252,    2255,    2260,    2268,    2269,    2272,    2298,    2306,    2323,
    2342,    2347,    2377,    2406,    2409,    2410,    2484,    2499,    2512,    2516,    2518,    2527,    2587,    2669,    2709,    2837,    3034,    3049,    3139,    3144,
    3256,    3257,    3331,    3399,    3401,    3418,    3439,    3504,    3621,    3765,    3766,    3767,    3768,    3769,    3774,    3777,    3781,    3803,    3812,    3848,
    4011,    4049
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 17;
constexpr int N_PHYSICS_FEATURES = 74;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
    "dD",
    "dH",
    "dP",
    "HansenTotal",
    "BP",
    "deltaHvap",
    "logVP",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
    "logpow_logws_dp_est",
    "logpow_logws_sq",
    "logpow_dp_sq",
    "logpow_logws_deltahc_est",
    "logpow_logws_sq",
    "logpow_deltahc_sq",
    "logpow_logws_dh_est",
    "logpow_logws_sq",
    "logpow_dh_sq",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/logpow_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/logpow_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadelogPow
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadelogPow {
struct Model {
    using Namespace = CascadelogPow;
};
} // namespace CascadelogPow
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
