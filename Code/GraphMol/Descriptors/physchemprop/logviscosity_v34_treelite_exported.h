#pragma once
// Auto-generated Treelite model for logViscosity (v3.4 XGBoost)
// Trees: 300, Features: 591
// Target normalization: mean=0.3498075456, scale=0.8103501267
// Library: logviscosity_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadelogViscosity {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 591;
constexpr double TARGET_MEAN = 0.3498075456;
constexpr double TARGET_SCALE = 0.8103501267;

// Normalization stats
constexpr int N_NORM_FEATURES = 591;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0025109856,    0.0025109856,    0.2197112367,    0.0025109856,    0.0703075957,    0.0357815443,    0.0188323917,    0.0056497175,    0.0031387320,    0.0659133710,
    1.5982423101,    3.4808537351,    0.0006277464,    0.4387947269,    0.0269930948,    0.2661644696,    0.3942247332,    0.0495919648,    0.2021343377,    0.1720025110,
    0.1067168864,    1.4752040176,    0.0420590082,    0.0156936598,    0.2172002511,    0.1192718142,    0.7043314501,    0.7231638418,    6.7859628339,    0.7873844271,
    0.0402768556,    0.4717620509,    12.6955706612,    154.5670251099,    140.1209234149,    154.3428217105,    59.6409290647,    0.1265203083,    -0.2741373797,    0.2882655229,
    0.1299845412,    1.1358236714,    1.5738522825,    1.8385405641,    20.6014758601,    10.5553003783,    -1.9646746118,    -1.9290668437,    0.4494660224,    6.9868446258,
    4.1700762024,    2.6889862858,    0.9581731682,    -0.4516930402,    4868185785181.5273437500,    5.2596242361,    65.1326576985,    4.0175914432,    0.2836015110,    1.6712470800,
    27.3219308175,    14.1819789628,    4.4141685511,    6.9481593249,    0.1355928897,    0.3104139565,    30.5383266322,    5.0622038893,    11.0183035168,    9.7863637556,
    20.5628939109,    3.5047065394,    4.3137824061,    16.3897999674,    2.9655898272,    4.9676364537,    2.9738798976,    0.7058745559,    -0.2255245460,    2.2676418418,
    3.8323011453,    0.4174513497,    0.0703075957,    2.4258211927,    43.3022649090,    0.0552416824,    0.0401757690,    0.0012554928,    1.1465661080,    444.4782903202,
    10.7225696036,    109.2249019501,    98.6895089281,    63.7453874247,    512.2548650345,    659.8807281858,    2325.7982857797,    1897.1943286742,    2510.1394200031,    2.3094958038,
    1.2272063855,    0.9390068439,    2.3620816825,    2.3776594120,    5.4215870582,    3.7026590993,    1.4767490641,    16.1813712228,    10.5635155969,    111.4030933718,
    239.8548166023,    178.0263039927,    138.3396552856,    7.7493939908,    7.4903738002,    6.9865768274,    6.3576597115,    4.9361709439,    1.1181941227,    0.9045954397,
    167.6976896778,    147.4921077574,    159.2468934646,    157.1878501692,    146.2695059373,    99.3170035262,    0.0065585465,    -0.0023997232,    -0.0192099883,    -0.0065198770,
    0.0188249641,    0.0066181412,    60.1784029973,    12.9124935878,    -1.2887148578,    -14.4165225704,    -7.1055860963,    -2.5401237316,    1.7623833689,    -2.8163221810,
    -1.5542960171,    0.0192761497,    29.8268222928,    -3.3113428220,    -0.0645029850,    1.9908847922,    -24.4610880347,    -19.9079276583,    6.6625308805,    -5.6232011675,
    1112.6916259070,    4.9888071642,    -124.2432920524,    -95.1977674190,    31.9964664380,    -125.6954945965,    53.3325555072,    62.3797449246,    1.4462592899,    -0.1264941148,
    -0.2456197227,    -0.1625493636,    -0.0782669254,    0.2093201636,    -0.4345242482,    -0.2710938212,    0.0995139295,    -0.1381924640,    -0.1656538163,    -0.4753329109,
    -1.1999709161,    -0.2309638089,    0.1128345522,    -3.3291076060,    -1.1781269255,    0.0000282921,    -0.0004681576,    0.0004777451,    0.0004797888,    -0.5080296403,
    -0.1601437320,    -0.0005831149,    -0.0198809070,    0.0117342804,    0.0331577353,    0.0316362967,    0.0234712546,    1.6960009102,    -0.1651336235,    13.3583362619,
    -0.3835484103,    -2.8692915753,    -4.7517460990,    0.0083013835,    3.1894333987,    -0.0055478110,    0.0001379158,    -0.0103997629,    -0.0153623105,    0.0014652092,
    -0.0119528781,    -0.0124380626,    0.2938972198,    -0.0254736713,    -0.0360404079,    1.5540178593,    -0.2305457136,    0.0459570930,    -0.0252516100,    0.0366111915,
    0.0267884994,    -0.0984714183,    -0.0533793693,    0.0716322733,    -0.1758558129,    0.0312454602,    -0.0625448435,    -0.0263666455,    -0.0561936256,    -0.0355562832,
    0.0048597764,    0.0289756456,    -0.0631743997,    -0.1270000952,    -0.0707376646,    -0.1058818046,    0.0133382634,    0.0690061410,    -0.1350078680,    -0.1075765366,
    0.0829231060,    1.4207009069,    1.0206763530,    1.0377160863,    0.5027991497,    0.8867015273,    1.2084877668,    0.9522409762,    1.5468602913,    0.5786447248,
    1.1509662290,    1.0177660876,    1.0969663938,    0.9615137649,    1.2807996201,    1.1270035730,    1.0639423224,    1.0190156411,    0.9642526577,    1.0245868976,
    0.8855646806,    0.6958167491,    1.1591796528,    1.0698880798,    1.4665883349,    1.1661650218,    0.8325578650,    0.5179055400,    4.7795202672,    1.2719626066,
    3.4665456397,    1.0133779510,    10.9337511360,    36.3851588505,    0.4554942265,    54.5936006217,    6.3632657905,    0.3437716037,    0.2259269062,    0.0344062083,
    0.1107687471,    0.0119117938,    1.0505942176,    0.3248210130,    0.7875560874,    0.0292132480,    1.8975111555,    0.8644425793,    0.3034096030,    13.7753450124,
    24.4037883786,    23.2857009219,    23.5950408035,    15.4241998827,    28.0545534883,    0.6671210670,    0.6333409169,    0.5842853235,    1.0079659755,    0.9670311559,
    0.9786051486,    0.6471713297,    1.1437877015,    100.3272126098,    50.1270320197,    72.6477956940,    100.3272126098,    7.2706095319,    50.1293809497,    0.0000000000,
    3.0500979316,    0.3425443971,    0.9634742201,    38.5830254804,    3.1143471557,    3.1478897010,    496.7740112994,    80.7128862610,    40.3551816868,    60.4770445147,
    80.7128862610,    5.6787537604,    40.3578355853,    3.0433272620,    0.3419003206,    0.9613950040,    39.0067039846,    3.1497307666,    3.1578457541,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0018832392,    0.0000000000,    1.5976145637,    0.1067168864,    3.4752040176,    0.0087884495,    0.3013182674,
    1.1738857502,    0.4387947269,    0.0100439422,    0.0401757690,    0.3879472693,    0.4777150031,    0.0539861896,    0.2021343377,    0.0000000000,    0.0564971751,
    0.0000000000,    0.0000000000,    0.0376647834,    0.0006277464,    0.0251098556,    0.0000000000,    0.0069052103,    0.0119271814,    0.0225988701,    0.0370370370,
    0.0006277464,    0.0000000000,    0.2655367232,    0.4193345888,    0.4438166981,    0.0012554928,    0.2837413685,    0.0000000000,    0.0006277464,    0.0031387320,
    0.0489642185,    0.0000000000,    0.0000000000,    0.0031387320,    0.0069052103,    0.0000000000,    0.0150659134,    0.0043942247,    0.0313873195,    0.0119271814,
    0.0012554928,    0.0069052103,    0.1707470182,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0295040804,    3.8647841522,
    -0.1069392143,    0.2928438606,    2.2590158801,    0.0585624594,    0.1022370911,    0.0721503728,    0.0186837379,    1.3201026639,    0.1076607076,    -0.0514286285,
    1.8011829411,    0.5412164954,    1.4445972996,    1.4049027584,    1.7951421495,    0.2625385536,    0.7902810425,    0.5216415516,    0.0772128060,    0.0072465273,
    0.7926163429,    3.5165977573,    4.0334177557,    0.3476074200,    0.1347057039,    0.1812446542,    0.5510635098,    0.0268431899,    -2.3492651595,    1.8288476258,
    2.5783909907,    3.1165965278,    43.4092740575,    85.3411412987,    0.6084147017,    0.6870925622,    0.2997527405,    0.7039310117,    1.3918994837,    28.0843672153,
    0.0000000000,    0.1601033636,    15.9676912437,    1.4707180318,    0.3732756894,    0.0473118859,    2.0979632908,    0.2067439659,    0.8284160788,    0.1099993213,
    11.4394224733,    11.2937853107,    11.3006905210,    10.9843063402,    9.1563088512,    7.9165097301,    7.2033898305,    6.6271186441,    6.3226616447,    102.2730696798,
    2.3600472185,    2.5554919627,    2.4829870993,    2.3572133589,    1.8737143827,    0.0056497175,    0.0087884495,    0.0271109263,    0.0017157817,    0.7877055932,
    7.7767075179,    3.9690853200,    109.7344111739,    45.8992705788,    0.9704959196,    0.5935234486,    1.3824654025,    0.2668927863,    3.3491170691,    0.0576506766,
    0.2026347948,    0.2282039640,    0.1198676516,    0.8977255045,    0.2047870952,    0.4715082442,    0.0397639188,    0.1163900876,    0.0992067615,    0.0140647000,
    0.0974236735,    0.6785308354,    0.0323540800,    0.0790295807,    0.1284904175,    0.0209442462,    0.0065110821,    0.3617762392,    0.1196038920,    0.4199278092,
    0.6508342750,    0.4193414940,    4.7631575643,    7.4523924728,    4.8419736027,    2.9318547764,    4.8143765119,    8.2014880610,    0.6430515149,    0.0156936598,
    0.8154425612,    1.3071399018,    115.1728705270,    4.7831774507,    0.4045075056,    0.4434562071,    0.9972968272,    1.4489213126,    0.6371190677,    0.1338568574,
    0.3449120181,    16.6512113111,    5.9633950290,    5.1071787209,    19.1872165826,    173.7270486111,    59.0753631951,    1.6570427293,    2.6006889985,    -2.4041964167,
    -377.0019509034,    -5080.5082448078,    -25.2703393343,    341.2560462353,    2.3586909843,    1.6248485054,    1.3071399018,    0.4045075056,    4.7831774507,    0.4434562071,
    0.6371190677,    0.1338568574,    0.9972968272,    1.4489213126,    115.1728705270,    2.4163630402,    0.3888033748,    32.6465625741,    0.3542408126,    0.6225550322,
    0.0850753474,    1.0786464011,    2.1056466018,    18721.9285095555,    0.5282905096,    8.6894668603,    0.6851141073,    0.8580020418,    0.1572877966,    1.2670877698,
    1.9037192153,    212.1749014105,    2.3971110620,    0.2023436587,    0.4035450534,    0.0734000270,    0.4389320802,    0.6171662391,    50.3884622730,    2.5882523773,
    3.5481612207,    0.6640119103,    4.7190914608,    7.0242942615,    769.8385929543,    0.3836819094,    0.0970597347,    0.4458278348,    0.6461679681,    59.8911213543,
    0.1267678597,    0.6765288882,    0.9443877940,    77.1100422640,    0.1479173119,    0.1971127865,    13.5806834949,    1.4502828960,    112.1835193231,    168.2590427167,
    3.6674172891,    43.3022649090,    160.0494738744,    0.2670161330,    161.1437532836,    43.0412136259,    28.7932176318,    1.4037515028,    1.9340325045,    1.4980951362,
    2.8225166344
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.0613202519,    0.0500467832,    0.5495538721,    0.0500467832,    0.4025386712,    0.2110572614,    0.1725606205,    0.0901597680,    0.0559363953,    0.2986463455,
    1.7643457516,    5.2952777195,    0.0250470023,    0.9213525109,    0.2238723531,    0.5882007127,    0.8759988891,    0.3674467261,    0.8244965529,    0.6392042841,
    0.3452285553,    2.5491121454,    0.3491376215,    0.1340087847,    0.5272539058,    0.6174580636,    1.3971857898,    1.6846329667,    3.5009305300,    0.9587249941,
    1.5388705414,    0.1151595212,    7.7366573303,    95.2232368210,    86.4594296074,    95.1310323826,    38.5270761983,    0.1554326928,    0.1595419723,    0.1631835113,
    0.1189529459,    0.4261266983,    0.5089019592,    0.5604110991,    14.1288821051,    3.6409667139,    0.2315878467,    0.2939324077,    0.7824431648,    4.5199379891,
    3.5010616681,    2.2351507243,    1.1423925062,    0.7017618635,    192458471447285.2500000000,    5.3827794559,    39.9298633386,    5.4374081983,    1.7756312849,    7.6635630303,
    32.7871650219,    14.3829650455,    6.6491237944,    10.8634705737,    1.0722066764,    1.5431010259,    36.5563235775,    8.8339769803,    13.2605094264,    15.5154878416,
    24.3252340823,    8.4238136173,    6.8609365435,    28.3632392418,    6.6390481952,    8.1478450180,    5.8103743341,    1.8424931879,    5.2747953719,    4.9719485229,
    7.6189037907,    0.8405132697,    0.2813802735,    2.2496334741,    28.0426078504,    0.2641343178,    0.2473065843,    0.0354106837,    0.1225808616,    8628.2547463655,
    120.1171282325,    113.5816138640,    118.3124608747,    39.5148597535,    375.3396039362,    686.9298443143,    2523.6383404701,    1444.1197566002,    2307.3525774253,    5.3320812628,
    4.4665796675,    3.9460172383,    0.7094969639,    0.6858564730,    7.6440824856,    5.4118672574,    3.8213446378,    28.8125662315,    16.3929159198,    440.9983743280,
    56.7311508372,    58.4014814912,    54.9494790590,    1.2546411019,    1.6941310539,    2.2184364456,    2.7646143893,    2.2726979935,    0.4882216467,    0.4419693590,
    15.2090736460,    9.2087999572,    18.6446191264,    46.5587859182,    61.5639233581,    85.7634194687,    0.2212357028,    0.2293910362,    0.2322893140,    0.2063489516,
    0.1781017988,    0.1280943143,    45.7336060737,    17.9652167722,    28.7749949787,    35.1762039821,    38.7366962622,    32.1335756798,    3.2021657054,    3.2710271084,
    4.3468263936,    2.8160643140,    36.2498499404,    6.7017793960,    10.1414439712,    53.8441205257,    96.8490181585,    99.7006896373,    87.2488976501,    90.9749046033,
    1468.8574233136,    243.4827302730,    505.4222013142,    485.3488758423,    421.0975816608,    544.4310776183,    519.7091546858,    486.6754195089,    1.5763780608,    0.6302474937,
    1.1891528477,    1.2387928610,    0.9600834521,    1.7356861697,    1.9203006583,    1.9568715552,    1.8140360883,    1.7229389338,    0.9366839846,    1.7593260125,
    3.2680551953,    2.0853872695,    3.3690152647,    6.1656258106,    11.5182801186,    0.0066720217,    0.0066875650,    0.0091630381,    0.0087272644,    1.1496861150,
    1.2375845448,    1.4763464347,    0.1078093103,    0.1047935727,    0.1211387350,    0.0966628689,    0.0813118900,    2.3791771255,    1.1115212662,    31.5106060890,
    5.6367819874,    6.1471854455,    8.7606429565,    14.8810393923,    15.8562025032,    0.0407395824,    0.0214032281,    0.0382097240,    0.0588089951,    0.0541004261,
    0.0455996989,    0.0725478137,    0.3050257556,    0.1175295701,    0.0865997617,    1.3163670762,    0.5645614214,    0.5157205588,    0.1977917998,    0.3335268745,
    0.2470381275,    0.2715073142,    0.1929490099,    0.1966123697,    0.2186316139,    0.2338721964,    0.2633329120,    0.1306704587,    0.1899655052,    0.3355234524,
    0.2279168027,    0.3868614400,    0.1765532905,    0.2503349102,    0.1884895633,    0.1888397083,    0.2673348648,    0.3052160473,    0.2274825018,    0.1878560286,
    0.2774095947,    0.3425355506,    0.3587504894,    0.4694333542,    0.7122344387,    0.4148293457,    0.4457322350,    0.5325969793,    0.5200906158,    0.5114172255,
    0.5233008558,    0.4764519164,    0.3880192625,    0.4675729748,    0.3150729338,    0.2567247539,    0.3422476482,    0.3952001701,    0.3939090506,    0.3831702832,
    0.6772393514,    0.8478604591,    0.3025622413,    0.4368073313,    0.3755316492,    0.2843044748,    0.4151091451,    0.4926572656,    2.2496821247,    0.3972028911,
    0.3326031160,    0.3627457844,    0.5292781341,    75.8073345637,    0.7112163810,    107.1192162412,    4.3559824990,    0.6700667129,    0.1549913655,    0.4475961655,
    3.2670466568,    0.1023669351,    1.2898678303,    0.6794782718,    0.0592360375,    0.0327975447,    3.4858268393,    8.1132975596,    0.2520551049,    9.4002597623,
    17.2631926701,    16.3384786756,    16.5783576849,    10.9100648974,    20.2635461657,    0.4468484978,    0.5114767933,    0.1039954502,    0.0700006013,    0.0907040697,
    0.0943573241,    0.1381977675,    0.0457093107,    169.7094480678,    84.7386555630,    118.1726138974,    169.7094480678,    4.4840838937,    84.7373272064,    1.0000000000,
    0.8469352091,    0.0895423397,    0.7810226209,    48.4487927113,    1.0480781721,    1.3823063451,    2177.1679215431,    159.5916238995,    79.7961666499,    112.6446761872,
    159.5916238995,    3.6129997609,    79.7948999090,    0.8443954101,    0.0897246571,    0.7803492964,    48.7214706954,    1.0671170131,    1.3857671616,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    0.0433554216,    1.0000000000,    1.7643805938,    0.3452285553,    5.2972692250,    0.0933338771,    0.8147137307,
    2.4912695830,    0.9213525109,    0.1170877441,    0.2473065843,    0.7305754457,    1.0001440206,    0.4127269014,    0.8244965529,    1.0000000000,    0.2732189994,
    1.0000000000,    1.0000000000,    0.2373479134,    0.0250470023,    0.1988599108,    1.0000000000,    0.1030728224,    0.1343963826,    0.1721078668,    0.2731035905,
    0.0250470023,    1.0000000000,    0.5868821115,    0.7200319510,    0.9472004524,    0.0354106837,    1.7281955039,    1.0000000000,    0.0250470023,    0.0559363953,
    0.5220684096,    1.0000000000,    1.0000000000,    0.0559363953,    0.1199603478,    1.0000000000,    0.1268638026,    0.1147317087,    0.2408796315,    0.1085583887,
    0.0354106837,    0.0828101948,    0.6375746629,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.2398122673,    6.7924384852,
    0.7727509951,    1.4260292188,    5.0604741346,    0.4573791144,    0.9323828549,    0.6317120415,    0.2307743508,    4.1747157178,    1.0980835618,    0.4530923367,
    3.4877376809,    2.2692454952,    3.7178770225,    0.9290749081,    3.4755821720,    1.5240489944,    0.3283355189,    0.0718734848,    0.2790023758,    0.0260032032,
    0.3159516467,    2.8720108596,    5.6346197530,    0.2885500429,    0.1172423664,    0.2902564886,    0.2009363612,    0.0546506850,    2.2034672611,    0.4322031106,
    0.5800788355,    0.9635765594,    28.8108158507,    79.6107068813,    0.1545574198,    0.1537290441,    0.1252106634,    0.1727104098,    0.8164860334,    18.4398721609,
    1.0000000000,    0.7442899870,    12.2882520371,    0.4340609492,    1.1096447124,    0.1368368964,    2.8618726083,    0.2503577894,    3.1517032289,    0.3003736131,
    9.0710525931,    11.4329978174,    14.3886282704,    18.1032923805,    21.8400577488,    29.1464459990,    39.5509643781,    54.0534279671,    68.7532509163,    251.7716163040,
    0.5484260953,    0.7331880299,    1.1056154928,    1.4744202031,    1.8277702430,    0.0749519727,    0.0933338771,    0.0292409336,    0.0039173540,    0.2556965542,
    1.3781866812,    0.7035721335,    89.6818344470,    606.1246093917,    1.5484664889,    1.3267228349,    1.4439349199,    0.4463906859,    2.7300198741,    0.2613412984,
    0.3672746349,    0.1380127902,    0.1441426312,    0.7670836817,    0.8256789830,    1.3615749208,    0.2958589556,    0.3950519434,    0.4963094034,    0.1486157435,
    0.5709508177,    0.8552968592,    0.2284905787,    0.4938575538,    0.5034603355,    0.1597444791,    0.1069793810,    0.6863851655,    0.2410858923,    0.4192869045,
    0.4773503770,    0.4881554468,    3.0793178941,    65.3284759262,    0.7786008076,    2.4944356989,    3.8674007192,    1.4554204417,    0.3184597115,    0.1386140222,
    2.3789910284,    0.8412777884,    73.8724468535,    3.1253441489,    0.4745282424,    0.3969728014,    0.2899059149,    0.0792062601,    0.4654399271,    0.2591480062,
    0.1536805403,    1.5720961774,    5.0524636068,    3.9424646588,    3.7670554497,    108.9880130772,    29.8491515208,    2.7609263848,    2.3001729634,    2.3749990190,
    494.2287098108,    3758.0116611599,    75.2258088384,    74.4477342155,    3.3233792471,    1.1440722377,    0.8412777884,    0.4745282424,    3.1253441489,    0.3969728014,
    0.4654399271,    0.2591480062,    0.2899059149,    0.0792062601,    73.8724468535,    5.0421959035,    0.8127053258,    72.9780497148,    0.9831471473,    0.7677457748,
    0.3586342162,    0.8261054758,    0.2308992552,    37903.7596685719,    0.9869624570,    18.4993290247,    1.4786678708,    1.1076090989,    0.3667536131,    0.8170665474,
    1.2294078553,    435.8515609054,    4.3099368916,    0.4699469789,    0.6396315404,    0.2565119886,    0.6293156046,    0.7442369334,    95.4056971521,    5.3369255957,
    4.6851759738,    1.7222124928,    3.2176636732,    4.6550389820,    1604.3840513668,    0.5234956240,    0.2891923439,    0.4242998954,    0.5784951840,    136.1575599670,
    0.3337900397,    0.5966192571,    0.7120390470,    99.7008539421,    0.3300586027,    0.3887907413,    31.7190770398,    0.4560405781,    73.4381371537,    108.8892077636,
    3.5267146571,    28.0426078504,    99.1868134920,    0.0408616639,    102.9741084192,    27.2427229470,    18.4681117134,    0.3174536854,    0.4408162739,    0.3414548175,
    0.6327528093
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 501;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    1,    13,    15,    18,    26,    27,    38,    45,    61,    64,    66,    67,    72,    78,    80,    82,    83,    84,    89,    97,
    100,    111,    131,    150,    182,    219,    232,    233,    291,    293,    294,    295,    296,    297,    298,    299,    300,    302,    303,    304,
    305,    306,    307,    308,    309,    310,    312,    314,    316,    322,    325,    326,    330,    332,    333,    335,    337,    338,    341,    346,
    348,    349,    350,    353,    354,    355,    357,    358,    366,    370,    374,    376,    379,    381,    382,    385,    389,    390,    391,    392,
    393,    398,    412,    421,    422,    423,    487,    500,    516,    521,    522,    543,    561,    562,    571,    573,    579,    580,    581,    645,
    647,    648,    651,    653,    660,    662,    667,    672,    673,    679,    688,    689,    690,    698,    699,    700,    701,    710,    726,    727,
    732,    733,    734,    736,    737,    739,    743,    744,    745,    746,    747,    749,    750,    751,    752,    753,    755,    757,    760,    761,
    763,    765,    768,    769,    776,    778,    779,    782,    783,    784,    786,    787,    788,    791,    792,    799,    801,    803,    804,    805,
    807,    809,    811,    815,    816,    817,    819,    820,    823,    832,    834,    836,    837,    841,    845,    851,    853,    855,    856,    861,
    863,    864,    871,    872,    873,    874,    875,    876,    880,    885,    886,    904,    905,    908,    910,    917,    920,    922,    924,    928,
    931,    934,    939,    940,    942,    948,    949,    953,    960,    963,    964,    968,    976,    979,    981,    982,    984,    989,    990,    993,
    1014,    1019,    1021,    1023,    1029,    1038,    1041,    1042,    1045,    1046,    1050,    1053,    1054,    1055,    1059,    1061,    1062,    1064,    1070,    1073,
    1077,    1079,    1087,    1088,    1101,    1102,    1103,    1109,    1110,    1117,    1121,    1122,    1134,    1135,    1141,    1142,    1144,    1146,    1155,    1156,
    1163,    1170,    1172,    1214,    1232,    1241,    1256,    1271,    1289,    1309,    1310,    1318,    1330,    1332,    1333,    1340,    1344,    1346,    1351,    1359,
    1360,    1361,    1362,    1363,    1364,    1365,    1366,    1367,    1368,    1369,    1370,    1371,    1372,    1373,    1374,    1375,    1376,    1377,    1378,    1379,
    1380,    1381,    1382,    1383,    1384,    1385,    1386,    1387,    1388,    1389,    1390,    1391,    1392,    1393,    1394,    1395,    1396,    1397,    1398,    1399,
    1400,    1401,    1402,    1403,    1404,    1405,    1406,    1407,    1408,    1409,    1410,    1411,    1412,    1413,    1414,    1415,    1416,    1417,    1418,    1419,
    1420,    1421,    1422,    1423,    1424,    1425,    1426,    1427,    1428,    1429,    1430,    1431,    1432,    1433,    1434,    1435,    1436,    1437,    1438,    1439,
    1440,    1441,    1442,    1443,    1444,    1445,    1446,    1447,    1448,    1449,    1450,    1451,    1452,    1453,    1454,    1455,    1456,    1457,    1458,    1459,
    1460,    1461,    1462,    1463,    1464,    1465,    1466,    1467,    1468,    1508,    1515,    1520,    1533,    1549,    1580,    1582,    1584,    1589,    1598,    1616,
    1634,    1697,    1698,    1708,    1735,    1792,    1810,    1812,    1815,    1816,    1818,    1819,    1825,    1826,    1828,    1829,    1838,    1843,    1853,    1855,
    1856,    1859,    1861,    1865,    1868,    1869,    1872,    1877,    1881,    1892,    1923,    1962,    1979,    1980,    1981,    1982,    1983,    1984,    1985,    1986,
    1987,    1988,    1989,    1990,    1991,    1992,    1993,    1994,    1995,    1996,    1997,    1998,    1999,    2000,    2002,    2012,    2115,    2167,    2171,    2177,
    2188,    2194,    2210,    2216,    2232,    2237,    2251,    2252,    2254,    2260,    2269,    2271,    2272,    2274,    2334,    2344,    2345,    2346,    2347,    2414,
    2499,    3036,    3075,    3095,    3102,    3108,    3232,    3501,    3765,    3766,    3768,    3769,    3770,    3802,    3803,    3805,    3824,    3829,    3842,    3993,
    4092
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 25;
constexpr int N_PHYSICS_FEATURES = 65;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
    "dD",
    "dH",
    "dP",
    "HansenTotal",
    "BP",
    "deltaHvap",
    "logVP",
    "logPow",
    "logWS",
    "deltaHf",
    "deltaHc",
    "MP",
    "Flashpoint",
    "logHenrycc",
    "DipoleMoment",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/logviscosity_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/logviscosity_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadelogViscosity
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadelogViscosity {
struct Model {
    using Namespace = CascadelogViscosity;
};
} // namespace CascadelogViscosity
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
