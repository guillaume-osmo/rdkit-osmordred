#pragma once
// Auto-generated Treelite model for logVP (v3.4 XGBoost)
// Trees: 300, Features: 591
// Target normalization: mean=0.8977753960, scale=2.6765219640
// Library: logvp_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadelogVP {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 591;
constexpr double TARGET_MEAN = 0.8977753960;
constexpr double TARGET_SCALE = 2.6765219640;

// Normalization stats
constexpr int N_NORM_FEATURES = 591;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0030886628,    0.1604287791,    0.0132630814,    0.0030886628,    0.0893895349,    0.0297965116,    0.0303415698,    0.0019985465,    0.0461482558,    0.0072674419,
    0.0148982558,    0.0152616279,    0.0012718023,    0.0027252907,    0.0034520349,    0.0036337209,    0.0065406977,    0.0087209302,    0.0367005814,    2.0145348837,
    2.8057776163,    0.0615915698,    0.6498909884,    0.1976744186,    0.3522892442,    0.3664607558,    0.3335755814,    0.4576671512,    1.8115915698,    1.2921511628,
    0.0486918605,    0.0029069767,    0.4491279070,    0.0610465116,    0.2138444767,    0.5603197674,    0.5715843023,    6.9045553796,    0.6535102933,    -0.1119513481,
    0.5182687830,    14.3685306243,    182.3928866279,    167.6387994186,    181.9749471286,    0.2798741026,    0.1309569733,    1.6216088104,    1.9574767317,    23.8729544868,
    10.2560725639,    2.0604992695,    -2.0611119604,    2.1519125085,    0.4088320746,    1.9528502210,    2.9757493138,    202.2442015364,    4.6718423793,    3.1388725718,
    3.7510294767,    1.5532096299,    -0.4584761024,    9.9664409796,    74.9561281377,    3.5966336876,    0.8928493935,    1.4047471437,    18.4727488768,    6.2439367912,
    11.3333702808,    4.4958022284,    7.8238649278,    3.7415956289,    18.9401507994,    3.6369240998,    5.7338333465,    7.8127856660,    4.0549369313,    6.5872253886,
    16.9084959784,    7.9967231302,    2.6125877578,    0.7882260916,    0.0639146967,    4.3514962723,    0.0870180376,    0.3181322674,    0.0503270349,    2.9638386701,
    49.4907085574,    0.0621366279,    0.1466206395,    0.2972383721,    0.0397892442,    0.9380450581,    0.0726744186,    1.1615049532,    14.6369912791,    125.2501703712,
    146.9298383916,    50.4016716711,    20.7813222856,    95.2103924419,    102.0899741009,    68.4958108903,    755.1482558140,    604.3402979651,    220.9434956395,    2276.3464955440,
    2830.9066244348,    754.0546063419,    247.3582471475,    43.4835055880,    3.8227651708,    2.1845178443,    1.2708905810,    0.8300227334,    2.1882306676,    1.8347163719,
    1.6015297357,    1.3651620765,    2.8475206219,    3.3770131831,    2.3472246083,    1.3179165532,    13.7278952380,    11.1171565688,    9.4958827572,    80.8014443701,
    33.5262347171,    132.1435238875,    7.7273564474,    7.6531815191,    7.4009924252,    5.8564519159,    6.1401566622,    1.5786501134,    1.2941315016,    0.9747107003,
    160.8754417250,    145.3021341890,    122.5501222367,    0.2984899327,    -0.1452364606,    -0.0094837186,    -0.0069093601,    0.0124029330,    -0.0063255565,    0.0037799438,
    66.1792712925,    16.6322216194,    1.6817408312,    -14.9988179907,    -16.2789443261,    -4.7749731508,    0.1935580299,    -2.7537122274,    0.4552732968,    5.2349784678,
    -3.3463278121,    -4.4004189558,    -1.9086655648,    4.7154528701,    -2.7004381033,    -15.1004732612,    17.6144811014,    -21.4728648168,    -48.3299317281,    -63.8120151108,
    -0.0976832263,    -0.2295725065,    -0.0361530255,    -0.1017679871,    -0.0710112191,    -0.1313218692,    0.3967952484,    -0.3934884763,    -0.3537379769,    -1.7090302505,
    -1.0861821783,    -0.0503690225,    0.1794077108,    -2.8466244272,    -8.9628405120,    -2.4343575365,    0.0618633181,    0.0134556331,    0.0002080761,    0.0002816295,
    0.6129063790,    -0.3898345426,    0.0374800498,    16.1646694327,    -0.6895740147,    -0.4341024792,    -3.9099149965,    49.0516952588,    -1.6885013254,    -6.4978079747,
    -3.2245309794,    3.8366644540,    -0.0061314188,    -0.0033230880,    0.0069343758,    -0.0027528302,    0.2980019428,    -0.0206166947,    -0.0132068521,    1.5746135782,
    -0.0864402375,    -0.0048792115,    -0.0265526594,    0.0393698823,    -0.1727117614,    -0.1354158134,    0.0714196398,    0.0534922864,    -0.0817333309,    -0.0628435722,
    -0.0117431087,    -0.0828272556,    -0.0126701157,    -0.0546066919,    -0.0362443978,    -0.1312763376,    -0.0620293130,    -0.0502986830,    -0.0426270918,    0.0306420685,
    -0.0727066328,    -0.0716020077,    -0.0424755176,    0.0297169876,    -0.1028711030,    -0.0586128273,    1.4520119970,    1.0180337919,    0.9832976970,    0.7263719396,
    0.4272659369,    1.1848453517,    0.7022330044,    0.3780887674,    0.9018689456,    0.3863359282,    1.1724287293,    0.7743283020,    1.0364649488,    0.8331080840,
    0.4837511540,    1.0366555421,    0.9787289052,    0.5011480036,    0.9619664012,    0.8690305300,    0.9892947541,    0.9307677706,    1.1120879998,    1.0628165903,
    0.9865670317,    0.4820486588,    0.9976379168,    0.8481573529,    0.7070177673,    1.3985989020,    1.1309316163,    4.9820408101,    1.0039997910,    2.4965807387,
    2.2951496140,    13.3906766567,    -0.6087834801,    6.4127708521,    0.3259295392,    0.1989836737,    0.0299781977,    0.9995295941,    0.0760293668,    1.4939749407,
    0.3523902655,    0.1778727265,    0.1078293995,    0.0604051224,    0.6001237747,    8.3686146167,    2.8028706395,    0.0119912791,    0.2810683140,    1.5308866279,
    0.6498909884,    0.0072674419,    0.0550508721,    0.3813590116,    0.9894622093,    0.1113735465,    0.3539244186,    0.0000000000,    0.0465116279,    0.0000000000,
    0.0003633721,    0.0561409884,    0.0056322674,    0.0261627907,    0.0000000000,    0.0261627907,    0.0615915698,    0.0603197674,    0.0241642442,    0.0152616279,
    0.0000000000,    0.1974927326,    0.3664607558,    0.4162427326,    0.0105377907,    0.3530159884,    0.0014534884,    0.0007267442,    0.0018168605,    0.0198037791,
    0.0000000000,    0.0000000000,    0.0030886628,    0.0285247093,    0.0001816860,    0.0118095930,    0.0178052326,    0.0434229651,    0.0099927326,    0.0021802326,
    0.0132630814,    0.4574854651,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0005450581,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0759447674,    0.0000000000,    0.0000000000,
    0.0000000000,    0.0000000000,    0.0116279070,    0.0000000000,    0.3911700581,    0.0496002907,    0.0367005814,    0.1204578488,    0.0257994186,    0.0483284884,
    0.0265261628,    0.0000000000,    0.0000000000,    0.0000000000,    0.0011038184,    -0.0009492956,    0.0000000000,    4.2161666745,    0.2382994768,    3.1291442320,
    0.0597416418,    0.5063866057,    2.8871079700,    0.2442898520,    0.0136069857,    0.1264238550,    0.0027928280,    0.6305836806,    0.1192902505,    -0.7681754194,
    0.0000000000,    0.2466101102,    0.0000000000,    0.0024822219,    0.1592369078,    0.0168006865,    0.2146101598,    0.0000000000,    0.0940035760,    0.2470779983,
    0.1053550185,    -0.0202960815,    0.0218211968,    0.0000000000,    1.7388064447,    3.9645033194,    2.0803691145,    0.0560170881,    4.1765532610,    0.0018570529,
    0.0001500031,    -0.0013437029,    -0.0441603744,    0.0000000000,    0.0000000000,    -0.0084422455,    0.0910920903,    0.0623375580,    0.0824689200,    0.0534989641,
    0.3054837964,    0.2900019991,    -0.2232969679,    0.1585834398,    1.3315492144,    0.1075008490,    0.2512583627,    0.5333578219,    -0.2492223698,    0.0738555317,
    0.5020143001,    5.8013289037,    0.3462734903,    0.1791160688,    0.8377526638,    0.0175191144,    0.8754324517,    0.3324886498,    0.0222239297,    0.8170610536,
    0.1446952699,    20.3179814680,    -2.8797723484,    1.2718764358,    1.9643587857,    2.8246746697,    32.2049483350,    50.4442258341,    89.2598479721,    0.7570689261,
    0.6170654441,    2.5919322638,    26.4763007152,    44.9051998360,    30.3672559114,    25.3373524925,    24.4003966851,    5.3550969655,    0.0753325094,    0.0356398557,
    0.0218048275,    0.0568395843,    2.5515299210,    17.5354762598,    21.3671457122,    0.0345375797,    0.0190025665,    0.0094113327,    0.0054905231,    5.3149733295,
    117.4536813227,    0.4416295030,    0.0269572908,    0.2857476081,    3.4175228083,    0.0477721463,    0.0600689255,    0.2670700162,    0.1170553032,    0.8465348911,
    0.0072102530,    0.5744912791,    0.0413718729,    1.6983799086,    0.0280601690,    0.1068255754,    0.0067356753,    0.0081056447,    5.7159615814,    0.0178052326,
    0.0045976890,    0.0144207877,    0.1975826669,    2.8811453242,    0.0972140262,    0.4606489826,    0.7761911337,    0.6092169331,    5.5584224201,    6.1802015824,
    38.3147069300,    50.6203066624,    2.1965552781,    1.2654101115,    1.4432188178,    0.6244222632,    0.0079941860,    0.0183502907,    7.8381177326,    0.0019985465,
    1.0728561047,    1.4530371212,    131.3809073597,    5.5297859602,    0.5977337241,    0.4453908982,    1.0532047799,    1.4586582518,    0.7041655184,    0.1063218535,
    0.3936379994,    16.7064225920,    5.4075553939,    5.3080685883,    18.9970317223,    174.4912127625,    58.6763221003,    1.4530371212,    0.5977337241,    5.5297859602,
    0.4453908982,    0.7041655184,    0.1063218535,    1.0532047799,    1.4586582518,    131.3809073597,    2.4795630186,    0.8145589629,    37.5357754237,    0.3499035402,
    0.7838623380,    0.0601859863,    1.2205506122,    2.1345777000,    20497.6563731740,    0.9684419665,    9.4114227628,    0.6994463929,    1.0731073422,    0.1379525839,
    1.5263383843,    2.1287418849,    224.6517346785,    4.4884020021,    0.3276637940,    0.7051190602,    0.0736983610,    0.7453031129,    0.9146668439,    94.9726929048,
    2.8251017955,    4.6821863973,    0.5921666898,    6.0259048479,    8.1770599989,    865.5441481514,    0.4199429349,    0.0799049970,    0.4753826873,    0.6531234762,
    63.1194640811,    0.0999474968,    0.8319121481,    1.0563569221,    101.0530523153,    0.1178536921,    0.1570249802,    12.2236238214,    1.5464686705,    140.0393829317,
    193.1939314918,    4.5620087287,    49.4907085574,    175.6630144432,    0.2719224962,    181.6995798852,    47.9100211310,    32.8452268399,    1.3080677439,    1.7823869601,
    1.3806310026,    2.6081383576,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,    0.0000000000,
    0.0000000000
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.0554898455,    0.4813644511,    0.1220820729,    0.0554898455,    0.4494870196,    0.1995240394,    0.2279254893,    0.0485584639,    0.3706821040,    0.0911303595,
    0.1493556552,    0.1708807252,    0.0356396527,    0.0725359782,    0.0725050261,    0.0761626520,    0.0931565860,    0.1156231500,    0.2265877773,    1.9043648804,
    3.7688811557,    0.3383549834,    1.0380077154,    0.5109502648,    0.7719547207,    0.6424664976,    1.7685661335,    1.2997467641,    2.6517059442,    1.7750604380,
    0.2651481121,    0.0538379627,    1.2229452848,    0.3305783483,    0.7614562351,    1.1100405461,    1.3853859723,    3.6192568482,    0.7629322544,    1.6415555381,
    0.1262342155,    8.7825835941,    87.7704087495,    86.0968615639,    87.3315476536,    0.1631262198,    0.1194654042,    0.4672239348,    0.5381532346,    17.7670182252,
    2.0086240416,    0.2564198326,    0.2027880446,    0.2527783426,    0.6328631924,    0.4069744653,    0.7041419711,    192.1162997324,    2.5055147481,    1.7694210801,
    2.6810214116,    3.6657914588,    0.7410290587,    4.4869043368,    32.1974819392,    4.8360478816,    3.3000604760,    3.0068384498,    14.6277648642,    9.7798437342,
    17.8128001486,    7.8851325373,    16.8304993117,    5.9739138322,    23.1143765336,    6.7371777014,    7.8570468414,    8.6778611403,    8.2749121004,    11.5253589038,
    17.4685526929,    15.6262988835,    5.2816055502,    1.9172284038,    4.1133766018,    4.4024318863,    1.6060383958,    0.6339404729,    0.2532705443,    1.9371825024,
    21.5392974673,    0.2784499745,    0.4986677644,    0.6321851557,    0.2071953123,    2.9739626320,    0.3654128739,    0.1073442429,    9.2828876832,    116.0146143344,
    176.3324362141,    145.6021613940,    103.3441548041,    87.7048933768,    117.4082011292,    30.2536629913,    745.4074427026,    695.3350525637,    497.0772561562,    1333.4080421896,
    3588.8856370154,    2025.0411215335,    252.0089338893,    50.7823174305,    5.1648871405,    5.4012553755,    4.2773076963,    3.4864112947,    0.7372619552,    0.7021526981,
    0.7732101603,    0.7909839483,    1.1472513631,    4.3940119028,    5.0685305172,    3.6665700744,    29.3185325602,    20.7549146849,    22.9555131882,    170.1068476385,
    155.1130832963,    65.5161786811,    1.0166936050,    1.3224651575,    1.7310477112,    1.6385875505,    1.1367490819,    0.8401381334,    0.5217891569,    0.5612996502,
    21.8340937728,    62.4514251288,    78.1861595446,    0.3186254899,    0.2007050302,    0.1842513414,    0.1675472411,    0.1417373573,    0.1176947015,    0.0950794597,
    42.1575875320,    17.8368009940,    29.6139298816,    33.8936937809,    34.5507068790,    36.4295397604,    28.7971562416,    5.0909185480,    2.8854411405,    19.9056945553,
    22.8021202561,    19.6587604176,    14.7760569331,    51.8159362965,    118.6643946063,    134.5074105281,    237.4244454981,    613.1885760197,    108.0292175488,    436.1160782121,
    0.4671220519,    1.1576541114,    0.7825409777,    0.5612940898,    1.7200721251,    0.7014341466,    1.6637960403,    1.7961681961,    2.6302189916,    3.2351304188,
    5.0413946944,    2.3331779668,    2.4599616877,    15.2955432061,    17.7032525247,    15.1850011162,    12.4808349639,    0.0151831184,    0.0064555225,    0.0057259860,
    0.7171940411,    1.0541014830,    0.1299179712,    32.3036549820,    9.3037588875,    8.5746785538,    52.2417799017,    11.4676098501,    8.7759025336,    9.8446950870,
    10.1468266764,    15.6163263747,    0.0241600246,    0.0443702544,    0.0386027666,    0.0563166071,    0.2695035152,    0.1143292191,    0.1026441005,    1.2955331422,
    0.4283541599,    0.5718548325,    0.1984987123,    0.2683946337,    0.1465370075,    0.1578892967,    0.2112679683,    0.2008190221,    0.2020998045,    0.2212511694,
    0.1222403621,    0.2266585719,    0.1199396093,    0.1072566961,    0.1749980860,    0.1959481716,    0.2015154262,    0.1475992726,    0.1411421150,    0.1985638887,
    0.3090889890,    0.1487697447,    0.1771991209,    0.3075371738,    0.1874077172,    0.1858837893,    0.3250414459,    0.3262238514,    0.4109321660,    0.5979865760,
    0.6501183405,    0.3900840878,    0.6212187481,    0.5739643061,    0.4317373122,    0.4767796345,    0.5390537406,    0.2938604851,    0.5042520207,    0.8330606310,
    0.8143926238,    0.3915086458,    0.2671182391,    0.7292746699,    0.3179601775,    0.4236807249,    0.3952704549,    0.3526740541,    0.3916546686,    0.4753126509,
    0.6550882935,    0.8015351653,    0.3835001602,    0.4603478213,    0.5646435799,    0.3423340961,    0.2318482283,    1.2883288184,    0.1380325431,    0.0836672182,
    0.0904776177,    1.5413869470,    1.1542996244,    3.2048147260,    0.1809496360,    0.1291169484,    0.2231405715,    1.0753627896,    0.3181083499,    1.4973293251,
    0.0638723569,    0.1496936485,    0.1193009559,    0.0863631338,    0.1129616103,    4.6103944263,    3.7694050889,    0.1153298603,    0.7288923330,    2.6421350101,
    1.0380077154,    0.1006061772,    0.2904486011,    0.7112733518,    1.8502920892,    0.6248150912,    0.8980108866,    1.0000000000,    0.2507593929,    1.0000000000,
    0.0190588576,    0.2653884667,    0.0748367891,    0.1888192725,    1.0000000000,    0.1916842037,    0.3383549834,    0.2749120622,    0.2205742685,    0.1339241851,
    1.0000000000,    0.5104869355,    0.6424664976,    0.8384591761,    0.1021114375,    1.7898844650,    0.0425998572,    0.0269483957,    0.0504014253,    0.3265285466,
    1.0000000000,    1.0000000000,    0.0616917105,    0.1739386527,    0.0134778721,    0.1222312373,    0.1440782950,    0.2502258832,    0.1012731452,    0.0466420319,
    0.1190684188,    1.2997408339,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.0301352475,    1.0000000000,
    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    0.4515507612,    1.0000000000,    1.0000000000,
    1.0000000000,    1.0000000000,    0.1199986479,    1.0000000000,    0.7373953987,    0.2363493856,    0.2265877773,    0.3829431158,    0.1706777713,    0.4411485369,
    0.2381368375,    1.0000000000,    1.0000000000,    1.0000000000,    0.0579129329,    0.0518248852,    1.0000000000,    4.2515611315,    0.9911124793,    5.1389658789,
    0.5749900837,    1.4172837453,    5.1750139694,    1.0833374707,    0.1845305086,    0.7013708345,    0.6740492781,    1.4065016787,    0.7315129816,    5.5558709196,
    1.0000000000,    1.3370546388,    1.0000000000,    0.1305306731,    0.7661530041,    0.2244453920,    1.5463679459,    1.0000000000,    0.7042830586,    1.3574492246,
    0.5382020555,    0.2314503459,    0.1945295958,    1.0000000000,    4.5331931963,    7.0428495976,    4.4307506241,    0.5441485578,    21.7153476950,    0.0548422602,
    0.0083121314,    0.0419719165,    0.7551597793,    1.0000000000,    1.0000000000,    0.2434380500,    0.7472555096,    0.4282874363,    0.8295356380,    0.3923352482,
    1.8908772874,    2.6394841041,    1.1448613219,    0.7869262961,    2.2269544822,    0.7502970234,    1.4271837138,    0.6173844997,    1.2287690667,    0.5134965446,
    2.3061811216,    2.6173062679,    0.1812074604,    0.1264318536,    0.3566012374,    0.0416879679,    0.3168052808,    0.1105996508,    0.0196792199,    0.1606613187,
    0.1931292893,    29.8268980866,    1.9506205080,    0.3029147857,    0.4884713989,    0.5859059992,    15.1238019393,    24.6841240903,    48.0922978583,    0.1379881317,
    0.1331596942,    0.9107634920,    10.9833989520,    20.0906858276,    16.6860132645,    12.8491707397,    12.2306396279,    3.5656557860,    0.3388396601,    0.2800644024,
    0.1574808840,    0.1364318068,    0.5013108483,    11.3915986794,    26.5995044708,    0.0270289317,    0.0189925068,    0.0118290101,    0.0084831709,    0.7746709724,
    65.7601330353,    1.1582197722,    0.1054967491,    0.4527032156,    2.4742998880,    0.2388006184,    0.2673303846,    0.3939511676,    0.1446011841,    0.7083621343,
    0.0858777679,    0.8406309248,    0.2811423772,    3.0223300375,    0.1923279766,    0.9725749565,    0.1335394751,    0.1853730308,    7.9342571540,    0.1389426742,
    0.0881303641,    0.1953204256,    0.8011533208,    3.0345572266,    0.2042794359,    0.4887970063,    0.6516030795,    0.6927917655,    2.8005527700,    2.0109642331,
    37.5744637373,    24.0148424872,    1.1752465639,    1.0061660556,    0.1240297479,    0.6219547290,    0.1232790367,    0.1612691650,    5.0267591163,    0.0446604111,
    2.8119277422,    0.6068328789,    56.8921220778,    2.6376585560,    0.6762199036,    0.3892691716,    0.3336319884,    0.0830289375,    0.5366686694,    0.2210919486,
    0.1225017639,    1.7578624119,    4.0964506685,    3.8551381317,    3.4264558402,    118.8201818207,    26.1197879528,    0.6068328789,    0.6762199036,    2.6376585560,
    0.3892691716,    0.5366686694,    0.2210919486,    0.3336319884,    0.0830289375,    56.8921220778,    2.5188622382,    1.4777629470,    38.3044267278,    0.6562239775,
    0.9835561649,    0.2899130133,    0.9203318332,    0.2473220138,    20137.8025126995,    1.4068023734,    9.1557785923,    0.9691080841,    1.1059467001,    0.3352711543,
    0.8194904505,    0.9093510606,    223.2779363787,    6.7911152793,    0.6191872556,    1.0621891255,    0.2499675667,    1.0562508339,    1.0582306173,    141.7439124298,
    4.0470896203,    5.2613669924,    1.6149955683,    4.1233176837,    4.1147773412,    845.8801455447,    0.5712358406,    0.2750063300,    0.4552725307,    0.5740373091,
    87.5427912627,    0.2928875006,    0.7908774426,    0.8362340061,    108.6230568170,    0.2710848789,    0.3315527270,    29.6019936352,    0.5380459455,    83.9589902293,
    87.2247799451,    2.9098519209,    21.5392974673,    69.6065165040,    0.0418387633,    75.4984051367,    20.2008530539,    14.2230305195,    0.2640031484,    0.3518932046,
    0.2725753042,    0.5094355278,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,    1.0000000000,
    1.0000000000
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 501;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    13,    15,    17,    21,    26,    27,    28,    34,    35,    36,    38,    41,    42,    43,    44,    45,    60,    62,    64,    66,
    67,    75,    78,    82,    83,    86,    95,    97,    111,    122,    150,    153,    155,    169,    226,    232,    233,    291,    293,    294,
    295,    296,    297,    298,    299,    304,    305,    307,    308,    309,    310,    311,    312,    313,    316,    317,    318,    319,    325,    326,
    327,    331,    332,    334,    337,    338,    340,    344,    349,    352,    353,    358,    365,    367,    374,    378,    379,    380,    382,    383,
    384,    385,    389,    390,    391,    394,    395,    410,    415,    421,    422,    439,    453,    464,    475,    506,    511,    516,    531,    543,
    545,    549,    551,    557,    561,    562,    570,    575,    578,    580,    583,    587,    612,    630,    644,    646,    648,    649,    654,    655,
    656,    657,    661,    662,    666,    668,    674,    675,    676,    681,    686,    691,    698,    699,    700,    709,    716,    723,    726,    728,
    735,    738,    739,    741,    742,    745,    746,    747,    748,    749,    750,    751,    752,    753,    754,    756,    758,    763,    767,    770,
    772,    773,    775,    778,    779,    784,    787,    788,    796,    797,    805,    808,    812,    814,    819,    823,    824,    827,    833,    834,
    835,    838,    839,    842,    843,    845,    847,    849,    856,    857,    859,    862,    874,    885,    887,    892,    896,    903,    905,    906,
    907,    911,    913,    918,    923,    928,    939,    940,    941,    948,    950,    953,    958,    964,    974,    975,    979,    982,    983,    984,
    989,    992,    997,    1005,    1006,    1007,    1008,    1013,    1021,    1022,    1025,    1037,    1038,    1042,    1045,    1046,    1053,    1054,    1056,    1058,
    1060,    1063,    1066,    1068,    1072,    1075,    1077,    1078,    1080,    1082,    1084,    1085,    1086,    1092,    1104,    1105,    1109,    1110,    1111,    1112,
    1113,    1116,    1117,    1137,    1138,    1141,    1142,    1151,    1154,    1164,    1166,    1171,    1206,    1256,    1288,    1289,    1291,    1311,    1316,    1330,
    1335,    1352,    1353,    1354,    1367,    1377,    1407,    1408,    1409,    1410,    1411,    1412,    1413,    1414,    1415,    1416,    1417,    1418,    1419,    1420,
    1421,    1422,    1423,    1424,    1425,    1426,    1427,    1428,    1429,    1430,    1431,    1432,    1433,    1434,    1435,    1436,    1437,    1438,    1439,    1440,
    1441,    1442,    1443,    1444,    1445,    1446,    1447,    1448,    1449,    1450,    1451,    1452,    1453,    1454,    1455,    1456,    1457,    1458,    1459,    1460,
    1461,    1462,    1463,    1464,    1465,    1466,    1467,    1468,    1469,    1470,    1471,    1472,    1473,    1474,    1493,    1494,    1495,    1496,    1497,    1498,
    1499,    1500,    1501,    1502,    1503,    1504,    1505,    1506,    1507,    1508,    1509,    1510,    1511,    1512,    1513,    1514,    1515,    1516,    1517,    1518,
    1519,    1520,    1521,    1522,    1523,    1524,    1525,    1526,    1527,    1528,    1529,    1530,    1531,    1532,    1533,    1534,    1535,    1536,    1537,    1538,
    1539,    1540,    1541,    1542,    1543,    1544,    1548,    1549,    1580,    1584,    1591,    1600,    1619,    1629,    1636,    1680,    1692,    1710,    1720,    1729,
    1797,    1804,    1806,    1807,    1810,    1816,    1818,    1820,    1830,    1839,    1840,    1849,    1853,    1854,    1855,    1856,    1860,    1861,    1863,    1870,
    1874,    1879,    1886,    1890,    1892,    1894,    1895,    1897,    1966,    1972,    1973,    1982,    1997,    2009,    2153,    2167,    2168,    2169,    2170,    2184,
    2210,    2237,    2250,    2252,    2254,    2260,    2261,    2269,    2272,    2274,    2276,    2303,    2374,    2406,    2415,    2433,    2525,    2618,    2669,    2836,
    3177,    3237,    3607,    3764,    3765,    3766,    3768,    3769,    3770,    3781,    3814,    3819,    3820,    3835,    3838,    3866,    4002,    4004,    4041,    4069,
    4092
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 16;
constexpr int N_PHYSICS_FEATURES = 74;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
    "dD",
    "dH",
    "dP",
    "HansenTotal",
    "BP",
    "deltaHvap",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
    "logvp_flashpoint_deltahc_est",
    "logvp_flashpoint_sq",
    "logvp_deltahc_sq",
    "logvp_bp_deltahc_est",
    "logvp_bp_sq",
    "logvp_deltahc_sq",
    "logvp_bp_flashpoint_est",
    "logvp_bp_sq",
    "logvp_flashpoint_sq",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/logvp_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/logvp_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadelogVP
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadelogVP {
struct Model {
    using Namespace = CascadelogVP;
};
} // namespace CascadelogVP
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
