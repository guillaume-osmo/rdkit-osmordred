#pragma once
// Auto-generated Treelite model for logWS (v3.4 XGBoost)
// Trees: 300, Features: 594
// Target normalization: mean=-2.8897725201, scale=2.2530576113
// Library: logws_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadelogWS {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 594;
constexpr double TARGET_MEAN = -2.8897725201;
constexpr double TARGET_SCALE = 2.2530576113;

// Normalization stats
constexpr int N_NORM_FEATURES = 594;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0596233005,    0.0076088312,    0.0173381564,    0.4534115006,    0.1080204565,    0.1365847574,    0.0508918548,    0.0128476986,    0.0995384807,    1.4620182113,
    2.5712860172,    0.1054010228,    0.0402893851,    0.2352500936,    0.0073593614,    0.8030435325,    0.5221404515,    1.2247723587,    0.0304353249,    0.3975302482,
    3.2350006237,    0.0375452164,    2.7948110266,    0.1107646252,    0.0148434577,    4.4268429587,    10.4448047898,    0.0083572409,    1.3360359237,    2.7189721841,
    0.2650617438,    0.5606835475,    0.9847823375,    9.8704486153,    0.3251672190,    0.5563467849,    15.3877070393,    246.7151934766,    246.2977648310,    0.2375789358,
    -0.3837024708,    0.3912410543,    0.2317589663,    1.1511560301,    1.7168364170,    2.1734466353,    24.8657759089,    2.1525574556,    2.1934496501,    -2.1546781276,
    6.3023488835,    2.6990919549,    429.8682458517,    -1.3002606960,    100.3089225182,    8.7829182287,    4.9394516963,    1.5599861672,    23.0730991106,    9.8092955456,
    17.5863700890,    3.4389087066,    7.9506452811,    2.6651035876,    4.2635505975,    22.2149342926,    4.7345995106,    57.2235474616,    9.4120543149,    9.6192912871,
    10.4680519625,    11.7797702753,    9.0850427975,    11.5359675032,    8.1505877385,    -0.2447359843,    2.0155983108,    -0.0134450468,    0.4872146688,    0.1622801547,
    0.5931146314,    4.5313583649,    2.2632596495,    64.0084301734,    0.0528876138,    0.1859797929,    154.3640867502,    14.9977547711,    198.2011454124,    244.2020173455,
    161.7051292752,    116.9191717600,    100.2889348720,    188.1196932106,    191.9717450185,    854.0768367220,    4048.0969838675,    3261.3431802023,    4763.8944683203,    246.6038346668,
    8607.5394520078,    7.6464718140,    3.0362124331,    3.6130332229,    2.6987525817,    5.8417965080,    3.4375958534,    3.3550355280,    23.2769719911,    15.1556217734,
    11.4627382085,    76.0745368260,    217.5001760252,    145.8705896610,    130.5678063733,    7.9582073352,    7.8616144645,    5.7990956996,    5.1975112994,    4.5453887936,
    5.9892992320,    1.8340867515,    1.1227696169,    1.0257475486,    155.3651098788,    159.0596784355,    161.8503202559,    155.0604007703,    143.2249258007,    0.0756346680,
    -0.0105710379,    -0.0278433515,    -0.0121550618,    0.0080208113,    -20.4679082136,    -14.7144879488,    18.3601751117,    -2.0337432570,    -4.6432985378,    -4.2685991503,
    -2.5543944967,    -0.8885736731,    -0.2345453788,    62.7124766005,    -7.4098299018,    -7.7947844727,    -8.0276756668,    -5.0850677152,    -2.7426939941,    13.6536114968,
    -44.7285667613,    -13.7253185458,    -195.6988866835,    1522.3250679526,    16.3746251440,    -264.9119426965,    -224.6869835033,    -127.3456920648,    -0.1541697510,    0.6535175301,
    -0.2944477136,    -0.2663036857,    -0.1795104346,    -0.3695721715,    -0.4223562462,    -0.2523369121,    -0.6777688943,    -0.5641837808,    -0.2170473002,    -1.5547953681,
    -0.6158694070,    -0.4835739734,    -3.4428368009,    -9.0664246036,    0.0231980682,    0.0018230517,    -0.0004041298,    -0.0004011710,    -0.0002478485,    0.0008947909,
    -0.0002753806,    0.2853177886,    -0.3821348972,    -0.2054371631,    -0.1326701105,    0.1477122200,    -0.0544287027,    0.0320527601,    0.0454323663,    -0.2835330329,
    -0.0626844566,    -0.0658562440,    15.1101219722,    0.2175258073,    0.0081046170,    -0.0780287255,    -6.1194939636,    -4.8203799382,    0.0126354577,    -0.0026053885,
    -0.0025469660,    -0.0104660248,    -0.0142251148,    -0.0123582167,    -0.0090722429,    -0.0037538932,    0.0089756964,    1.4689803748,    -0.1510519284,    -0.0922026788,
    0.0340661790,    -0.5093779748,    0.0471647074,    -0.0210424522,    -0.0154369131,    -0.0063037758,    -0.0083356594,    -0.0968191121,    -0.0225686997,    0.0057568699,
    -0.1210949887,    -0.0525593842,    -0.0747633630,    -0.0282331115,    -0.0367260464,    0.0210804650,    0.1090350131,    -0.0703014280,    -0.0839278834,    -0.0686460483,
    -0.0777475572,    -0.0318370428,    -0.0545289167,    -0.0847119599,    -0.0333171217,    -0.0745860963,    -0.0820315723,    -0.1036951466,    -0.0003298337,    0.9212091092,
    1.0329897228,    0.6591062066,    1.0639711109,    1.0974879113,    1.0338738477,    1.0054362609,    0.8659901521,    0.7598205016,    0.6160207545,    0.8349195426,
    0.6380898053,    0.9465970725,    1.1134983557,    1.1553462778,    0.9682523307,    0.7812251967,    0.8259816226,    1.0305171752,    0.9306745730,    1.0296166441,
    1.0364545676,    1.0575137742,    0.6964857570,    0.7988720796,    0.7433940025,    1.1100258046,    0.9873131220,    0.9423304956,    0.7442853637,    1.0094272294,
    0.9930635574,    1.0206305622,    1.1200687681,    0.9316578957,    1.1533291085,    1.0256319345,    0.9272194039,    0.7644796948,    1.1153035514,    0.8723692953,
    0.7832836131,    0.4230172563,    -0.4003131486,    1.1103737422,    3.3733401590,    0.9911637808,    11.8655293550,    11.7796815231,    14.2132239038,    10.8777393944,
    1.0622265421,    0.2958895074,    0.1933023330,    0.0361731321,    0.0108519396,    1.0031183735,    4.4260945491,    0.8993389048,    2.0587501559,    2.2034426843,
    0.4060122240,    0.1415741549,    0.4430904864,    0.4396975373,    0.0064007074,    0.0215138227,    0.0722616514,    0.1197597762,    1.3587374460,    0.0818620372,
    0.3718473185,    0.0548699960,    0.7494453477,    0.1510383246,    0.0225523833,    2.7225061077,    3.9644113771,    5.8122909857,    1.3277642317,    1.7348054232,
    2.2375603513,    12.2333958623,    7.7978731158,    7.0354075355,    5.3720262719,    4.1019704467,    3.0495086587,    1.9763956743,    1.2715175742,    0.7538815001,
    0.4731902783,    0.3219133263,    0.2080726685,    0.1333537129,    0.0834167663,    0.0548979034,    0.0339224320,    10.1228319108,    5.8901972167,    4.6088523955,
    3.1375997763,    2.1095269477,    1.3796900015,    0.8125191470,    0.4648654149,    0.6260632249,    0.3605124044,    0.9971007191,    0.9937632531,    0.0432830236,
    3.3394782000,    -0.1108133966,    -0.3636796505,    0.1940881087,    2.5390628202,    0.0355722316,    0.7945936875,    0.1298572759,    0.5544221444,    0.0824419551,
    0.3240562726,    0.0791543976,    1.1589130424,    0.6700479926,    -0.1252806485,    7.4366209673,    1.8921577685,    -0.2997028123,    0.9302861869,    2.1755058188,
    0.8890761434,    7.8857511122,    0.2622343298,    0.5949419243,    0.2640835491,    0.4723377597,    0.8863646795,    0.5767138426,    0.0465669230,    -0.1083379285,
    0.5531675818,    -2.8866926021,    1.5314781266,    2.5894010651,    112.0875361191,    0.5503238742,    0.8283740154,    0.3149006569,    0.7684242568,    3.2583123722,
    1.3596722764,    0.7986179637,    28.6812460968,    35.1311602048,    35.7068456906,    35.7312527107,    58.8723109949,    40.6957095594,    32.7205190960,    28.6163459823,
    27.2474129765,    26.6210650031,    13.8279080186,    6.5269607617,    4.6391899971,    0.8727703630,    0.5530747162,    181.1715055507,    100.3089225182,    8.7829182287,
    4.9394516963,    3.3942153688,    1.5599861672,    1.3290441774,    23.3875363285,    23.0730991106,    9.8092955456,    5.2981374723,    2.4307541347,    2.0172609394,
    1.6150771033,    12.1923458672,    0.2010809867,    3.4389087066,    3.5176216093,    24.4407312397,    7.9506452811,    27.8207549016,    0.0000000000,    2.6651035876,
    4.2635505975,    22.2149342926,    6.0904159667,    3.7243785620,    0.4946925141,    0.1055016988,    0.5482418854,    2.4882038472,    4.6616381332,    0.2854789101,
    3.7183467731,    4.0020437868,    3.5244703111,    3.2356623139,    6.4158191843,    0.0003742048,    0.0106024698,    0.2387691927,    0.0902371534,    0.0062625336,
    0.4658124240,    6.2023248046,    0.1183303460,    0.2519546931,    0.1770519299,    0.0151967344,    1.3743011864,    0.6272673770,    0.4136210553,    0.3183350510,
    0.5699877853,    0.1730275527,    0.0128642931,    0.0532959827,    0.0744528840,    0.4069695449,    0.0350878588,    0.0202143971,    0.6560226454,    -0.0961138815,
    0.0692574087,    0.0598980672,    0.1961329077,    0.1475387477,    0.0748558556,    0.0357503506,    0.0219204720,    0.9451748793,    0.2366177266,    0.0105788584,
    0.4001254115,    0.1629394202,    0.0388728051,    2.2956520101,    0.0945286668,    0.0606378428,    0.4946417808,    0.0505475014,    0.3272699264,    1.0259658226,
    1.0213896719,    5.2076064244,    0.0569181010,    1.3651122099,    9.1898696503,    2.2417315647,    1.0916729703,    2.4581100243,    874.9900616453,    1.2314850275,
    2.3567786949,    0.0119745541,    1.8094325161,    168.6187432063,    8.5353665422,    1.2927440348,    1.0130380278,    1.2134821702,    1.4789793753,    1.2868282028,
    0.3664436172,    0.4599822738,    17.0920920459,    9.4720029846,    9.4214242188,    22.5589878506,    203.8147923337,    71.8905734046,    0.1499573739,    2.1859884987,
    1.8094325161,    1.2927440348,    8.5353665422,    1.0130380278,    1.2868282028,    0.3664436172,    1.2134821702,    1.4789793753,    168.6187432063,    4.0573409869,
    2.4005867948,    91.9311202387,    1.4898989371,    1.9987079671,    0.3018350023,    1.5443294631,    2.1927854319,    35157.5474053523,    2.7516837446,    19.0750520332,
    2.2234492961,    2.5695992371,    0.6986451723,    2.1953274119,    2.6774472279,    376.7409377491,    13.8917673108,    1.6309059164,    1.9980223280,    0.5705895666,
    1.6781335709,    1.9351769643,    262.7572462761,    10.8257824027,    12.5750213703,    3.5571251223,    10.5620351651,    12.6669046635,    1781.9047159113,    1.5162252618,
    0.5084830341,    1.2358105432,    1.4959558024,    205.5967706691,    0.5322176404,    1.6159019214,    1.9220040698,    241.3369540013,    0.4655237167,    0.5436076961,
    64.4213721738,    1.8020374848,    206.2448088005,    249.9288165641,    5.0344692804,    64.0084301734,    205.0526778332,    0.2825640084,    228.0837140757,    57.8238789604,
    42.1546858016,    1.2576756019,    1.6779124097,    1.2997053639,    2.4681609771,    0.0000000000,    0.0000000000,    0.0000000000,    -2.7603433056,    9.6411098191,
    2.4005867948,    -2.8139211027,    9.6411098191,    91.9311202387
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.4257960081,    0.1097332889,    0.1509150487,    1.0542742642,    0.4092077129,    0.5495799581,    0.2398588321,    0.1201204579,    0.3701754288,    1.6540169445,
    4.1002698451,    0.3734242826,    0.2089391013,    0.6734804686,    0.0964414857,    1.7615070365,    0.9174700471,    1.1870659772,    0.1857374853,    1.1660273134,
    3.3341467749,    0.2430777690,    2.4330236043,    0.5599454050,    0.1727448751,    22.4421347675,    66.4924588072,    0.1710054590,    6.1469745524,    7.4157850947,
    0.6112887347,    1.2356562561,    2.0731340828,    2.8936169391,    0.4527822348,    0.1741451944,    9.8950598188,    122.3866920214,    122.1288269544,    0.1240287646,
    0.1179396623,    0.1162892160,    0.1125134323,    0.3400898767,    0.4282714585,    0.5189339088,    16.6633162738,    0.2345397555,    0.2361819726,    0.2663589492,
    1.3500552835,    0.7147413808,    336.7711789743,    1.0881190481,    49.3016565067,    8.8797043612,    6.2259517061,    4.8344491452,    19.4360203168,    10.2435651615,
    17.2962515732,    5.6618741470,    10.2475230234,    5.2054578612,    5.5030447609,    20.1194040120,    8.0389269850,    42.9924139380,    10.5174976817,    10.4481702834,
    12.9546654172,    19.0657519477,    12.8502639470,    15.7146001366,    11.7230817011,    2.1419301159,    5.4231573186,    1.9025061206,    1.1082677434,    0.5926531950,
    1.6593647344,    3.9249508599,    2.3688113876,    32.2294511041,    0.2435588216,    0.6710113424,    5860.4739542822,    10.7813260475,    123.8411192059,    251.3247461671,
    231.9524972124,    71.4675837001,    51.2016130951,    111.9950404287,    215.5084088172,    453.0753933348,    4172.7063499482,    1759.7838224505,    4882.2686356708,    132.6236503276,
    5503.9683727966,    3.7589041115,    0.6856257261,    0.8069201370,    0.7189793028,    3.9730861144,    2.2983002241,    3.5436837717,    29.4280395501,    16.0701500357,
    26.0627152281,    151.5938069849,    54.4136849347,    61.7321712761,    67.7334525659,    0.6789192757,    0.8262433328,    3.3554467828,    2.2889897332,    2.6730802070,
    1.3213132420,    0.4511887712,    0.4649910882,    0.5038220204,    10.1902652118,    14.2176494498,    20.9934856970,    44.3939947941,    60.5974058891,    0.2541456758,
    0.2912677986,    0.3089767108,    0.2733163194,    0.1939296318,    50.3636513833,    50.2094688841,    11.5757929233,    4.5767383854,    6.6197871738,    6.7789999497,
    6.9115460077,    5.7406109446,    5.1371587657,    48.4969452566,    10.2911107019,    28.2251873016,    27.7045081384,    26.8923390102,    25.3510250340,    46.0189076988,
    165.7450332018,    164.9046176761,    822.3946816301,    911.2137804553,    479.3784681523,    516.3535254912,    626.5489536510,    505.9584840596,    0.4986167401,    1.1734343781,
    0.9945979116,    1.1452349106,    0.6289551270,    1.4552984427,    1.7332661137,    0.7628955265,    1.9704350233,    1.9249768370,    1.1600571920,    2.8861006488,
    2.8426132421,    3.1909178083,    9.1678242728,    16.6811488376,    0.0150509741,    0.0062719608,    0.0058250617,    0.0067067627,    0.0078213729,    0.0108461603,
    0.0127349376,    0.7214035531,    0.8162542794,    1.6022187901,    1.8865738816,    0.1458672400,    0.0902385901,    0.1613233958,    0.1567987501,    0.4394566169,
    1.2570659887,    1.2886371151,    29.1348977094,    3.3134923412,    9.3656884007,    10.6182755017,    51.2876344310,    50.5951169837,    0.0246803139,    0.0465832615,
    0.0458498493,    0.0303535078,    0.0453777938,    0.0527740252,    0.0757441401,    0.1071075082,    0.1043008630,    0.6189362316,    0.2795832736,    0.2733972976,
    0.3667706046,    0.2148156179,    0.2024539420,    0.1707094801,    0.1821000909,    0.2119231630,    0.3203864748,    0.1740263939,    0.4215171915,    0.2397700938,
    0.1266856657,    0.1529325992,    0.2534455190,    0.3267513197,    0.3688339927,    0.0998779115,    0.1927636937,    0.1594517926,    0.2053457795,    0.1711335188,
    0.2872654087,    0.3786725009,    0.1431103645,    0.2092200028,    0.1463983409,    0.1823480008,    0.2211415316,    0.1694359838,    0.1899407432,    0.3096198389,
    0.3447708767,    0.6744153329,    0.2608427262,    0.3248792488,    0.3062189480,    0.3379005683,    0.4121706339,    0.4624546019,    0.4813225426,    0.2997781732,
    0.2577950099,    0.3008972625,    0.4302509886,    0.5883238167,    0.8977753899,    0.8915839407,    0.2465938083,    0.4097316291,    0.7209562704,    0.2357545461,
    0.2778849750,    0.2058211333,    0.5678685296,    0.2414352015,    0.3014434803,    0.5446600594,    0.6764615491,    0.8303657093,    0.2758693929,    0.2823076980,
    0.6459673255,    0.2985644694,    0.3828084594,    0.7947592390,    0.3580063074,    0.2538633851,    0.3862816534,    0.5958735100,    0.2202207745,    0.3302881970,
    0.4067682857,    0.0796197348,    0.0851391362,    0.6455582376,    0.4770184313,    0.1129061693,    7.1692050325,    1.5266243652,    1.0177820609,    0.2796187278,
    0.7589411440,    0.1402089117,    0.0912806185,    0.2141058411,    0.1273676266,    1.1551103455,    4.4625373800,    1.3996634646,    2.1625744005,    4.0242681710,
    0.9908795897,    0.4835207938,    0.3466909483,    0.3440378572,    0.0472652351,    0.0753877834,    0.1258788704,    0.2359270057,    1.0129231200,    0.1779162571,
    0.5017650526,    0.2020020935,    0.7578909277,    0.2881715231,    0.0999334271,    2.2152445116,    3.7469956272,    6.4634650399,    1.4363803450,    2.2677545421,
    3.5555652780,    5.9468576907,    4.0128367414,    3.8242912737,    3.3682147210,    2.9555198131,    2.5235347516,    1.9130490297,    1.4897848524,    0.0439181926,
    0.0465982071,    0.0536971839,    0.0515071746,    0.0442359004,    0.0344002419,    0.0270464322,    0.0199825930,    5.0737232217,    3.2294208668,    2.8295559747,
    2.2596029707,    1.8068215168,    1.3899544788,    1.0060225985,    0.7013142845,    0.1026225568,    0.1234903361,    0.0508623278,    1.2170921205,    0.2342668922,
    5.9182241090,    0.7923339483,    1.3666136094,    1.1097935141,    6.6004738582,    0.4337091754,    1.8935188434,    0.5778106000,    1.3906630801,    0.3410442788,
    1.3012082382,    0.3723704720,    3.5577399801,    2.5680695030,    0.4828991987,    5.2658768876,    2.4613601764,    1.0449524880,    2.1126812741,    4.5407904203,
    3.0831269618,    3.9786343338,    0.1205505210,    0.0634829486,    0.0865048147,    0.0144458734,    0.1056557842,    0.1089392974,    0.0567738878,    0.2782468325,
    0.1103378983,    2.3968759320,    0.2821667493,    0.5651418030,    72.3471908735,    0.1344476294,    0.1227292068,    0.0854943159,    0.1072373951,    0.8259528192,
    0.7084481514,    0.5925499185,    9.4388833744,    11.4483057713,    11.9340651806,    12.1419292589,    29.0941962834,    20.5898987378,    16.5533108877,    13.1714995846,
    11.7669700810,    11.1758045993,    7.0528529782,    4.3853322627,    4.1157919426,    0.3332300354,    0.4971750944,    89.9905017660,    49.3016565067,    8.8797043612,
    6.2259517061,    5.3266059452,    4.8344491452,    4.5574486686,    26.5481243039,    19.4360203168,    10.2435651615,    8.1941612828,    4.8992757526,    4.2790666428,
    3.6849855708,    10.9852018593,    1.1856922413,    5.6618741470,    6.8535915153,    31.1795270310,    10.2475230234,    25.0080372468,    1.0000000000,    5.2054578612,
    5.5030447609,    20.1194040120,    7.7547101372,    5.3734247313,    0.9847938289,    0.3446739704,    0.2780174466,    3.0962045736,    4.0646934392,    0.2055895189,
    1.0002811070,    2.2638930004,    2.8594202560,    3.0222298450,    1.7452555661,    0.0193407545,    0.1024209812,    0.0991175682,    0.0315508526,    0.0070312745,
    0.6273233826,    4.5937602514,    0.2832930973,    0.1794600687,    0.1764629745,    0.1136911746,    0.7389965538,    0.4245261931,    0.7570246127,    0.7376562334,
    1.1901345332,    0.6296349161,    0.2455251739,    0.3627782836,    0.3911283929,    1.5549359470,    0.2038179911,    0.1384978709,    2.0874026964,    0.4143004110,
    0.5205198706,    0.6023221401,    0.4868403261,    0.4283701393,    0.3362948105,    0.1990006184,    0.2476112968,    0.9596933436,    0.7982289815,    0.1508123382,
    1.0968139098,    1.1142330158,    0.3982479927,    2.1608871478,    0.4317252584,    0.1758215529,    1.3267436924,    0.3483278170,    0.4473023865,    0.8165097719,
    0.8218036144,    24.9754474577,    0.0250449466,    0.3484384491,    1.1410387988,    0.3055643920,    0.7966250531,    0.4171165067,    2246.1379242381,    1.3469732475,
    0.1734518070,    0.1247926772,    0.8850395227,    82.0077243001,    4.3679100528,    0.8540489772,    0.6809206205,    0.2679374662,    0.0735216920,    0.5854751433,
    0.4093336997,    0.1218880698,    1.5339481119,    4.9748351176,    4.5124864285,    4.0440066085,    140.0912242939,    26.6512693312,    2.5285001792,    2.2051222421,
    0.8850395227,    0.8540489772,    4.3679100528,    0.6809206205,    0.5854751433,    0.4093336997,    0.2679374662,    0.0735216920,    82.0077243001,    5.2799248819,
    3.0648938032,    119.0620793993,    2.6565030364,    2.3027841876,    0.6902977214,    0.7804643528,    0.2233850983,    41824.0567131714,    3.2451419529,    24.4342907838,
    3.1356249504,    2.4606357024,    1.1543506259,    1.1191341980,    1.3012598559,    466.5513914348,    17.1079039686,    2.4295227404,    1.9599803998,    1.0152154070,
    1.2683851691,    1.2922393704,    305.3733803155,    15.7564421010,    12.4353861617,    6.0562746163,    5.9659384988,    6.4916562014,    2180.1633404618,    1.8363141250,
    1.0917785098,    0.8901519127,    1.0093860380,    282.1605557569,    0.7672671123,    0.8624630019,    0.9202497043,    217.5414051385,    0.5475215467,    0.6111260510,
    104.7605286070,    0.4445629073,    109.1772752994,    121.5379750321,    3.7784442242,    32.2294511041,    101.7550214566,    0.0362172873,    118.4928878631,    28.4689255521,
    20.5019310750,    0.2784925436,    0.3654674769,    0.2830898903,    0.5346193579,    1.0000000000,    1.0000000000,    1.0000000000,    2.2270149398,    13.3975134126,
    3.0648938032,    2.0710646906,    13.3975134126,    119.0620793993
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 502;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    0,    1,    13,    15,    16,    17,    19,    22,    49,    66,    67,    70,    71,    75,    77,    78,    83,    86,    90,    97,
    111,    112,    122,    128,    154,    158,    159,    186,    216,    218,    223,    226,    232,    291,    293,    295,    296,    297,    299,    302,
    303,    304,    305,    306,    307,    308,    309,    311,    313,    314,    315,    318,    319,    332,    337,    338,    344,    346,    349,    350,
    353,    355,    358,    361,    362,    366,    368,    374,    378,    379,    380,    381,    382,    384,    389,    391,    393,    395,    402,    414,
    418,    419,    421,    422,    496,    511,    522,    531,    544,    547,    549,    553,    562,    563,    567,    571,    579,    580,    583,    597,
    635,    642,    651,    652,    654,    660,    663,    666,    672,    675,    677,    682,    689,    692,    693,    696,    699,    704,    712,    713,
    719,    724,    728,    729,    734,    735,    736,    738,    739,    743,    744,    745,    746,    749,    755,    756,    759,    761,    762,    763,
    764,    766,    767,    768,    769,    772,    773,    775,    776,    778,    780,    785,    791,    795,    797,    798,    799,    800,    805,    806,
    807,    811,    814,    816,    820,    823,    826,    827,    832,    834,    836,    838,    841,    843,    849,    851,    852,    853,    854,    855,
    856,    860,    861,    864,    865,    868,    869,    874,    875,    877,    882,    884,    885,    886,    887,    893,    898,    900,    914,    918,
    920,    931,    934,    935,    937,    945,    947,    948,    951,    952,    954,    957,    958,    959,    960,    961,    963,    967,    971,    978,
    981,    983,    985,    986,    994,    997,    1014,    1015,    1016,    1023,    1025,    1026,    1029,    1032,    1037,    1040,    1045,    1047,    1049,    1054,
    1056,    1060,    1063,    1064,    1069,    1072,    1073,    1074,    1075,    1077,    1078,    1079,    1080,    1081,    1083,    1084,    1085,    1089,    1091,    1095,
    1101,    1103,    1108,    1109,    1110,    1113,    1114,    1115,    1118,    1119,    1122,    1127,    1128,    1131,    1133,    1134,    1137,    1139,    1142,    1145,
    1146,    1149,    1150,    1152,    1153,    1154,    1157,    1160,    1171,    1172,    1245,    1288,    1289,    1290,    1291,    1292,    1293,    1294,    1295,    1296,
    1297,    1298,    1299,    1300,    1307,    1308,    1309,    1310,    1311,    1312,    1313,    1314,    1315,    1317,    1318,    1319,    1320,    1321,    1322,    1323,
    1324,    1325,    1326,    1327,    1328,    1329,    1330,    1331,    1332,    1333,    1334,    1335,    1336,    1337,    1338,    1339,    1340,    1341,    1342,    1343,
    1344,    1345,    1346,    1347,    1348,    1349,    1350,    1370,    1414,    1480,    1535,    1545,    1552,    1579,    1597,    1610,    1621,    1625,    1629,    1632,
    1681,    1687,    1696,    1700,    1714,    1736,    1737,    1754,    1755,    1800,    1802,    1804,    1807,    1812,    1820,    1824,    1836,    1838,    1843,    1845,
    1846,    1853,    1854,    1855,    1862,    1867,    1870,    1872,    1875,    1878,    1880,    1883,    1885,    1887,    1888,    1889,    1890,    1891,    1892,    1893,
    1894,    1895,    1896,    1897,    1898,    1899,    1900,    1901,    1902,    1903,    1904,    1905,    1906,    1907,    1908,    1909,    1910,    1912,    1913,    1914,
    1915,    1916,    1917,    1918,    1919,    1920,    1921,    1922,    1923,    1924,    1925,    1926,    1960,    1963,    1966,    1973,    1978,    1981,    1983,    1984,
    1999,    2003,    2005,    2006,    2007,    2017,    2125,    2164,    2165,    2171,    2252,    2254,    2268,    2271,    2272,    2273,    2274,    2275,    2297,    2298,
    2306,    2310,    2319,    2362,    2378,    2409,    2415,    2471,    2512,    2519,    2525,    2618,    3038,    3042,    3073,    3078,    3117,    3135,    3139,    3152,
    3242,    3272,    3329,    3399,    3467,    3567,    3615,    3616,    3765,    3766,    3767,    3782,    3787,    3812,    3829,    3833,    3835,    3841,    3849,    3850,
    3868,    4079
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 18;
constexpr int N_PHYSICS_FEATURES = 74;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
    "dD",
    "dH",
    "dP",
    "HansenTotal",
    "BP",
    "deltaHvap",
    "logVP",
    "logPow",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
    "logws_logpow_logvp_est",
    "logws_logpow_sq",
    "logws_logvp_sq",
    "logws_logpow_e_est",
    "logws_logpow_sq",
    "logws_e_sq",
    "logws_logpow_l_est",
    "logws_logpow_sq",
    "logws_l_sq",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/logws_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/logws_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadelogWS
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadelogWS {
struct Model {
    using Namespace = CascadelogWS;
};
} // namespace CascadelogWS
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
