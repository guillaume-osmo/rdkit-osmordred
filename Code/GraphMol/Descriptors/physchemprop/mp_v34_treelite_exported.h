#pragma once
// Auto-generated Treelite model for MP (v3.4 XGBoost)
// Trees: 300, Features: 607
// Target normalization: mean=128.5173705173, scale=78.5751862359
// Library: mp_v34_treelite.so

#include <vector>
#include <cmath>
#include <algorithm>
#include <dlfcn.h>  // For loading shared library
#include <limits>

namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadeMP {

constexpr int N_TREES = 300;
constexpr int N_FEATURES = 607;
constexpr double TARGET_MEAN = 128.5173705173;
constexpr double TARGET_SCALE = 78.5751862359;

// Normalization stats
constexpr int N_NORM_FEATURES = 607;
static const double COL_MEANS[N_NORM_FEATURES] = {
    0.0108218777,    0.3272355021,    0.0863888963,    0.0587093515,    0.0382887075,    0.0695046398,    0.0210587891,    0.0329974208,    0.0864952538,    0.0832247600,
    0.0244356404,    1.0057167167,    1.6655587758,    0.0787311548,    0.1363769311,    0.0454146614,    0.4220000532,    0.3890824005,    0.3354250312,    1.0908825015,
    0.2154537478,    0.0978223298,    0.1641362440,    4.0004786088,    3.0782525459,    0.1553085698,    0.2100561036,    0.3752027440,    0.9438964078,    1.5739583610,
    0.1996862453,    0.2215161265,    0.5449759366,    10.1051279804,    0.2905248720,    -0.8324178766,    0.6460098408,    13.7335703379,    233.5124891648,    233.1178496574,
    82.6177776596,    0.2480320181,    -0.3939751579,    0.2434646021,    1.2529186911,    29.4452610542,    10.1592152637,    2.2105137368,    -2.1154414844,    6.6574132204,
    0.1864727745,    2.3490578655,    445.7931572512,    3.5646078781,    2.3644646186,    1.5668579080,    1.9205173297,    11.1062007427,    3.3468595307,    94.2531105463,
    2.6102915718,    4.3216514201,    4.0796529065,    17.9626468873,    22.8223835538,    10.4070658169,    4.3228633503,    2.2159953520,    6.8904054849,    4.3193396128,
    18.5732465973,    3.2189569783,    52.9194046638,    7.9420009091,    8.8484778797,    10.1237482096,    11.0775340346,    8.3576946034,    9.1333805533,    11.3901884429,
    6.9600371599,    2.0031816682,    1.1979845250,    3.5530325188,    0.9967295062,    2.1952882273,    59.9731319790,    0.1081390093,    0.0315881837,    1.2349153775,
    143.1211782108,    99.0490998503,    189.9783953529,    1159.6300087745,    549.6530617671,    10501.3676105807,    77.4042434773,    10005.2348178102,    7.4852166943,    4.8514946387,
    3.5833521532,    3.1138306235,    1.6382148316,    3.2751315767,    3.5027633715,    2.4985746663,    6.2777431807,    4.0569966604,    3.6591982706,    3.8759353438,
    30.0428753497,    10.8861225681,    172.9898647818,    63.9799431779,    50.0902417066,    202.2864491947,    7.9218398902,    7.8529378890,    6.6423705332,    6.3265832880,
    6.4854810731,    6.0580296681,    1.8978114520,    1.4778577846,    1.3013008379,    154.2629151885,    158.2199076291,    162.6230155506,    163.7919272371,    133.6394799736,
    -0.3303081300,    0.0505480304,    -0.0140177606,    -0.0176118657,    -0.0100440605,    14.8282879346,    -21.3365252398,    -24.5991821845,    -19.2148057561,    -12.9915816030,
    4.9857434738,    -1.6709352765,    -4.9140630556,    -4.5397180497,    -2.4698683655,    -6.3631357555,    16.9182735600,    -5.4203508081,    -8.6917196935,    -8.9361676840,
    -1.9336697093,    -4.6619743896,    11.6881787429,    -58.7588821964,    -53.6436284104,    -36.2600254493,    -30.0958090230,    -14.7854148761,    -288.1951126137,    -141.2978357406,
    -72.8989570223,    21.4564836311,    -271.1925933564,    -267.7953263619,    -99.5718722527,    -91.8325577646,    -0.3681508020,    -0.6128205669,    4.1137046055,    -0.5356329801,
    0.1533917053,    -1.4338693529,    -0.5522581331,    -0.4753421547,    0.3972212763,    -7.9636977704,    -1.5985188565,    -0.0003419526,    0.0002309452,    0.2872316746,
    -0.4785678021,    -0.4244229552,    0.1596447422,    0.0755058629,    -0.2584866425,    -0.2493491169,    -0.1139702079,    0.3157432031,    -1.0975229490,    83.7772835264,
    1.3580562901,    -5.2961799660,    -5.3468504074,    -1.0910003866,    0.0142125837,    -0.0039536817,    -0.0114827497,    0.2921223362,    -0.0156551820,    0.0152255603,
    -0.1555340098,    0.1046985051,    -0.4991103920,    -0.0181181714,    -0.0078473888,    -0.0066740788,    0.2213168117,    0.0534418365,    -0.0975449719,    -0.0813814151,
    -0.1351986841,    0.1164692869,    -0.0526270935,    -0.0725773238,    0.0268586555,    0.0476613097,    -0.0927586611,    -0.0379399416,    0.0145427628,    -0.0783067809,
    -0.0282813286,    0.1134320273,    -0.0796758793,    -0.0370421321,    -0.0199060542,    0.0257884908,    0.0691846683,    -0.0175467371,    -0.0883849461,    -0.0185899957,
    0.0109477898,    1.4819376914,    0.9986643648,    1.0064035021,    0.9220221054,    0.8678241338,    1.0678754155,    1.1135046735,    1.1077157366,    1.0512996508,
    0.9554546672,    0.7980605272,    1.2037789225,    0.9190940584,    0.8013825546,    0.7738853778,    0.5984201612,    0.9145091997,    1.1005182256,    0.9673540087,
    1.0706415132,    1.0342841731,    0.9071083207,    0.7356385224,    0.7906894818,    1.0140450413,    1.0690691946,    1.0730572122,    0.9245863781,    1.0585890883,
    1.0038699488,    0.7127631941,    0.7545005280,    0.7161115526,    1.1085340920,    1.1418768243,    1.0779171118,    0.7082367199,    1.1041644474,    0.7595156694,
    1.0005365622,    1.1098040106,    1.1460567070,    0.9508524079,    1.1038134279,    0.9196214906,    0.8480186259,    0.5934427909,    0.4299185951,    1.0865941307,
    3.3763656605,    0.9876160968,    1.1066979841,    13.8802913929,    11.7293544686,    3.5571981901,    0.7690940828,    10.8038576321,    2.1276751627,    1.2866151306,
    74.0852748362,    4.4371277149,    4.5368024096,    92.8856726876,    46.8853344783,    69.7246760852,    93.6615162355,    5.4014838526,    46.8856095190,    0.9099757012,
    3.8279367818,    0.2611331419,    1.7100425832,    73.5279243487,    4.4020478414,    4.5288221758,    92.5204620384,    46.7229167568,    69.4886179505,    93.3320533825,
    5.3826894205,    46.7231957971,    0.9535587846,    3.8279981360,    0.2611365651,    1.7100573971,    73.5203349452,    4.4016283293,    4.5287290449,    91.8471640565,
    69.0199209838,    92.7102401071,    5.3487071623,    46.4153198387,    1.0162287700,    3.8277974128,    0.2611200888,    1.7099995783,    73.5241624496,    4.4020191551,
    4.5288317187,    129.5431403465,    63.0707240060,    3.8097401318,    0.8134529303,    23.4324762690,    0.1992354167,    0.2360339280,    0.3029044956,    0.0707141892,
    0.3350930097,    1.4583056230,    0.7392214774,    0.4600306871,    0.0553234113,    0.0360723908,    0.0344995617,    12.3289515230,    0.0059294318,    0.0735196363,
    0.8430162993,    2.4739557021,    0.2945305645,    0.0000265894,    0.0038022814,    0.2633944003,    0.0691855673,    0.0614214683,    0.0000000000,    0.0622457391,
    0.4220000532,    0.1612114122,    0.0775612220,    0.1276556143,    0.0000531788,    0.4185168444,    0.2336940626,    0.2461889774,    -0.3539371889,    1.1713452072,
    1.1921963898,    12.2708685386,    0.4377252453,    0.1017023468,    0.1095729235,    2.6917439558,    1.4258912792,    -0.2265936667,    0.5940821727,    1.1120653094,
    0.4993349064,    1.1802002082,    0.3788169035,    -0.0400155119,    1.9147913712,    1.1117746285,    2.3267997488,    1.2710125611,    -0.0703700642,    1.5207544317,
    1.5585361359,    0.1178110381,    1.0976696872,    0.4831336455,    0.2318091362,    0.2862993049,    19.1587385998,    0.2412434849,    0.0283324779,    0.4367721616,
    0.8376840979,    0.0444844123,    0.0684942434,    49.1333260656,    0.3528234098,    -2.8869191542,    1.6347712651,    2.8362786794,    4.0486476648,    4.0669174172,
    43.9463996809,    77.3797834813,    0.7758111040,    0.8710005881,    0.7988060672,    0.8194491451,    3.0439148438,    32.4487935594,    38.3173181483,    38.3596938277,
    53.8553426886,    29.6968759337,    26.9207866595,    26.1448158177,    5.5622314592,    3.5011469045,    1.2796042197,    0.2012011188,    0.0524740965,    0.0816316071,
    0.1854547690,    1.9752440851,    8.4370719681,    22.5370400618,    2.9314862866,    0.1975960252,    33.8466058656,    4.7292636541,    4.6979604072,    3.6180995990,
    0.2870589487,    0.1567638249,    58.3837054960,    0.0545974278,    0.0458016439,    0.0293758100,    0.0165831350,    0.0103705514,    0.0062438227,    0.0035196553,
    0.0019082814,    11.0119394344,    52.7454842257,    3.6500335263,    0.9427492629,    0.0229150951,    0.0892171231,    0.1376378881,    5.9178319307,    4.9739468149,
    0.2909226841,    0.6938048180,    0.0160208759,    0.2243706031,    0.1891952298,    1.4396304731,    0.7584620944,    0.3761291356,    0.2253608620,    0.0337181091,
    0.0872919721,    0.0587831725,    0.0424215943,    0.4322444899,    0.0848503707,    0.1917967712,    0.0603193034,    0.0091340569,    0.0966258077,    0.1653762980,
    0.1119665152,    0.0758226242,    0.3894360088,    0.0853208591,    0.0343861682,    0.2869883618,    0.1581954793,    0.2701653154,    1.1453208753,    0.3923299383,
    0.0774076889,    0.3092900635,    0.9184855753,    1.6766845702,    1.3721049749,    8.1416508017,    0.5798608793,    1.0993902126,    1.0762618184,    2.2277470080,
    0.5411342578,    1.1609136092,    0.0078172778,    1.6525565897,    158.5995115887,    8.2473864345,    1.4093349939,    0.9222027671,    1.2769558132,    1.4590844035,
    1.2285226852,    0.3601153561,    0.4552584818,    16.5492792538,    9.9258703785,    10.6127502824,    22.7958722978,    133.7570576070,    60.8093574206,    1.2357940586,
    2.0310310894,    -1.7087825852,    -341.4190908444,    -5859.9107678186,    1.6525565897,    1.4093349939,    8.2473864345,    0.9222027671,    1.2285226852,    0.3601153561,
    1.2769558132,    1.4590844035,    158.5995115887,    3.0792786451,    2.3912389159,    76.6647786258,    1.0368079260,    1.6467220384,    0.2336695119,    1.6829007440,
    2.1306856597,    28385.8702656347,    2.5438987445,    15.2447105711,    1.6717670048,    2.1414732122,    0.5952781425,    2.0975588704,    2.4118198768,    295.1177164443,
    13.1158137597,    1.4305083739,    1.8880791116,    0.5180902299,    1.8426370168,    2.0635804021,    248.1357903779,    8.4398598478,    10.8631984603,    3.0534913181,
    10.5706281553,    12.0483591369,    1468.1492527969,    1.2251851936,    0.3773115389,    1.1688013928,    1.3452661755,    159.7723487522,    0.4598868688,    1.5845057461,
    1.7978881072,    206.3542426150,    0.4668257109,    0.5259611936,    56.5544112419,    1.8647717546,    202.1310428877,    231.5921378746,    4.9725676107,    59.9731319790,
    184.7421870477,    0.2730934069,    220.0700733154,    50.4146419734,    39.6498778972,    1.2627763944,    1.7098141313,    1.3244163312,    2.5047671073,    91.9159098311,
    15.3251021272,    -28.8142035374,    -14.4481616838,    34.1322154944,    133.7570576070,    0.3579126463,    0.8948124119,    8.2823260390,    -134.1241500318,    23950.6821938574,
    28385.8702656347,    125.2094622819,    76.6647786258,    28385.8702656347,    0.0000000000,    0.0000000000,    0.0000000000
};

static const double COL_STDS[N_NORM_FEATURES] = {
    0.1599838042,    0.5941768681,    0.3712787651,    0.2475313383,    0.2621639537,    0.2680538706,    0.1477783070,    0.1985114512,    0.4639015308,    0.3404652344,
    0.1702847017,    1.2603768640,    2.6691165197,    0.3011971051,    0.4997678932,    0.2303993990,    0.7431328691,    0.9771996867,    0.6945316779,    0.9936296817,
    0.6746370590,    0.4372116455,    0.4395974873,    3.1214694918,    1.8029190877,    0.4929733776,    0.6228594236,    0.7093596408,    1.4662902908,    4.4620365153,
    0.8437496899,    0.4527605698,    1.1326469094,    2.7325546146,    0.3710077810,    1.5233305578,    0.1614084161,    7.2546118547,    82.8106949134,    82.6266309883,
    29.8435471918,    0.1093099502,    0.1042826154,    0.1021064123,    0.2931112590,    20.7058342106,    0.2317750227,    0.1609240161,    0.2187867247,    1.4359688141,
    0.4546469247,    0.3827987369,    244.0846202164,    1.7738674403,    1.4328449084,    1.1641485647,    1.3372209111,    4.2273201143,    60.5451683597,    32.9663215587,
    4.6675870012,    5.1874118301,    4.9325871095,    20.2952850406,    15.8087392570,    8.8727911754,    5.2633821392,    5.4445065646,    9.1080365447,    4.7489367743,
    13.1798320576,    6.0177463203,    28.0822105625,    8.0090134371,    8.9017406044,    13.9240421406,    14.4271164506,    8.4936749949,    17.0217348273,    9.7685180061,
    7.1533195435,    2.8414527889,    1.1464095075,    1.9183004290,    0.8961111401,    1.6078049366,    22.0154772421,    0.3174990115,    0.1761130331,    0.0737228336,
    184.9183070415,    159.4566881757,    164.1139852230,    802.1421113359,    697.0249814032,    6951.8284818825,    35.7960562431,    6918.9033309215,    2.6507940227,    2.9282881490,
    3.1410909941,    3.5904245047,    3.1261558959,    0.5301370470,    0.5761197069,    0.5393810499,    3.9073600223,    2.1919557419,    2.1761474048,    2.7347233697,
    9.6677236025,    19.1423307580,    230.2187310715,    87.5696672504,    88.8487522554,    41.8864660507,    0.3334218798,    1.0851142852,    0.3535589089,    1.0037992633,
    0.3668480541,    1.4346541496,    0.2587736900,    0.3374091867,    0.3635445869,    7.9675170568,    9.3836295379,    12.8812585640,    20.1269517760,    72.3936949707,
    0.2242135687,    0.1963395362,    0.2158804447,    0.2457528937,    0.1810837839,    29.8756409934,    36.0820335718,    39.6687629123,    45.6852401220,    44.4040838177,
    4.6840406286,    3.9426867553,    5.1878337508,    5.6450651406,    5.7695516657,    7.4389224445,    26.8766540712,    21.8514744793,    31.0833823911,    28.6979950198,
    30.2575581217,    25.7059449527,    36.0174982160,    139.6658992319,    186.9127039464,    143.5045781891,    149.0541906839,    131.3042818968,    734.6920396493,    718.0834060316,
    670.5602171077,    82.7523756021,    394.1603134008,    493.9252900294,    477.3534766012,    460.7169595025,    0.9801379429,    1.9271227147,    2.5577248624,    1.6035047819,
    2.0483682632,    2.7989710477,    2.6165499386,    2.5657053793,    17.6847193542,    18.2967764646,    15.2761030309,    0.0070263044,    0.0101772846,    0.6403558532,
    0.7100349534,    1.1845476753,    0.1223764374,    0.1916178631,    0.3390881499,    0.9742160029,    1.5282711572,    2.0900888474,    13.5896571150,    147.1820491713,
    10.8093923247,    6.7064261006,    8.3607910651,    16.7689186389,    0.0267158177,    0.0578573267,    0.0291530186,    0.1624500113,    0.1196689062,    0.1362043952,
    0.3707268667,    0.5782785481,    0.1933577565,    0.1579842543,    0.1781537884,    0.3333986268,    0.1570272365,    0.1472399672,    0.2629511123,    0.1324171348,
    0.1619327138,    0.1600658249,    0.1329320415,    0.1735238794,    0.0875181156,    0.1277333919,    0.1762470022,    0.4780572211,    0.0688574745,    0.1435598943,
    0.1070164367,    0.1657661306,    0.1510375097,    0.1188015190,    0.3287674407,    0.3845325850,    0.4007027458,    0.1746657943,    0.1611392577,    0.1963884303,
    0.2527779881,    0.2478559444,    0.2592230560,    0.2690468105,    0.4881303247,    0.2384476213,    0.2154569595,    0.2447417886,    0.3790886909,    0.5348177632,
    0.6867450775,    0.7724334354,    0.2324843841,    0.3341300829,    0.4308300430,    0.2586233047,    0.2212402941,    0.2564198359,    0.3540351183,    1.1635457092,
    0.2609977273,    0.8423679191,    1.0295092662,    0.1990384245,    0.1921691746,    0.2033483773,    0.2580062856,    0.3930528251,    0.1716448717,    0.1603545068,
    0.2807826881,    0.5671805086,    0.2096487946,    0.2750024622,    0.3223420149,    0.4875451194,    0.6721164996,    0.2482198990,    0.2980492938,    0.2011102455,
    0.2527809077,    0.3131036032,    0.4740361197,    0.5279313834,    0.1939672796,    0.2687160254,    0.3746803680,    0.5141664357,    0.0639519812,    0.6982141291,
    0.4009520064,    0.1070282154,    0.3724258291,    8.8059442900,    0.0661804252,    0.2723481472,    0.1659791318,    0.2909790773,    0.5138104890,    0.7857160754,
    44.9687108447,    0.9026807309,    0.9087058417,    80.7120244781,    40.4473660010,    60.8218889676,    80.9201402057,    1.9668767669,    40.4470655978,    0.5368719079,
    0.6719966616,    0.0475244234,    0.5248851751,    44.7355228993,    0.8986990431,    0.9089116706,    80.4216985521,    40.3079330648,    60.6095820256,    80.6417965706,
    1.9615502770,    40.3076283762,    0.5831528920,    0.6720257559,    0.0475212006,    0.5248933933,    44.7294168533,    0.8986036813,    0.9088812086,    79.7629713593,
    60.1242219735,    80.0063784005,    1.9469167628,    39.9900936598,    0.6397911797,    0.6721059819,    0.0475103490,    0.5249242954,    44.7228197695,    0.8983559306,
    0.9087867990,    115.1526832965,    56.8873827100,    0.6711561316,    0.5346644610,    11.3376630510,    0.0715499194,    0.7298887299,    0.2940478648,    0.1540451980,
    0.4951772609,    1.7326810644,    0.0347329052,    0.0273227749,    0.0176139353,    0.0143078122,    0.0282518485,    4.8169481987,    0.0821287635,    0.3018074284,
    0.9753423648,    1.7057985579,    0.7885633390,    0.0051564206,    0.0636688136,    0.5255779236,    0.2665450611,    0.2576241219,    1.0000000000,    0.3032823496,
    0.7431328691,    0.4256392155,    0.3149578294,    0.3585938885,    0.0072921830,    0.6772601393,    0.4982637002,    1.1033067010,    0.7832544198,    1.8042011105,
    2.4405844351,    11.4753126495,    1.1284797692,    0.4525955009,    0.4238648485,    5.7943640773,    0.7317207029,    0.5180430748,    0.4798635187,    2.1876548392,
    2.0217591382,    1.8367642931,    0.9163105793,    0.1584444453,    3.6134192785,    3.4508837961,    4.6296538865,    0.6825297154,    0.4159866804,    2.3300816035,
    4.1508721002,    0.3916596144,    2.2326533681,    0.0438582473,    0.1274713167,    0.0935569045,    7.8660578355,    0.0672315017,    0.0110085972,    0.0055845797,
    0.0917164348,    0.0444311575,    3.7910123026,    57.9497550244,    0.1516713126,    1.6225182221,    0.2651251594,    0.4769778010,    0.5721895472,    0.6000857295,
    16.0523633476,    31.4985227903,    0.1134680339,    0.1022768876,    0.0891283399,    0.0873109912,    0.6900083430,    9.4636323783,    9.9516951400,    10.0554788423,
    19.2037629806,    11.3472500429,    9.4519567997,    8.6842095109,    2.6746168063,    2.3718991970,    2.0205958534,    0.5101681685,    0.2996386834,    0.2462919104,
    0.4892672598,    0.0652192797,    4.1898423390,    10.3685591409,    2.6051024290,    0.1793270303,    21.2060313626,    1.4087643865,    1.7504789174,    2.8959929437,
    0.5157239760,    0.1295347499,    30.7336909501,    0.0212868726,    0.0183731772,    0.0154591034,    0.0118896406,    0.0095269345,    0.0074777190,    0.0055964124,
    0.0040034222,    0.8562572256,    11.5151163255,    66.5481276459,    1.5442776299,    0.1635436012,    0.3445175156,    0.5276655561,    3.2201216909,    3.6534608422,
    0.5390693680,    0.3338359697,    0.0620953549,    0.1654107744,    0.1673503138,    0.6466978771,    0.3391230535,    0.6786055108,    0.6957283554,    0.3151247466,
    0.3860386093,    0.3342250525,    0.5199558804,    0.8728950736,    0.3536369758,    0.8798180567,    0.3813169200,    0.2170072332,    0.3752160630,    0.3578895307,
    0.6069393910,    0.3028326844,    0.9954384649,    0.3856754977,    0.1579076492,    0.4222309375,    0.7907924552,    0.4717440877,    0.6429280260,    1.0027885100,
    0.4444882202,    0.3444582234,    0.5282663442,    0.6826288524,    0.6571531365,    2.9459136268,    0.1716264851,    0.4506145058,    0.7079900187,    0.2945507386,
    10.3105754790,    0.8595717640,    0.0930602325,    0.5901994264,    56.8512549507,    2.9403053626,    0.6364069381,    0.4316827335,    0.2286582498,    0.0419328407,
    0.3707479607,    0.3224692888,    0.0916125467,    0.8996183368,    3.7295809063,    3.4485369268,    2.9054083467,    77.8442787503,    16.3947741082,    1.6768378705,
    1.6115048661,    1.1660835492,    415.3051008266,    2629.9015963738,    0.5901994264,    0.6364069381,    2.9403053626,    0.4316827335,    0.3707479607,    0.3224692888,
    0.2286582498,    0.0419328407,    56.8512549507,    2.7355867023,    2.1414909906,    63.3270043979,    1.1991482725,    1.0342042366,    0.3866167688,    0.6689224651,
    0.1268600977,    23858.6398537787,    2.0487084446,    12.8003327038,    1.5218450206,    1.3148828779,    0.6535178369,    0.7755769403,    0.8636686968,    253.5942932094,
    10.8259386709,    1.2538753936,    1.2396335204,    0.5928240725,    0.9573176785,    0.9413662888,    201.9028644874,    7.7061637363,    6.7157659471,    3.4107185986,
    4.1723802950,    4.3302649571,    1209.1884617088,    0.8711046107,    0.4918841973,    0.5599957927,    0.6318812079,    142.1364866416,    0.4762644481,    0.5665283453,
    0.5640440496,    126.2392099426,    0.4378152588,    0.4727238682,    61.2217102649,    0.3487916780,    77.8841276413,    83.5303726499,    2.8178194740,    22.0154772421,
    65.6546367064,    0.0207520869,    80.9954843636,    18.1019266768,    14.2128137377,    0.2019649539,    0.2662378525,    0.2062269538,    0.3905008782,    29.5566533399,
    10.4579421837,    22.8623921405,    22.0985827466,    44.2634841747,    77.8442787503,    0.1127052503,    1.4336326811,    3.1108559287,    97.2591805517,    42848.4857889697,
    23858.6398537787,    70.7178292642,    63.3270043979,    23858.6398537787,    1.0000000000,    1.0000000000,    1.0000000000
};

// Selected feature indices
constexpr int N_SELECTED_FEATURES = 503;
static const int SELECTED_FEATURES[N_SELECTED_FEATURES] = {
    0,    15,    17,    18,    26,    27,    33,    34,    35,    41,    50,    66,    67,    70,    72,    73,    75,    78,    83,    86,
    89,    96,    106,    111,    122,    126,    129,    140,    155,    215,    217,    225,    232,    291,    293,    294,    295,    296,    297,    299,
    300,    302,    303,    305,    306,    309,    310,    313,    314,    315,    316,    317,    319,    326,    328,    330,    331,    334,    336,    337,
    340,    344,    345,    348,    349,    350,    355,    356,    358,    362,    366,    372,    374,    378,    379,    381,    384,    385,    386,    388,
    389,    390,    398,    399,    410,    421,    422,    427,    470,    516,    549,    550,    566,    574,    577,    592,    626,    637,    643,    645,
    647,    648,    650,    651,    653,    655,    660,    662,    663,    664,    670,    677,    678,    684,    685,    690,    697,    701,    706,    710,
    715,    720,    724,    726,    727,    734,    735,    736,    737,    740,    742,    743,    744,    746,    748,    752,    753,    754,    755,    756,
    760,    761,    762,    763,    764,    769,    770,    771,    772,    773,    774,    775,    778,    780,    781,    782,    783,    785,    789,    793,
    794,    796,    798,    799,    801,    802,    807,    817,    822,    825,    833,    835,    836,    837,    842,    844,    846,    854,    857,    860,
    861,    863,    868,    875,    877,    881,    882,    886,    890,    894,    895,    906,    907,    909,    914,    918,    924,    939,    944,    947,
    952,    956,    957,    959,    960,    963,    965,    966,    969,    974,    976,    982,    983,    984,    989,    990,    992,    995,    1005,    1015,
    1021,    1022,    1023,    1029,    1042,    1043,    1044,    1046,    1048,    1049,    1050,    1053,    1055,    1056,    1058,    1062,    1063,    1064,    1065,    1066,
    1067,    1068,    1071,    1073,    1074,    1077,    1078,    1079,    1080,    1084,    1088,    1091,    1092,    1093,    1094,    1095,    1096,    1097,    1102,    1103,
    1105,    1108,    1109,    1110,    1112,    1113,    1114,    1118,    1120,    1125,    1127,    1128,    1129,    1138,    1143,    1145,    1146,    1148,    1149,    1152,
    1153,    1154,    1156,    1157,    1160,    1167,    1170,    1172,    1173,    1180,    1210,    1211,    1212,    1213,    1214,    1215,    1216,    1217,    1218,    1219,
    1220,    1221,    1222,    1223,    1224,    1225,    1226,    1227,    1228,    1229,    1230,    1231,    1232,    1233,    1234,    1235,    1236,    1237,    1238,    1239,
    1241,    1242,    1243,    1244,    1245,    1246,    1247,    1248,    1249,    1250,    1251,    1252,    1253,    1259,    1271,    1286,    1289,    1297,    1305,    1312,
    1313,    1323,    1333,    1334,    1339,    1340,    1354,    1377,    1412,    1413,    1414,    1415,    1416,    1420,    1421,    1422,    1423,    1424,    1425,    1426,
    1427,    1428,    1429,    1430,    1431,    1432,    1497,    1510,    1515,    1516,    1520,    1534,    1584,    1586,    1587,    1598,    1612,    1616,    1617,    1621,
    1626,    1629,    1685,    1689,    1692,    1696,    1699,    1713,    1714,    1737,    1739,    1752,    1755,    1805,    1806,    1807,    1809,    1828,    1832,    1837,
    1839,    1843,    1844,    1849,    1850,    1853,    1854,    1855,    1858,    1859,    1860,    1861,    1868,    1871,    1875,    1877,    1878,    1885,    1888,    1889,
    1890,    1892,    1893,    1894,    1897,    1898,    1958,    1967,    1968,    1970,    1972,    1976,    1977,    1979,    1981,    1982,    1989,    2002,    2003,    2006,
    2026,    2149,    2153,    2166,    2167,    2168,    2169,    2170,    2171,    2172,    2173,    2190,    2201,    2216,    2237,    2239,    2242,    2248,    2254,    2255,
    2261,    2269,    2270,    2271,    2272,    2274,    2275,    2298,    2306,    2343,    2379,    2447,    2495,    2499,    2501,    2521,    2525,    2618,    2866,    3077,
    3095,    3109,    3139,    3140,    3145,    3229,    3329,    3437,    3501,    3504,    3575,    3765,    3766,    3768,    3769,    3770,    3800,    3817,    3835,    3845,
    3847,    3850,    4014
};

// Feature order metadata
constexpr int N_CASCADE_FEATURES = 21;
constexpr int N_PHYSICS_FEATURES = 74;
// Cascade feature names (in order)
static const char* CASCADE_FEATURE_NAMES[N_CASCADE_FEATURES] = {
    "V",
    "Polarizability",
    "L",
    "E",
    "B",
    "Density",
    "RI",
    "S",
    "A",
    "Modularity",
    "dD",
    "dH",
    "dP",
    "HansenTotal",
    "BP",
    "deltaHvap",
    "logVP",
    "logPow",
    "logWS",
    "deltaHf",
    "deltaHc",
};

// Physics feature names (in order)
static const char* PHYSICS_FEATURE_NAMES[N_PHYSICS_FEATURES] = {
    "lsfer_0",
    "lsfer_1",
    "lsfer_2",
    "lsfer_3",
    "lsfer_4",
    "lsfer_5",
    "lsfer_6",
    "lsfer_7",
    "lsfer_8",
    "lsfer_9",
    "lsfer_10",
    "lsfer_11",
    "lsfer_12",
    "lsfer_13",
    "lsfer_14",
    "lsfer_15",
    "lsfer_16",
    "lsfer_17",
    "lsfer_18",
    "lsfer_19",
    "lsfer_20",
    "lsfer_21",
    "lsfer_22",
    "lsfer_23",
    "lsfer_24",
    "lsfer_25",
    "lsfer_26",
    "lsfer_27",
    "lsfer_28",
    "lsfer_29",
    "lsfer_30",
    "lsfer_31",
    "lsfer_32",
    "lsfer_33",
    "lsfer_34",
    "lsfer_35",
    "lsfer_36",
    "lsfer_37",
    "lsfer_38",
    "lsfer_39",
    "lsfer_40",
    "lsfer_41",
    "lsfer_42",
    "lsfer_43",
    "lsfer_44",
    "lsfer_45",
    "lsfer_46",
    "lsfer_47",
    "lsfer_48",
    "lsfer_49",
    "lsfer_50",
    "lsfer_51",
    "lsfer_52",
    "lsfer_53",
    "abraham_odt_eq",
    "phys_MR",
    "phys_Vm",
    "phys_fn",
    "phys_Parachor",
    "phys_epsCM",
    "phys_alpha",
    "phys_dD",
    "phys_dH",
    "phys_dP",
    "phys_delta",
    "mp_bp_polarizability_est",
    "mp_bp_sq",
    "mp_polarizability_sq",
    "mp_l_polarizability_est",
    "mp_l_sq",
    "mp_polarizability_sq",
    "mp_flashpoint_polarizability_est",
    "mp_flashpoint_sq",
    "mp_polarizability_sq",
};

// Prediction function using Treelite compiled library
// TL2cgen generates: size_t predict(union Entry* data, size_t num_row, float* result)
// Library path: /Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/mp_v34_treelite.dylib
extern "C" {
    // Forward declaration of TL2cgen prediction function
    typedef struct {
        float missing_value;
        float fvalue;
    } Entry;
    
    // Function pointer type for prediction
    typedef size_t (*PredictFunc)(Entry* data, size_t num_row, float* result);
}

// Load library and get prediction function (called once at initialization)
static void* lib_handle = nullptr;
static PredictFunc predict_func = nullptr;

static bool load_treelite_library() {
    if (lib_handle != nullptr) return true;  // Already loaded
    
    const char* lib_path = "/Users/guillaume-osmo/Github/rdkit-pypi/rdkit-source/Code/GraphMol/Descriptors/physchemprop/treelite_libs_v34/mp_v34_treelite.dylib";
    lib_handle = dlopen(lib_path, RTLD_LAZY);
    if (!lib_handle) {
        return false;
    }
    
    // Get prediction function
    predict_func = (PredictFunc)dlsym(lib_handle, "predict");
    if (!predict_func) {
        dlclose(lib_handle);
        lib_handle = nullptr;
        return false;
    }
    
    return true;
}

inline double predict(const double* features) {
    // Ensure library is loaded
    if (!load_treelite_library()) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Normalize features
    double normalized[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        normalized[i] = (features[i] - COL_MEANS[i]) / COL_STDS[i];
    }
    
    // Convert to TL2cgen Entry format
    Entry data[N_NORM_FEATURES];
    for (int i = 0; i < N_NORM_FEATURES; ++i) {
        data[i].missing_value = -1.0f;  // No missing values
        data[i].fvalue = static_cast<float>(normalized[i]);
    }
    
    // Call Treelite prediction
    float result[1];
    size_t num_output = predict_func(data, 1, result);
    if (num_output == 0) {
        return std::numeric_limits<double>::quiet_NaN();
    }
    
    // Denormalize target
    double pred_norm = static_cast<double>(result[0]);
    double pred = pred_norm * TARGET_SCALE + TARGET_MEAN;
    
    return pred;
}

} // namespace CascadeMP
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit

// Wrapper struct for template parameter (C++ doesn't allow namespaces as template parameters)
// Must be outside the namespace to reference it
namespace RDKit {
namespace Descriptors {
namespace Osmordred {
namespace CascadeMP {
struct Model {
    using Namespace = CascadeMP;
};
} // namespace CascadeMP
} // namespace Osmordred
} // namespace Descriptors
} // namespace RDKit
